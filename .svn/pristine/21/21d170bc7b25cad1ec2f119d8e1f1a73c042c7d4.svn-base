<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ntels.ccbs.product.mapper.product.productDev.ProductDevMgtMapper">
<select id="getDProdTree" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TARGET_CD,
		        TARGET_NM,
		        UPR_TARGET_CD,
		        TARGET_TYP,
		        PROD_TYP,
		        PROD_GRP,
		        PROD_CD,
		        SVC_CD,
		        RATE_ITM_CD,
		        CHRG_CTGRY,
		        TREE_LEVEL,
		        CASE WHEN TARGET_TYP IN ('R') THEN 2
		             ELSE 0
		        END  AS TARGET_IMAGE_ID,
		        SO_ID,
		        ISFOLDER
		FROM    (
		<foreach collection="soAuthList" item="item" index="index"  separator="UNION ALL">		
		         SELECT  CONCAT(SO_NM, #{item.so_id})  TARGET_CD,
                         SO_NM              TARGET_NM,
                         'PRODUCT'        UPR_TARGET_CD,
                         'T'                 TARGET_TYP,
                         ''                  PROD_TYP,
                         ''                  PROD_GRP,
                         ''                  PROD_CD,
                         ''                  SVC_CD,
                         ''                  RATE_ITM_CD,
                         ''                  CHRG_CTGRY,
                         1                   TREE_LEVEL,
                         SO_ID,
                         'TRUE' ISFOLDER
                 FROM TSYCO_SO_MAST
                 where so_id =  #{item.so_id}
		         UNION ALL
		         SELECT  CONCAT(A.COMMON_CD, #{item.so_id})          TARGET_CD,
		                 CONCAT(C.CODE_NM ,CONCAT('(',
		                                 CONCAT((SELECT COUNT(*) FROM TPMPD_D_PROD X1 WHERE A.COMMON_CD = X1.PROD_TYP AND X1.SO_ID = B.SO_ID),
		                                ')'))) TARGET_NM,
		                 CONCAT(B.SO_NM , #{item.so_id})   UPR_TARGET_CD,
		                 'T'                 TARGET_TYP,
		                 A.COMMON_CD           PROD_TYP,
		                 ''                  PROD_GRP,
		                 ''                  PROD_CD,
		                 ''                  SVC_CD,
		                 ''                  RATE_ITM_CD,
		                 ''                  CHRG_CTGRY,
		                 2                   TREE_LEVEL,
		                 B.SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TSYCO_SO_MAST B, TSYCO_CODE_DETAIL A, TSYCO_CODE_DETAIL_NAME C
		         WHERE A.COMMON_GRP = C.COMMON_GRP
		         AND A.COMMON_CD = C.COMMON_CD
		         AND #{sessionLanguage} = C.LNG_TYP
		         AND A.COMMON_GRP      = 'PP00068'
		         AND B.SO_ID = #{item.so_id}
		         AND A.USE_YN = 'Y'
		         UNION ALL
				SELECT CONCAT(A.COMMON_CD 
				  ,CONCAT(B.COMMON_CD , #{item.so_id})) TARGET_CD,				  
				  CONCAT(COALESCE((SELECT CODE_NM 
                  FROM TSYCO_CODE_DETAIL_NAME NAME
                  WHERE NAME.COMMON_GRP = B.COMMON_GRP
                  AND   NAME.COMMON_CD  = B.COMMON_CD
                  AND   NAME.LNG_TYP    =#{sessionLanguage}),B.COMMON_CD_NM) 
				  ,CONCAT('('
				  ,
				  CONCAT((SELECT COUNT(*)
				  FROM TPMPD_D_PROD X1,
				    TSYCO_SO_MAST Y1
				  WHERE A.COMMON_CD = X1.PROD_TYP
				  AND B.COMMON_CD   = X1.PROD_GRP
				  AND X1.SO_ID      = Y1.SO_ID
				  AND Y1.SO_ID      = #{item.so_id}
				  )
				  , ')'))) TARGET_NM,				  
				  CONCAT(A.COMMON_CD , #{item.so_id}) UPR_TARGET_CD,
				  'T' TARGET_TYP,
				  A.COMMON_CD PROD_TYP,
				  B.COMMON_CD PROD_GRP,
				  '' PROD_CD,
				  '' SVC_CD,
				  '' RATE_ITM_CD,
				  '' CHRG_CTGRY,
				  3 TREE_LEVEL,
				  '${item.so_id}' AS SO_ID,
				  'TRUE' ISFOLDER
				FROM
				  (SELECT * FROM TSYCO_CODE_DETAIL WHERE COMMON_GRP = 'PP00068'
				  ) A,
				  (SELECT *
				  FROM TSYCO_CODE_DETAIL
				  WHERE COMMON_GRP                 = 'PP00141'
				  AND REF_CODE LIKE CONCAT(CONCAT('%', #{item.so_id}), '%')		
				  ) B   
				  -- WHERE B.REF_CODE2 LIKE CONCAT('%',A.COMMON_CD,'%')
				  WHERE B.REF_CODE2 LIKE CONCAT('%',CONCAT(A.COMMON_CD,'%'))
				  AND B.USE_YN = 'Y'
		         UNION ALL
		         SELECT  CONCAT(PROD_CD , #{item.so_id})         TARGET_CD,
		                 PROD_NM         TARGET_NM,
		                 CONCAT(PROD_TYP,CONCAT(PROD_GRP, #{item.so_id})) UPR_TARGET_CD,
		                 'P'             TARGET_TYP,
		                 PROD_TYP        PROD_TYP,
		                 PROD_GRP        PROD_GRP,
		                 PROD_CD         PROD_CD,
		                 ''              SVC_CD,
		                 ''              RATE_ITM_CD,
		                 ''              CHRG_CTGRY,
		                 4               TREE_LEVEL,
		                 SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TPMPD_D_PROD TDP
		         WHERE   MSTR_FL = '1'
				 AND TDP.SO_ID = #{item.so_id}
		         UNION ALL
		         SELECT  CONCAT(PS.SVC_CD,CONCAT(PS.PROD_CD , #{item.so_id})) TARGET_CD,
		                 S.SVC_NM      TARGET_NM,
						  CONCAT(( CASE
						      WHEN UPR_SVC_CD = '0000000000'
						      THEN PS.PROD_CD
						      ELSE PS.PROD_CD
						    END ) , #{item.so_id}) UPR_TARGET_CD,
		                 'S'           TARGET_TYP,
		                 ''            PROD_TYP,
		                 ''            PROD_GRP,
		                 PS.PROD_CD    PROD_CD,
		                 PS.SVC_CD     SVC_CD,
		                 ''            RATE_ITM_CD,
		                 ''            CHRG_CTGRY,
		                 5             TREE_LEVEL,
		                 '${item.so_id}' AS SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TPMPD_D_PROD_SVC PS,
		                 TPMSV_SVC      S
		         WHERE   S.SVC_CD = PS.SVC_CD
		         AND     S.MSTR_FL = '1'
		         UNION ALL
		         SELECT  CONCAT(RI.RATE_ITM_CD , #{item.so_id})   TARGET_CD,
		                 RI.RATE_ITM_NM   TARGET_NM,
						  ( CASE
						      WHEN RI.SVC_CD = '0000000000'
						      THEN RI.PROD_CD
						      ELSE CONCAT(RI.SVC_CD,CONCAT(RI.PROD_CD, #{item.so_id}))
						    END ) UPR_TARGET_CD,		                 
		                 'R'              TARGET_TYP,
		                 ''               PROD_TYP,
		                 ''               PROD_GRP,
		                 RI.PROD_CD       PROD_CD,
		                 RI.SVC_CD        SVC_CD,
		                 RI.RATE_ITM_CD   RATE_ITM_CD,
		                 RI.CHRG_CTGRY    CHRG_CTGRY,
		                 6                TREE_LEVEL,
		                 '${item.so_id}' AS SO_ID,
		                 'FALSE' ISFOLDER
		         FROM    TPMPD_D_RATE_ITM RI,
		                 TPMSV_SVC      S
		         WHERE S.SVC_CD = RI.SVC_CD
		         AND   S.MSTR_FL = '1'
		</foreach>         
		) A

</select>


<select id="getDProdTree2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TARGET_CD,
		        TARGET_NM,
		        UPR_TARGET_CD,
		        TARGET_TYP,
		        PROD_TYP,
		        PROD_GRP,
		        PROD_CD,
		        SVC_CD,
		        RATE_ITM_CD,
		        CHRG_CTGRY,
		        TREE_LEVEL,
		        CASE WHEN TARGET_TYP IN ('R') THEN 2
		             ELSE 0
		        END  AS TARGET_IMAGE_ID,
		        SO_ID,
		        ISFOLDER
		FROM    (
		<foreach collection="soAuthList" item="item" index="index"  separator="UNION ALL">		
		         SELECT  CONCAT(SO_NM, #{item.so_id})  TARGET_CD,
                         SO_NM              TARGET_NM,
                         'PRODUCT'        UPR_TARGET_CD,
                         'T'                 TARGET_TYP,
                         ''                  PROD_TYP,
                         ''                  PROD_GRP,
                         ''                  PROD_CD,
                         ''                  SVC_CD,
                         ''                  RATE_ITM_CD,
                         ''                  CHRG_CTGRY,
                         1                   TREE_LEVEL,
                         SO_ID,
                         'TRUE' ISFOLDER
                 FROM TSYCO_SO_MAST
                 where so_id =  #{item.so_id}
		         UNION ALL
		         SELECT  CONCAT(A.COMMON_CD, #{item.so_id})          TARGET_CD,
		                 CONCAT(C.CODE_NM ,CONCAT('(',
		                                 CONCAT((SELECT COUNT(*) FROM TPMPD_PROD X1 WHERE A.COMMON_CD = X1.PROD_TYP AND X1.SO_ID = B.SO_ID AND X1.MSTR_FL='1'),
		                                ')'))) TARGET_NM,
		                 CONCAT(B.SO_NM , #{item.so_id})   UPR_TARGET_CD,		                 		                 
		                 'T'                 TARGET_TYP,
		                 A.COMMON_CD           PROD_TYP,
		                 ''                  PROD_GRP,
		                 ''                  PROD_CD,
		                 ''                  SVC_CD,
		                 ''                  RATE_ITM_CD,
		                 ''                  CHRG_CTGRY,
		                 2                   TREE_LEVEL,
		                 B.SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TSYCO_SO_MAST B, TSYCO_CODE_DETAIL A 
		         LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		         ON A.COMMON_GRP = C.COMMON_GRP
		         AND A.COMMON_CD = C.COMMON_CD
		         AND #{sessionLanguage} = C.LNG_TYP
		         WHERE A.COMMON_GRP      = 'PP00068'
		         AND B.SO_ID = #{item.so_id}
		         AND A.USE_YN = 'Y'
		         UNION ALL
				SELECT CONCAT(A.COMMON_CD 
				  ,CONCAT(B.COMMON_CD , #{item.so_id})) TARGET_CD,				  
				  CONCAT(COALESCE((SELECT CODE_NM 
                  FROM TSYCO_CODE_DETAIL_NAME NAME
                  WHERE NAME.COMMON_GRP = B.COMMON_GRP
                  AND   NAME.COMMON_CD  = B.COMMON_CD
                  AND   NAME.LNG_TYP    =#{sessionLanguage}),B.COMMON_CD_NM) 
				  ,CONCAT('('
				  ,
				  CONCAT((SELECT COUNT(*)
				  FROM TPMPD_PROD X1,
				    TSYCO_SO_MAST Y1
				  WHERE A.COMMON_CD = X1.PROD_TYP
				  AND B.COMMON_CD   = X1.PROD_GRP
				  AND X1.SO_ID      = Y1.SO_ID
				  AND Y1.SO_ID      = #{item.so_id}
				  AND X1.MSTR_FL='1'
				  )
				  , ')'))) TARGET_NM,				  
				  CONCAT(A.COMMON_CD , #{item.so_id}) UPR_TARGET_CD,
				  'T' TARGET_TYP,
				  A.COMMON_CD PROD_TYP,
				  B.COMMON_CD PROD_GRP,
				  '' PROD_CD,
				  '' SVC_CD,
				  '' RATE_ITM_CD,
				  '' CHRG_CTGRY,
				  3 TREE_LEVEL,
				  '${item.so_id}' AS SO_ID,
				  'TRUE' ISFOLDER
				FROM
				  (SELECT * FROM TSYCO_CODE_DETAIL WHERE COMMON_GRP = 'PP00068'
				  ) A,
				  (SELECT *
				  FROM TSYCO_CODE_DETAIL
				  WHERE COMMON_GRP                 = 'PP00141'
				  AND REF_CODE LIKE CONCAT(CONCAT('%', #{item.so_id}), '%')		
				  ) B   
				  -- WHERE B.REF_CODE2 LIKE CONCAT('%',A.COMMON_CD,'%')
				   WHERE B.REF_CODE2 LIKE CONCAT('%',CONCAT(A.COMMON_CD,'%'))
				   AND B.USE_YN = 'Y'
		         UNION ALL
		         SELECT  CONCAT(PROD_CD , #{item.so_id})         TARGET_CD,
		                 PROD_NM         TARGET_NM,
		                 CONCAT(PROD_TYP,CONCAT(PROD_GRP, #{item.so_id})) UPR_TARGET_CD,
		                 'P'             TARGET_TYP,
		                 PROD_TYP        PROD_TYP,
		                 PROD_GRP        PROD_GRP,
		                 PROD_CD         PROD_CD,
		                 ''              SVC_CD,
		                 ''              RATE_ITM_CD,
		                 ''              CHRG_CTGRY,
		                 4               TREE_LEVEL,
		                 SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TPMPD_PROD TDP
		         WHERE   MSTR_FL = '1'
				 AND TDP.SO_ID = #{item.so_id}
		         UNION ALL
		         SELECT  CONCAT(PS.SVC_CD,CONCAT(PS.PROD_CD , #{item.so_id})) TARGET_CD,
		                 S.SVC_NM      TARGET_NM,
						  CONCAT(( CASE
						      WHEN UPR_SVC_CD = '0000000000'
						      THEN PS.PROD_CD
						      ELSE PS.PROD_CD
						    END ) , #{item.so_id}) UPR_TARGET_CD,
		                 'S'           TARGET_TYP,
		                 ''            PROD_TYP,
		                 ''            PROD_GRP,
		                 PS.PROD_CD    PROD_CD,
		                 PS.SVC_CD     SVC_CD,
		                 ''            RATE_ITM_CD,
		                 ''            CHRG_CTGRY,
		                 5             TREE_LEVEL,
		                 '${item.so_id}' AS SO_ID,
		                 'TRUE' ISFOLDER
		         FROM    TPMPD_PROD_SVC PS,
		                 TPMSV_SVC      S
		         WHERE   S.SVC_CD = PS.SVC_CD
		         AND     S.MSTR_FL = '1'
		         AND     PS.MSTR_FL = '1'
  		       	 AND     PS.INACT_DT > #{currentDay}   
		         UNION ALL
		         SELECT  CONCAT(RI.RATE_ITM_CD , #{item.so_id})   TARGET_CD,
		                 RI.RATE_ITM_NM   TARGET_NM,
						 ( CASE
						      WHEN RI.SVC_CD = '0000000000'
						      THEN RI.PROD_CD
						      ELSE CONCAT(RI.SVC_CD,CONCAT(RI.PROD_CD, #{item.so_id}))
						    END ) UPR_TARGET_CD,		                 
		                 'R'              TARGET_TYP,
		                 ''               PROD_TYP,
		                 ''               PROD_GRP,
		                 RI.PROD_CD       PROD_CD,
		                 RI.SVC_CD        SVC_CD,
		                 RI.RATE_ITM_CD   RATE_ITM_CD,
		                 RI.CHRG_CTGRY    CHRG_CTGRY,
		                 6                TREE_LEVEL,
		                 '${item.so_id}' AS SO_ID,
		                 'FALSE' ISFOLDER
		         FROM    TPMPD_RATE_ITM RI,
		                 TPMSV_SVC      S
		         WHERE S.SVC_CD = RI.SVC_CD
		         AND   S.MSTR_FL = '1'
		         AND     RI.MSTR_FL = '1'
  		       	 AND     RI.INACT_DT > #{currentDay}  
		</foreach>         
		) A

</select>

<select id="getProductListCount" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
				SELECT COUNT(*)
		FROM   TPMPD_D_PROD TDP
		WHERE  1=1
		<if test="productDevMgt.prodTyp != null and productDevMgt.prodTyp != ''">
	       AND  TDP.PROD_TYP = #{productDevMgt.prodTyp}
	    </if>
        <if test="productDevMgt.prodGrp != null and productDevMgt.prodGrp != ''">		
	       AND  TDP.PROD_GRP = #{productDevMgt.prodGrp}
	    </if>	    
        <if test="productDevMgt.soId != null and productDevMgt.soId != ''">			
	       AND  TDP.SO_ID = #{productDevMgt.soId}
	    </if>		    
		ORDER BY PROD_TYP, DISP_PRI_NO
</select>

<select id="getProductList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
				SELECT TDP.PROD_CD           ,
		       TDP.INACT_DT        ,
		       TDP.ACT_DT         ,
		       TDP.PROD_NM           ,
		       TDP.PROD_ABBR_NM      ,
		       TDP.PROD_ENG_NM       ,
		       TDP.PROD_ENG_ABBR_NM  ,
               TDP.MNO_PROD_CD,
		       TDP.BASIC_PROD_FL     ,
		       
		       ( SELECT TCD1.CODE_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD
                 WHERE  TCD.COMMON_GRP = 'PP00069'
                 AND    TCD.COMMON_CD  = TDP.BASIC_PROD_FL  ) BASIC_PROD_FL_NM,
		       TDP.USG_RATE_PRI_NO   ,
		       TDP.PROD_TYP          ,
		       ( SELECT TCD1.CODE_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD          
                 WHERE  TCD.COMMON_GRP = 'PP00068'
                 AND    TCD.COMMON_CD  = TDP.PROD_TYP) PROD_TYP_NM,
		       TDP.PROD_GRP          ,
		       ( SELECT TCD1.CODE_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD                  
                 WHERE  TCD.COMMON_GRP = 'PP00141'
                 AND    TCD.COMMON_CD  = TDP.PROD_GRP) PROD_GRP_NM,
		       TDP.PROD_LVL,
		       TDP.SVC_GRP          ,
		        ( SELECT TCD1.CODE_NM
                  FROM   TSYCO_CODE_DETAIL TCD
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                    
                  WHERE  TCD.COMMON_GRP = 'PP00143'
                  AND    TCD.COMMON_CD  = TDP.SVC_GRP) SVC_GRP_NM,
		       TDP.USE_MM_TYP          ,
		         ( SELECT TCD1.CODE_NM
                  FROM   TSYCO_CODE_DETAIL TCD 
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                     
                  WHERE  TCD.COMMON_GRP = 'PP00079'
                  AND    TCD.COMMON_CD  = TDP.USE_MM_TYP) USE_MM_TYP_NM,
		       TDP.SUBS_FL           ,
		       ( SELECT TCD1.CODE_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                 
                 WHERE  TCD.COMMON_GRP = 'PP00071'
                 AND    TCD.COMMON_CD  = TDP.SUBS_FL) SUBS_FL_NM,
		       TDP.CRR_ID            ,
		       TDP.DISP_PRI_NO       ,
		       TDP.MOD_DESC          ,
		       TDP.PROD_DESC         ,
		       TDP.MSTR_FL           ,
		       TDP.REGR_ID      ,
		       TDP.REG_DATE    ,
		       TDP.CHGR_ID        ,
		       CHG_DATE      ,
		        TDP.KPI_PROD_GRP_CD,
		        TDP.SO_ID,
	            (SELECT SO_NM
	              FROM TSYCO_SO_MAST
	              WHERE SO_ID = TDP.SO_ID) AS SO_NM,
				(SELECT  MAX(TPDH.DVLP_STATUS)
		        FROM    TPMPD_PROD_DVLP_HIST TPDH
		        WHERE   TPDH.PROD_CD  =  TDP.PROD_CD
		        AND     TPDH.DVLP_STATUS NOT IN ('5','6')) AS DVLP_STATUS   	              
		FROM   TPMPD_D_PROD TDP
		WHERE  1=1
		<if test="productDevMgt.prodTyp != null and productDevMgt.prodTyp != ''">
	       AND  TDP.PROD_TYP = #{productDevMgt.prodTyp}
	    </if>
		<if test="productDevMgt.prodGrp != null and productDevMgt.prodGrp != ''">
	       AND  TDP.PROD_GRP = #{productDevMgt.prodGrp}
	    </if>	    
		<if test="productDevMgt.soId != null and productDevMgt.soId != ''">
	       AND  TDP.SO_ID = #{productDevMgt.soId}
	    </if>		    
		ORDER BY PROD_TYP, DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>



<select id="getNextDispPriNo" resultType="String">
  SELECT    
   CASE WHEN
    (CASE WHEN MAX(DISP_PRI_NO) IS NULL THEN 0 ELSE  MAX(DISP_PRI_NO) +1 END ) = 100000 THEN 99999
   ELSE(CASE WHEN MAX(DISP_PRI_NO) IS NULL THEN 0 ELSE  MAX(DISP_PRI_NO) +1 END)
  END AS NEXT_DISP_PRI_NO  
  FROM   TPMPD_D_PROD    
</select>

<select id = "getDualProductNm" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  PROD_NM
		FROM    TPMPD_PROD
		WHERE   PROD_NM = #{productDevMgt.prodNm}
		AND     MSTR_FL = '1'
		<if test="productDevMgt.prodCd != null and productDevMgt.prodCd != ''">
	       AND  PROD_CD = #{productDevMgt.prodCd}
	    </if>		
		<if test="productDevMgt.soId != null and productDevMgt.soId != ''">
	       AND  SO_ID = #{productDevMgt.soId}
	    </if>			
		UNION
		SELECT  PROD_NM
		FROM    TPMPD_D_PROD
		WHERE   PROD_NM = #{productDevMgt.prodNm}
		AND     MSTR_FL = '1'
		<if test="productDevMgt.prodCd != null">
	       AND  PROD_CD = #{productDevMgt.prodCd}
	    </if>		
		<if test="productDevMgt.soId != null">
	       AND  SO_ID = #{productDevMgt.soId}
	    </if>	
</select>

<insert id ="addProduct" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD
		(
			PROD_CD                 ,
			INACT_DT                ,
			ACT_DT                  ,
			PROD_NM                 ,
			PROD_ABBR_NM            ,
			PROD_ENG_NM             ,
			PROD_ENG_ABBR_NM        ,
			BASIC_PROD_FL           ,
			USG_RATE_PRI_NO         ,
			PROD_TYP                ,
			PROD_GRP                ,
			PROD_LVL                ,
			SVC_GRP                 ,
			USE_MM_TYP              ,
			SUBS_FL                 ,
			DISP_PRI_NO             ,
			MOD_DESC                ,
			PROD_DESC               ,
			MSTR_FL                 ,
			KPI_PROD_GRP_CD,
			REGR_ID            ,
            REG_DATE          ,
            CHGR_ID              ,
            CHG_DATE,
            SO_ID,
            MNO_PROD_CD
		)
		VALUES
		(
			#{productDevMgt.prodCd, jdbcType=VARCHAR },
			#{productDevMgt.inactDt, jdbcType=VARCHAR },
			#{productDevMgt.actDt, jdbcType=VARCHAR },
			#{productDevMgt.prodNm, jdbcType=VARCHAR },
			#{productDevMgt.prodAbbrNm, jdbcType=VARCHAR },	
			#{productDevMgt.prodEngNm, jdbcType=VARCHAR },
			#{productDevMgt.prodEngAbbrNm, jdbcType=VARCHAR },
			#{productDevMgt.basicProdFl, jdbcType=VARCHAR },
			#{productDevMgt.usgRatePriNo, jdbcType=NUMERIC },
			#{productDevMgt.prodTyp, jdbcType=VARCHAR },
			#{productDevMgt.prodGrp, jdbcType=VARCHAR },
			#{productDevMgt.prodLvl, jdbcType=NUMERIC },
			#{productDevMgt.svcGrp, jdbcType=VARCHAR },
			#{productDevMgt.useMmTyp, jdbcType=VARCHAR },
			#{productDevMgt.subsFl, jdbcType=VARCHAR },
			#{productDevMgt.dispPriNo, jdbcType=NUMERIC },
			#{productDevMgt.modDesc, jdbcType=VARCHAR },
			#{productDevMgt.prodDesc, jdbcType=VARCHAR },
			#{productDevMgt.mstrFl, jdbcType=VARCHAR },
			#{productDevMgt.kpiProdGrpCd, jdbcType=VARCHAR },
			#{productDevMgt.regrId, jdbcType=VARCHAR },
            #{productDevMgt.sysdate},
            #{productDevMgt.chgrId, jdbcType=VARCHAR },
            #{productDevMgt.sysdate},
            #{productDevMgt.soId, jdbcType=VARCHAR },
            #{productDevMgt.mnoProdCd, jdbcType=VARCHAR }
		)
</insert>

<insert id ="addProductDvlpHist" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_DVLP_HIST
		(
			PROD_CD                 ,
			PROD_DVLP_DTTM          ,
			PROD_NM                 ,
			PROD_TYP                ,
			DVLP_TYP                ,
			MOD_TYP                 ,
			DVLP_STATUS             ,
			CHGR_ID              ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.prodCd, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR },
			#{productDevMgt.prodNm, jdbcType=VARCHAR },
			#{productDevMgt.prodTyp, jdbcType=VARCHAR },
			#{productDevMgt.dvlpTyp, jdbcType=VARCHAR },
			'X'                     ,
			#{productDevMgt.dvlpStatus, jdbcType=VARCHAR },
			#{productDevMgt.chgrId, jdbcType=VARCHAR },
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
		)
</insert>

<update id="modProduct" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_PROD
		SET    ACT_DT            = #{productDevMgt.currentDay}    ,
		       PROD_NM           = #{productDevMgt.prodNm}        ,
		       PROD_ABBR_NM      = #{productDevMgt.prodAbbrNm}    ,
		       PROD_ENG_NM       = #{productDevMgt.prodEngNm}     ,
		       PROD_ENG_ABBR_NM  = #{productDevMgt.prodEngAbbrNm} ,
		       BASIC_PROD_FL     = #{productDevMgt.basicProdFl}   ,
		       PROD_LVL          = #{productDevMgt.prodLvl}       ,
		       SVC_GRP           = #{productDevMgt.svcGrp}        ,
		       USE_MM_TYP        = #{productDevMgt.useMmTyp}      ,
		       SUBS_FL           = #{productDevMgt.subsFl}         ,
		       DISP_PRI_NO       = #{productDevMgt.dispPriNo}     ,
		       MOD_DESC          = #{productDevMgt.modDesc}       ,
		       PROD_DESC         = #{productDevMgt.prodDesc}      ,
		       CHGR_ID           = #{productDevMgt.chgrId}        ,
		       CHG_DATE          = #{productDevMgt.sysdate} 	  ,
		       SO_ID 			 = #{productDevMgt.soId}          ,
               MNO_PROD_CD       = #{productDevMgt.mnoProdCd}     
		WHERE PROD_CD 			 = #{productDevMgt.prodCd}
		AND   INACT_DT 			 >= #{productDevMgt.currentDay}
		AND   MSTR_FL     		 = '1'
		<if test="productDevMgt.beforeSoId != null">
	    AND   SO_ID 			 = #{productDevMgt.beforeSoId}
	    </if>		
</update>

<update id="modProductDvlpHist" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_DVLP_HIST
		SET    PROD_DVLP_DTTM    = #{productDevMgt.currentDay}    ,
		       PROD_NM           = #{productDevMgt.prodNm}        ,
		       CHGR_ID           = #{productDevMgt.chgrId}        ,
		       CHG_DATE          = #{productDevMgt.sysdate}
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		AND    DVLP_STATUS  = '1'
</update>

<select id="getProdDvlpList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  ( SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
		          WHERE  B.COMMON_GRP = 'PP00068'
		          AND    B.COMMON_CD  = TPDH.PROD_TYP) PROD_TYP_NM,
		        TPDH.PROD_CD ,
		        TPDH.PROD_NM ,
		        TPDH.DVLP_TYP,
		        ( SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
		          WHERE  B.COMMON_GRP = 'PP00106'
		          AND    B.COMMON_CD  = TPDH.DVLP_TYP) DVLP_TYP_NM,
		        TDP.MOD_DESC,
		        ( SELECT TUM.USER_NAME
		          FROM   TSYCO_USER TUM
		          WHERE  TUM.USER_ID = TPDH.CHGR_ID) AS USR_NM,
		        TPDH.DVLP_STATUS,
		        ( SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD                  
		          WHERE  B.COMMON_GRP = 'PP00107'
		          AND    B.COMMON_CD  = TPDH.DVLP_STATUS) DVLP_STATUS_NM,
		        TPDH.PROD_DVLP_DTTM,
		        TPDH.MOD_TYP,
		        ( SELECT MAX(CONF_REQ_CD)
                 FROM   TPMPD_PROD_CONF_HIST TPCH
                 WHERE  TPCH.PROD_CD        = TPDH.PROD_CD
                 AND    TPCH.PROD_DVLP_DTTM = TPDH.PROD_DVLP_DTTM ) CONF_REQ_CD,
                TPDH.CHG_DATE AS CHG_DATE
               ,TDP.SO_ID
               ,(select SO_NM 
                 from   TSYCO_SO_MAST
                 where  SO_ID = TDP.SO_ID
                 and    USE_YN = 'Y') AS SO_NM 
		FROM    TPMPD_PROD_DVLP_HIST TPDH,
		        TPMPD_D_PROD         TDP
		WHERE   TPDH.PROD_CD = TDP.PROD_CD
		AND     TPDH.DVLP_STATUS NOT IN ('5','6')
		AND     TPDH.PROD_NM LIKE CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
		<if test="productDevMgt.dvlpTyp != null">
	    AND   DVLP_TYP 			 = #{productDevMgt.dvlpTyp}
	    </if>	    			
		<if test="productDevMgt.dvlpStatus != null">
	    AND   DVLP_STATUS 	     = #{productDevMgt.dvlpStatus}
	    </if>	
		<if test="productDevMgt.soId != null">
	    AND   TDP.SO_ID 	     = #{productDevMgt.soId}
	    </if>	
		<if test="productDevMgt.soId == null">
		AND	   TDP.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>		  
            
		ORDER BY PROD_NM
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>

<select id="getProdDvlpListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_PROD_DVLP_HIST TPDH,
		        TPMPD_D_PROD         TDP
		WHERE   TPDH.PROD_CD = TDP.PROD_CD
		AND     TPDH.DVLP_STATUS NOT IN ('5','6')
		AND     TPDH.PROD_NM LIKE CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
		<if test="productDevMgt.dvlpTyp != null and productDevMgt.dvlpTyp != ''">
	    AND   DVLP_TYP 			 = #{productDevMgt.dvlpTyp}
	    </if>
	    			
		<if test="productDevMgt.dvlpStatus != null and productDevMgt.dvlpStatus != ''">
	    AND   DVLP_STATUS 	     = #{productDevMgt.dvlpStatus}
	    </if>			
	
		<if test="productDevMgt.soId != null and productDevMgt.soId != ''">
	    AND   TDP.SO_ID 	     = #{productDevMgt.soId}
	    </if>	
		
		<if test="productDevMgt.soId != null">
		AND	   TDP.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>		  
</select>

<select id="getProdConfHistCnt" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT CONF_REQ_CD
		FROM   TPMPD_PROD_CONF_HIST
		WHERE  PROD_CD        =  #{productDevMgt.prodCd}
		AND    PROD_DVLP_DTTM =  #{productDevMgt.prodDvlpDttm}
		
		AND    CONF_STATUS    =  #{productDevMgt.confStatus}
</select>

<insert id ="addProdConfHist" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_CONF_HIST
		(
			CONF_REQ_CD ,
			PROD_CD     ,
			PROD_DVLP_DTTM ,
			CONF_REQ_DTTM ,
			CONF_STATUS ,
			CHGR_ID ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.confReqCd, jdbcType=VARCHAR }, 
			#{productDevMgt.prodCd, jdbcType=VARCHAR },
			#{productDevMgt.prodDvlpDttm, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR },
			#{productDevMgt.confStatus, jdbcType=VARCHAR },
			#{productDevMgt.chgrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate}
		)
</insert>

<select id="getProdConfDtlList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
       SELECT
         TPCD.CONF_REQ_CD,
         TPCD.CONFR_CD ,
         A.USER_NAME    ,
         B.ORG_ID   ,
         B.ORG_NM
       FROM  
         TPMPD_PROD_CONF_DTL  TPCD ,
         TPMPD_PROD_CONF_HIST TPCH ,
         TSYCO_USER A ,
         TSYCO_ORG_INFO B
       WHERE 
         TPCH.PROD_CD        = #{productDevMgt.prodCd}
         AND    TPCH.PROD_DVLP_DTTM = #{productDevMgt.prodDvlpDttm}
         AND    TPCH.CONF_STATUS    = #{productDevMgt.confStatus}
		AND TPCH.CONF_REQ_CD    = TPCD.CONF_REQ_CD
		AND TPCD.CONFR_CD       = A.USER_ID
		AND A.ORG_ID            = B.ORG_ID
		AND B.ORG_STAT_CD = '1'
		AND A.USE_YN            = 'Y'
</select>

<update id="modProdDvlpHistConfReq" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_PROD_DVLP_HIST
		SET     DVLP_STATUS = #{productDevMgt.dvlpStatus}
		<if test='productDevMgt.modFl.equals("CONF_REQ")'>
	    	,MOD_TYP     = #{productDevMgt.modTyp}
	    </if>		
		<if test='productDevMgt.modFl.equals("CONF_REQ_CANCEL")'>
	    	,CHGR_ID     = #{productDevMgt.chgrId}
	    	,CHG_DATE    = #{productDevMgt.sysdate}
	    </if>		
		WHERE   PROD_CD        =  #{productDevMgt.prodCd}
		AND     PROD_DVLP_DTTM =  #{productDevMgt.prodDvlpDttm}
</update>

<update id="modProdConfHistConfReq" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_CONF_HIST
		<if test='productDevMgt.modFl.equals("CONF_REQ")'>
			SET    CONF_REQ_DTTM = #{productDevMgt.currentDay},
			       CONF_STATUS   = #{productDevMgt.confStatus}		
		</if>
		<if test='productDevMgt.modFl.equals("CONF_REQ_CANCEL")'>
			SET    CONF_STATUS   = #{productDevMgt.confStatus}
		</if>		
	    WHERE  CONF_REQ_CD   = #{productDevMgt.confReqCd}
</update>

<select id="getModProductInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TDP.PROD_CD           ,
		       TDP.INACT_DT        ,
		       TDP.ACT_DT         ,
		       TDP.PROD_NM           ,
		       TDP.PROD_ABBR_NM      ,
		       TDP.PROD_ENG_NM       ,
		       TDP.PROD_ENG_ABBR_NM  ,
		       TDP.BASIC_PROD_FL     ,
		       TDP.USG_RATE_PRI_NO   ,
		       TDP.PROD_TYP          ,
		       ( SELECT C.CODE_NM AS COMMON_CD_NM
		         FROM   TSYCO_CODE_DETAIL B
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
                 AND B.COMMON_GRP = C.COMMON_GRP
                 AND B.COMMON_CD = C.COMMON_CD                   
		         WHERE  B.COMMON_GRP = 'PP00068'
		         AND    B.COMMON_CD  = TDP.PROD_TYP) PROD_TYP_NM,
		       TDP.PROD_GRP          ,
		       ( SELECT C.CODE_NM AS COMMON_CD_NM
		         FROM   TSYCO_CODE_DETAIL B
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
                 AND B.COMMON_GRP = C.COMMON_GRP
                 AND B.COMMON_CD = C.COMMON_CD                   
		         WHERE  B.COMMON_GRP = 'PP00141'
		         AND    B.COMMON_CD  = TDP.PROD_GRP) PROD_GRP_NM,
		       TDP.PROD_LVL          ,
		       TDP.SVC_GRP           ,
		       TDP.USE_MM_TYP        ,
		       TDP.SUBS_FL           ,
		       TDP.DISP_PRI_NO       ,
		       TDP.MOD_DESC          ,
		       TDP.PROD_DESC         ,
		       TDP.MSTR_FL           ,
		       TDP.REGR_ID      ,
		       TDP.REG_DATE    ,
		       TDP.CHGR_ID        ,
		       TDP.CHG_DATE			,
		       TDP.KPI_PROD_GRP_CD,
		       TDP.SO_ID,
               TDP.MNO_PROD_CD
		FROM   TPMPD_D_PROD TDP
		WHERE   PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.soId != null">
	    AND   TDP.SO_ID 	     = #{productDevMgt.soId}
	    </if>			
</select>

<delete id="delProduct" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM  TPMPD_D_PROD
		WHERE PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.soId != null">
	    AND   SO_ID 	     = #{productDevMgt.soId}
	    </if>			
</delete>

<delete id="delProductRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_D_PROD_REL
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.relProdCd != null">
	    AND   PROD_REL_TYP = #{productDevMgt.prodRelTyp}
		AND    REL_PROD_CD  = #{productDevMgt.relProdCd}
	    </if>		
</delete>

<delete id="delProductRelationshipGift" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_D_PROD_SUPRT_GIFT
		WHERE  PROD_CD = #{productDevMgt.prodCd}
</delete>

<delete id="delProductSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_D_PROD_SUBSCRIP_COND
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.condNo != null">
	    AND   COND_NO  = #{productDevMgt.condNo}
	    </if>		
</delete>

<delete id="delProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_D_PROD_ATTR
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.attrCd != null">
	    AND   ATTR_CD  = #{productDevMgt.attrCd}
	    </if>		
</delete>

<delete id="delSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_D_SUPRT_EQUIP
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.eqtClCd != null">
	    AND   EQT_CL_CD = #{productDevMgt.eqtClCd}
	    </if>			
</delete>

<delete id="delProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM  TPMPD_D_PROD_SVC
		WHERE PROD_CD = #{productDevMgt.prodCd}
		<if test="productDevMgt.svcCd != null">
		AND   SVC_CD IN ( SELECT SVC_CD
		               FROM   TPMSV_SVC
		               WHERE SVC_CD       = #{productDevMgt.svcCd}
		               )
	    </if>
</delete>

<delete id="delRateItemAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_RATE_ITM_ATTR
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )
	    </if>
	    
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
		WHERE RATE_ITM_CD IN (
		                 SELECT TDRI.RATE_ITM_CD
		                 FROM   TPMPD_D_PROD_SVC TDRS,
		                        TPMPD_D_RATE_ITM TDRI
		                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
		                 AND    TDRS.SVC_CD IN (
		                               SELECT SVC_CD
		                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
		                                        )
		                 AND    TDRS.SVC_CD = TDRI.SVC_CD
		                       )
	    </if>	    
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
	    </if>        
</delete>

<delete id="delRateItemFactor" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_RATE_ITM_FCTR
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>		

        <if test='productDevMgt.delFl.equals("FACTOR_DELETE")'>
   	    	WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
   	    	AND    FCTR_CD     = #{productDevMgt.fctrCd}
        </if>

</delete>

<delete id="delDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP
        
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>        
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>        
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>		

        <if test='productDevMgt.delFl.equals("SVC_RATE_ITM_TYP_DELETE")'>
   	    	WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
   	    	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}     
        </if>        
        
</delete>

<delete id="delRateItemCondition" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_RATE_ITM_COND

        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>     
        
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>         
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>		

        <if test='productDevMgt.delFl.equals("COND_DELETE")'>
   	    	WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
   	    	AND    COND_NO     = #{productDevMgt.condNo}    
        </if>  
</delete>

<delete id="delRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_RATE
        
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>           
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>   
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>		

        <if test='productDevMgt.delFl.equals("RATE_DELETE")'>
   	    	WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    FCTR_VAL1   = #{productDevMgt.fctrVal1}
			AND    FCTR_VAL2   = #{productDevMgt.fctrVal2}
			AND    FCTR_VAL3   = #{productDevMgt.fctrVal3}
			AND    FCTR_VAL4   = #{productDevMgt.fctrVal4}
			AND    FCTR_VAL5   = #{productDevMgt.fctrVal5}
			AND    FCTR_VAL6   = #{productDevMgt.fctrVal6}
			AND    FCTR_VAL7   = #{productDevMgt.fctrVal7}
			AND    FCTR_VAL8   = #{productDevMgt.fctrVal8}
			AND    FCTR_VAL9   = #{productDevMgt.fctrVal9} 
        </if> 

</delete>

<delete id="delDiscExclusionRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_DISC_EXCL
        
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>         
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>           

        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>		

        <if test='productDevMgt.delFl.equals("SVC_RATE_ITM_TYP_DELETE")'>
   	    	WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
   	    	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd} 
        </if>    	    
   	    
</delete>

<delete id="delDiscPeriod" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_DISC_PERD
        
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>         
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )        
        </if>          
        
        <if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
      	 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
        </if>        
</delete>

<delete id="delAllowance" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_ALWNCE
        WHERE  PROD_CD = #{productDevMgt.prodCd}
       	<if test="productDevMgt.alwnceCd != null">
	    AND   ALWNCE_CD = #{productDevMgt.alwnceCd}
	    </if>
</delete>

<delete id="delRateItem" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_RATE_ITM
        WHERE  PROD_CD = #{productDevMgt.prodCd}

       	<if test="productDevMgt.rateItmCd != null">
	    AND    RATE_ITM_CD = #{productDevMgt.rateItmCd}
	    </if>        
        
        <if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
       		   AND SVC_CD IN (
	               SELECT SVC_CD
	               FROM   TPMPD_D_PROD_SVC
	               WHERE  SVC_CD IN (
						               SELECT SVC_CD
						               FROM   TPMSV_SVC
						               WHERE SVC_CD       = #{productDevMgt.svcCd}
	    	                        )
	    	     )    
        </if>         
</delete>

<delete id="cancelProductDvlpHist" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_DVLP_HIST
		SET    PROD_DVLP_DTTM    = #{productDevMgt.currentDay}    ,
		       DVLP_STATUS       = #{productDevMgt.dvlpStatus}                  ,
		       CHGR_ID        = #{productDevMgt.chgrId}                  ,
		       CHG_DATE      = #{productDevMgt.sysdate}
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		AND    DVLP_STATUS  = '1'

</delete>

<insert id="addCopyProductRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_REL
		(
		    SELECT #{productDevMgt.prodCd}       ,
		           PROD_REL_TYP    ,
		           REL_PROD_CD     ,
		           INACT_DT      ,
		           ACT_DT       ,
		           MSTR_FL         ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>   
		           #{productDevMgt.chgrId}    ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
                   DEF_YN
		    FROM   TPMPD_PROD_REL
		    WHERE  PROD_CD = #{productDevMgt.oldProdCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyProductSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SUBSCRIP_COND
		(
			SELECT #{productDevMgt.prodCd}      ,
					COND_NO        ,
					INACT_DT     ,
					ACT_DT      ,
					FCTR_CD        ,
					COND_OPERATOR  ,
					OPRND_REF_FL   ,
					OPRND_1        ,
					OPRND_FCTR_CD_1,
					OPRND_2        ,
					OPRND_FCTR_CD_2,
					MSTR_FL        ,
					#{productDevMgt.regrId} ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
					#{productDevMgt.chgrId}   ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()
                       </when>
       			</choose>  
			FROM   TPMPD_PROD_SUBSCRIP_COND
		    WHERE  PROD_CD = #{productDevMgt.oldProdCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_ATTR
		(
		    SELECT #{productDevMgt.prodCd},
		           ATTR_CD,
		           INACT_DT,
		           ACT_DT,
		           ATTR_VAL,
		           MSTR_FL,
		           #{productDevMgt.regrId},
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId},
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()
                       </when>
       			</choose>  
		    FROM   TPMPD_PROD_ATTR
		    WHERE  PROD_CD = #{productDevMgt.oldProdCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SVC
		(
		    SELECT #{productDevMgt.prodCd}         ,
		           SVC_CD            ,
		           INACT_DT        ,
		           ACT_DT         ,
		           SUBSCRIP_CMPS_FL  ,
		           ''            ,
		           OPT_SVC_CMPS_FL   ,
		           MULTI_CMPS_FL     ,
		           CMPS_QTY_FROM     ,
		           CMPS_QTY_TO       ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId}    ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}    ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           ''	,
		           ''	,
		           ''
		    FROM   TPMPD_PROD_SVC
		    WHERE  PROD_CD = #{productDevMgt.oldProdCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyProdSuprtGift" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SUPRT_GIFT
		(
		  SELECT #{productDevMgt.prodCd}         ,
		         GIFT_ID               ,
		         REL_PROD_CD		,
		         INACT_DT            ,
		         ACT_DT             ,
		         MSTR_FL               ,
		         #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		         #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
		  FROM   TPMPD_PROD_SUPRT_GIFT
		  WHERE  PROD_CD    = #{productDevMgt.oldProdCd}
		  AND    MSTR_FL    = '1'
		  AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopySuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    INSERT INTO TPMPD_D_SUPRT_EQUIP
    (
		    PROD_CD          ,
		    EQT_CL_CD        ,
		    INACT_DT       ,
		    ACT_DT        ,
		    SBJ_PROD_CD      ,
		    SVC_CD           ,
		    CMPS_QTY_FROM    ,
		    CMPS_QTY_TO      ,
		    MSTR_FL          ,
		    REGR_ID     ,
		    REG_DATE   ,
		    CHGR_ID       ,
		    CHG_DATE     ,
		    DISP_PRI_NO
	)
    (
        SELECT #{productDevMgt.prodCd}        ,
               EQT_CL_CD        ,
               INACT_DT       ,
               ACT_DT        ,
               SBJ_PROD_CD      ,
               SVC_CD           ,
               CMPS_QTY_FROM    ,
               CMPS_QTY_TO      ,
               MSTR_FL          ,
               #{productDevMgt.regrId}   ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
               #{productDevMgt.chgrId}     ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
               DISP_PRI_NO
        FROM   TPMPD_SUPRT_EQUIP
        WHERE  PROD_CD = #{productDevMgt.oldProdCd}
        AND    MSTR_FL = '1'
        AND    INACT_DT >= #{productDevMgt.currentDay}
    )

</insert>

<select id="getRateItmCdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_RATE_ITM
	WHERE  PROD_CD = #{productDevMgt.oldProdCd}  
	AND    MSTR_FL = '1'
	AND    INACT_DT >= #{productDevMgt.currentDay}
</select>

<insert id="addCopyRateItem" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
			       INACT_DT            ,
			       ACT_DT             ,
			       RATE_ITM_NM           ,
			       RATE_ITM_ABBR_NM      ,
			       RATE_ITM_ENG_NM       ,
			       ''  ,
			       #{productDevMgt.prodCd}  ,
			       SVC_CD                ,
			       SVC_RATE_ITM_TYP_CD   ,
			       CHRG_CTGRY            ,
			       RATE_LOCAT            ,
			       RATE_REF_TYP          ,
			       DEFLT_RATE_ITM_CD     ,
			       RATE_PRI_NO           ,
			       DISP_PRI_NO           ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
                   ''
			FROM   TPMPD_RATE_ITM
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
	               AND    SUBSTR(RATE_ITM_CD, 0, 2) = 'RI'
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
                   AND    SUBSTR(RATE_ITM_CD, 1, 2) = 'RI'
                  </when>
  			</choose> 
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyRateItemAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_ATTR
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
			       ATTR_CD               ,
			       INACT_DT            ,
			       ACT_DT             ,
			       ATTR_VAL              ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
		       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE_ITM_ATTR
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyRateItemFactor" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_FCTR
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
					FCTR_CD           ,
					INACT_DT        ,
					ACT_DT         ,
					FCTR_NO           ,
					RATE_INFO_EXE_FL  ,
					FCTR_REF_TYP      ,
					TABLE_ID          ,
					COLMN_ID          ,
			       DATA_TYP       ,
			       ''   ,
 				   ''   ,
				   ''   ,
				   '' ,
					REF_CD            ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           REF_FUNC			,
		           CHG_NULL_FL		,
		           CHG_NULL_VAL
			FROM   TPMPD_RATE_ITM_FCTR
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_SVC_RT_ITM_TYP
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
			       SVC_RATE_ITM_TYP_CD   ,
			       INACT_DT            ,
			       ACT_DT             ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_SVC_RATE_ITM_TYP
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyRateItemCondition" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_COND
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
					COND_NO          ,
					INACT_DT       ,
					ACT_DT        ,
					FCTR_CD          ,
					COND_OPERATOR    ,
					OPRND_REF_FL     ,
					OPRND_1          ,
					OPRND_FCTR_CD_1  ,
					OPRND_2          ,
					OPRND_FCTR_CD_2  ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE_ITM_COND
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
					FCTR_VAL1       ,
					FCTR_VAL2       ,
					FCTR_VAL3       ,
					FCTR_VAL4       ,
					FCTR_VAL5       ,
					FCTR_VAL6       ,
					FCTR_VAL7       ,
					FCTR_VAL8       ,
					FCTR_VAL9       ,
					INACT_DT      ,
					ACT_DT       ,
					RATE_REF_FL     ,
					RATE_VAL        ,
					RATE_FCTR_CD    ,
					DIVI_RATE_AMT   ,
					QTY_REF_FL      ,
					QTY             ,
					QTY_FCTR_CD     ,
					CRNCY_REF_FL    ,
					CRNCY_CD        ,
					CRNCY_FCTR_CD   ,
					ALWNCE_CD       ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.regrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyDiscExclusionRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_EXCL
		(
			SELECT #{productDevMgt.newRateItmCd}     ,
			       SVC_RATE_ITM_TYP_CD   ,
			       INACT_DT            ,
			       ACT_DT             ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.regrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_EXCL
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addCopyDiscPeriod" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_PERD
		(
			SELECT #{productDevMgt.newRateItmCd}    ,
			       INACT_DT            ,
			       ACT_DT             ,
					OPERATOR         ,
					OPRND_REF_FL_1   ,
					OPRND_1          ,
					OPRND_FCTR_CD_1  ,
					OPRND_REF_FL_2   ,
					OPRND_2          ,
					OPRND_FCTR_CD_2  ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.regrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_PERD
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<select id="getAlwnceCdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT ALWNCE_CD,  
			   #{productDevMgt.newAlwnceCd},
		       #{productDevMgt.prodCd} AS PROD_CD,
		       #{productDevMgt.oldProdCd} AS OLD_PROD_CD,
		       #{productDevMgt.regrId} AS REGR_ID,
		       #{productDevMgt.chgrId}   AS CHGR_ID
		FROM   TPMPD_ALWNCE
		WHERE  PROD_CD = #{productDevMgt.oldProdCd}
		AND    MSTR_FL = '1'
		AND    INACT_DT = #{productDevMgt.inactDt}
</select>

<update id="modCopyRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_RATE
		SET    ALWNCE_CD   = #{productDevMgt.newAlwnceCd}
		WHERE  ALWNCE_CD   = #{productDevMgt.alwnceCd}
		AND    MSTR_FL = '1'
		AND    INACT_DT >= #{productDevMgt.currentDay}
</update>

<insert id="addCopyAllowance" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_ALWNCE
		(
			SELECT #{productDevMgt.newAlwnceCd}     ,
					INACT_DT             ,
					ACT_DT              ,
					ALWNCE_NM              ,
					#{productDevMgt.prodCd}              ,
					ALWNCE_TYP             ,
					ALWNCE_APPL_LVL        ,
					ALWNCE_UNT             ,
					ALWNCE_AMT_SBJ         ,
					ALWNCE_APPL_UOM        ,
					ALWNCE_AMT_TYP         ,
					PRORATE_TYP            ,
					REGT_ALWNCE_AMT        ,
					ALWNCE_AMNT            ,
					ROLLOVR_FL             ,
					ROLLOVR_CNT            ,
					THRS_NOTI_MTHD_REF_FL  ,
					THRS_NOTI_MTHD         ,
					THRS_UOM               ,
					THRS1                  ,
					THRS2                  ,
					THRS3                  ,
			       MSTR_FL               ,
			       #{productDevMgt.regrId}        ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}          ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TP_ALWNCE
			WHERE  ALWNCE_CD = #{productDevMgt.alwnceCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<select id="getCopyProductList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TP.PROD_CD           ,
		       TP.INACT_DT        ,
		       TP.ACT_DT         ,
		       TP.PROD_NM           ,
		       TP.PROD_ABBR_NM      ,
		       TP.PROD_ENG_NM       ,
		       TP.PROD_ENG_ABBR_NM  ,
		       TP.BASIC_PROD_FL     ,
		       TP.USG_RATE_PRI_NO   ,
		       TP.PROD_TYP          ,
		       ( SELECT C.CODE_NM
		         FROM   TSYCO_CODE_DETAIL B
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               	 ON  #{productDevMgt.lngTyp} = C.LNG_TYP 
           		 AND B.COMMON_GRP = C.COMMON_GRP
                 AND B.COMMON_CD = C.COMMON_CD     
		         WHERE  B.COMMON_GRP = 'PP00068'
		         AND    B.COMMON_CD  = TP.PROD_TYP) PROD_TYP_NM,
		       TP.PROD_GRP          ,
		       ( SELECT B.COMMON_CD_NM
		         FROM   TSYCO_CODE_DETAIL B
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               	 ON  #{productDevMgt.lngTyp} = C.LNG_TYP 
           		 AND B.COMMON_GRP = C.COMMON_GRP
                 AND B.COMMON_CD = C.COMMON_CD                  
		         WHERE  B.COMMON_GRP = 'PP00141'
		         AND    B.COMMON_CD  = TP.PROD_GRP) PROD_GRP_NM,
		       TP.PROD_LVL          ,
		       TP.SVC_GRP           ,
		       TP.USE_MM_TYP        ,
		       TP.SUBS_FL           ,
		       TP.DISP_PRI_NO       ,
		       TP.MOD_DESC          ,
		       TP.PROD_DESC         ,
		       TP.MSTR_FL           ,
		       TP.REGR_ID      ,
		       TP.REG_DATE    ,
		       TP.CHGR_ID        ,
		       TP.CHG_DATE,
		       TP.KPI_PROD_GRP_CD,
		       TP.SO_ID,
               TP.MNO_PROD_CD,
	            (SELECT SO_NM
	              FROM TSYCO_SO_MAST
	              WHERE SO_ID = TP.SO_ID) AS SO_NM               
		FROM   TPMPD_PROD TP
		WHERE   TP.MSTR_FL        = '1'
		AND     TP.INACT_DT    >= #{productDevMgt.currentDay}
		AND	   SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 
		ORDER BY PROD_TYP_NM, TP.PROD_NM ASC
</select>

<select id="getEqtClCdComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TEC.EQT_CL_CD ,
			    TEC.EQT_CL_NM ,
                TEC.ITEM_NM
		FROM    IFNPM_EQT_CL TEC
        WHERE   TEC.SO_ID = #{productDevMgt.soId}
		<if test="productDevMgt.eqtClCd != null">
	    	AND   EQT_CL_CD = #{productDevMgt.eqtClCd}
	    </if>
	    <if test="productDevMgt.eqtClNm != null">
	        AND   EQT_CL_NM LIKE '%' || #{productDevMgt.eqtClNm} || '%'  
	    </if>   
</select>

<select id="getProductUpdateExtractList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TP.PROD_TYP,
		        (
		            SELECT C.CODE_NM
		            FROM   TSYCO_CODE_DETAIL B
                    LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                    ON 	#{productDevMgt.lngTyp} = C.LNG_TYP 
					AND B.COMMON_GRP = C.COMMON_GRP
                 	AND B.COMMON_CD = C.COMMON_CD                     
		            WHERE  TP.PROD_TYP  = B.COMMON_CD
		            AND    B.COMMON_GRP = 'PP00068'
		        ) PROD_TYP_NM,
		        TP.PROD_CD,
		        TP.PROD_NM,
		        TP.SO_ID,
               TP.MNO_PROD_CD,
	            (SELECT SO_NM
	              FROM TSYCO_SO_MAST
	              WHERE SO_ID = TP.SO_ID) AS SO_NM    		        
		FROM    TPMPD_PROD TP
		WHERE   TP.PROD_CD NOT IN (
		                            SELECT TDP.PROD_CD FROM TPMPD_D_PROD TDP
		                         )
		AND	   SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach>
		AND     TP.MSTR_FL = '1'
		AND     TP.INACT_DT  >= #{productDevMgt.currentDay}
		ORDER BY PROD_TYP_NM, TP.PROD_NM ASC
</select>

<insert id="addExtractProduct" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD
		(
		    SELECT PROD_CD           ,
		           INACT_DT        ,
		           SO_ID             ,
		           ACT_DT         ,
		           PROD_NM           ,
		           PROD_ABBR_NM      ,
		           PROD_ENG_NM       ,
		           PROD_ENG_ABBR_NM  ,
		           BASIC_PROD_FL     ,
		           USG_RATE_PRI_NO   ,
		           PROD_TYP          ,
		           PROD_GRP          ,
		           PROD_LVL          ,
		           SVC_GRP           ,
		           USE_MM_TYP        ,
		           SUBS_FL           ,
		           ''            ,
		           DISP_PRI_NO       ,
		           MOD_DESC          ,
		           PROD_DESC         ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId},
	
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  		           
		           #{productDevMgt.chgrId}      ,
		
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  		           
		           KPI_PROD_GRP_CD,
                   MNO_PROD_CD,
                   MNO_UNIT_SVC_CD
		    FROM   TPMPD_PROD
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
			<if test="productDevMgt.soId != null">
		    	AND SO_ID = #{productDevMgt.soId}
		    </if>		    
		)
</insert>

<insert id="addExtractProductRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_REL
		(
		    SELECT PROD_CD         ,
		           PROD_REL_TYP    ,
		           REL_PROD_CD     ,
		           INACT_DT      ,
		           ACT_DT       ,
		           MSTR_FL         ,
		           #{productDevMgt.regrId}  ,
		           #{productDevMgt.inactDate},
		           #{productDevMgt.chgrId}      ,
		           #{productDevMgt.inactDate},
                   DEF_YN
		    FROM   TPMPD_PROD_REL
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractProductSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SUBSCRIP_COND
		(
			SELECT PROD_CD        ,
			       COND_NO        ,
					INACT_DT     ,
					ACT_DT      ,
					FCTR_CD        ,
					COND_OPERATOR  ,
					OPRND_REF_FL   ,
					OPRND_1        ,
					OPRND_FCTR_CD_1,
					OPRND_2        ,
					OPRND_FCTR_CD_2,
					MSTR_FL        ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_PROD_SUBSCRIP_COND
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_ATTR
		(
		    SELECT PROD_CD,
		           ATTR_CD,
		           INACT_DT,
		           ACT_DT,
		           ATTR_VAL,
		           MSTR_FL,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
		    FROM   TPMPD_PROD_ATTR
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SVC
		(
		    SELECT PROD_CD           ,
		           SVC_CD            ,
		           INACT_DT        ,
		           ACT_DT         ,
		           SUBSCRIP_CMPS_FL  ,
		           ''            ,
		           OPT_SVC_CMPS_FL   ,
		           MULTI_CMPS_FL     ,
		           CMPS_QTY_FROM     ,
		           CMPS_QTY_TO       ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           '',
		            '',
		           ''
		    FROM   TPMPD_PROD_SVC
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND    MSTR_FL = '1'
		    AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractProdSuprtGift" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SUPRT_GIFT
		(
		  SELECT PROD_CD               ,
		         GIFT_ID               ,
		         REL_PROD_CD	,
		         INACT_DT            ,
		         ACT_DT             ,
		         MSTR_FL               ,
	           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
	           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
		  FROM   TPMPD_PROD_SUPRT_GIFT
		  WHERE  PROD_CD = #{productDevMgt.prodCd}
		  AND    MSTR_FL = '1'
		  AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    INSERT INTO TPMPD_D_SUPRT_EQUIP
    (
		    PROD_CD          ,
		    EQT_CL_CD        ,
		    INACT_DT       ,
		    ACT_DT        ,
		    SBJ_PROD_CD      ,
		    SVC_CD           ,
		    CMPS_QTY_FROM    ,
		    CMPS_QTY_TO      ,
		    MSTR_FL          ,
		    REGR_ID     ,
		    REG_DATE   ,
		    CHGR_ID       ,
		    CHG_DATE     ,
		    DISP_PRI_NO
	)
    (
        SELECT PROD_CD          ,
               EQT_CL_CD        ,
               INACT_DT       ,
               ACT_DT        ,
               SBJ_PROD_CD      ,
               SVC_CD           ,
               CMPS_QTY_FROM    ,
               CMPS_QTY_TO      ,
               MSTR_FL          ,
	           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
	           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
               DISP_PRI_NO
        FROM   TPMPD_SUPRT_EQUIP
        WHERE  PROD_CD = #{productDevMgt.prodCd}
        AND    MSTR_FL = '1'
        AND    INACT_DT >= #{productDevMgt.currentDay}
    )
</insert>


<select id="getExtractRateItem"  resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT (CASE WHEN COUNT( RATE_ITM_CD ) IS NULL THEN
        		0 ELSE COUNT( RATE_ITM_CD )
        		END ) AS DATA_CNT
        FROM   TPMPD_RATE_ITM
        WHERE  PROD_CD = #{productDevMgt.prodCd}
        AND    MSTR_FL = '1'
        AND    INACT_DT >= #{productDevMgt.currentDay}
</select>

<insert id="addExtractRateItem" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM
		(
			SELECT RATE_ITM_CD           ,
			       INACT_DT            ,
			       ACT_DT             ,
			       RATE_ITM_NM           ,
			       RATE_ITM_ABBR_NM      ,
			       RATE_ITM_ENG_NM       ,
			       ''  ,
			       PROD_CD               ,
			       SVC_CD                ,
			       SVC_RATE_ITM_TYP_CD   ,
			       CHRG_CTGRY            ,
			       RATE_LOCAT            ,
			       RATE_REF_TYP          ,
			       DEFLT_RATE_ITM_CD     ,
			       RATE_PRI_NO           ,
			       DISP_PRI_NO           ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
                   ''
			FROM   TPMPD_RATE_ITM
			WHERE  PROD_CD = #{productDevMgt.prodCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractRateItemAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_ATTR
		(
			SELECT RATE_ITM_CD           ,
			       ATTR_CD               ,
			       INACT_DT            ,
			       ACT_DT             ,
			       ATTR_VAL              ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE_ITM_ATTR
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractRateItemFactor" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_FCTR
		(
			SELECT RATE_ITM_CD           ,
					FCTR_CD           ,
					INACT_DT        ,
					ACT_DT         ,
					FCTR_NO           ,
					RATE_INFO_EXE_FL  ,
					FCTR_REF_TYP      ,
					TABLE_ID          ,
					COLMN_ID          ,
			       DATA_TYP       ,
			       ''   ,
 				   ''   ,
				   ''   ,
				   '' ,
					REF_CD            ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           REF_FUNC			,
		           CHG_NULL_FL		,
		           CHG_NULL_VAL
			FROM   TPMPD_RATE_ITM_FCTR
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)

</insert>

<insert id="addExtractDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_SVC_RT_ITM_TYP
		(
			SELECT RATE_ITM_CD           ,
			       SVC_RATE_ITM_TYP_CD   ,
			       INACT_DT            ,
			       ACT_DT             ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_SVC_RATE_ITM_TYP
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractRateItemCondition" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_COND
		(
			SELECT RATE_ITM_CD           ,
					COND_NO          ,
					INACT_DT       ,
					ACT_DT        ,
					FCTR_CD          ,
					COND_OPERATOR    ,
					OPRND_REF_FL     ,
					OPRND_1          ,
					OPRND_FCTR_CD_1  ,
					OPRND_2          ,
					OPRND_FCTR_CD_2  ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE_ITM_COND
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE
		(
			SELECT RATE_ITM_CD           ,
					FCTR_VAL1       ,
					FCTR_VAL2       ,
					FCTR_VAL3       ,
					FCTR_VAL4       ,
					FCTR_VAL5       ,
					FCTR_VAL6       ,
					FCTR_VAL7       ,
					FCTR_VAL8       ,
					FCTR_VAL9       ,
					INACT_DT      ,
					ACT_DT       ,
					RATE_REF_FL     ,
					RATE_VAL        ,
					RATE_FCTR_CD    ,
					DIVI_RATE_AMT   ,
					QTY_REF_FL      ,
					QTY             ,
					QTY_FCTR_CD     ,
					CRNCY_REF_FL    ,
					CRNCY_CD        ,
					CRNCY_FCTR_CD   ,
					ALWNCE_CD       ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_RATE
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractDiscExclusionRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_EXCL
		(
			SELECT RATE_ITM_CD           ,
			       SVC_RATE_ITM_TYP_CD   ,
			       INACT_DT            ,
			       ACT_DT             ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
	       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_EXCL
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractDiscPeriod" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_PERD
		(
			SELECT RATE_ITM_CD           ,
			       INACT_DT            ,
			       ACT_DT             ,
					OPERATOR         ,
					OPRND_REF_FL_1   ,
					OPRND_1          ,
					OPRND_FCTR_CD_1  ,
					OPRND_REF_FL_2   ,
					OPRND_2          ,
					OPRND_FCTR_CD_2  ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_DISC_PERD
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                AND  MSTR_FL = '1'
                                AND  INACT_DT >= #{productDevMgt.currentDay}
                                  )
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addExtractAllowance" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_ALWNCE
		(
			SELECT ALWNCE_CD           ,
					INACT_DT             ,
					ACT_DT              ,
					ALWNCE_NM              ,
					PROD_CD                ,
					ALWNCE_TYP             ,
					ALWNCE_APPL_LVL        ,
					ALWNCE_UNT             ,
					ALWNCE_AMT_SBJ         ,
					ALWNCE_APPL_UOM        ,
					ALWNCE_AMT_TYP         ,
					PRORATE_TYP            ,
					REGT_ALWNCE_AMT        ,
					ALWNCE_AMNT            ,
					ROLLOVR_FL             ,
					ROLLOVR_CNT            ,
					THRS_NOTI_MTHD_REF_FL  ,
					THRS_NOTI_MTHD         ,
					THRS_UOM               ,
					THRS1                  ,
					THRS2                  ,
					THRS3                  ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}  ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId}      ,
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         
                       </when>
       			</choose>  
			FROM   TPMPD_ALWNCE
			WHERE  PROD_CD = #{productDevMgt.prodCd}
			AND    MSTR_FL = '1'
			AND    INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<select id="getProductServiceListCount" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
        SELECT  COUNT(*)
        FROM    TPMPD_D_PROD_SVC TDPS,
                (
                  SELECT A.SVC_CD,
                         A.SVC_NM,
                         A.UPR_SVC_CD,
                         A.MAIN_SVC_CD,
                         A.DISP_PRI_NO
                  FROM  (
                           SELECT SVC_CD,
                                  SVC_NM,
                                  UPR_SVC_CD,
                                  MAIN_SVC_CD,
                                  DISP_PRI_NO
                           FROM   TPMSV_SVC TS
                           WHERE  INACT_DT = #{productDevMgt.inactDt}
                           ORDER  BY DISP_PRI_NO
                         ) A ) V_TS
        WHERE   TDPS.SVC_CD = V_TS.SVC_CD
          AND   TDPS.PROD_CD = #{productDevMgt.prodCd}
        ORDER BY V_TS.DISP_PRI_NO
</select>

<select id="getProductServiceList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT  TDPS.PROD_CD,
                TDPS.SVC_CD,
                TDPS.ACT_DT,
                TDPS.INACT_DT,
                V_TS.SVC_NM,
                V_TS.UPR_SVC_CD,
                (SELECT SVC_NM
                 FROM TPMSV_SVC Z
                 WHERE MSTR_FL = '1'
                 AND Z.SVC_CD = V_TS.UPR_SVC_CD) UPR_SVC_NM,
                (SELECT SVC_NM
                 FROM TPMSV_SVC Z
                 WHERE MSTR_FL = '1'
                 AND Z.SVC_CD = V_TS.MAIN_SVC_CD) MAIN_SVC_NM,
                ( SELECT C.CODE_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00021'
                  AND    B.COMMON_CD  = TDPS.SUBSCRIP_CMPS_FL ) SUBSCRIP_CMPS_FL_NM,
                (SELECT C.CODE_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00076'
                  AND    B.COMMON_CD  = TDPS.ESS_FL ) ESS_FL_NM,
                ( SELECT C.CODE_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00078'
                  AND    B.COMMON_CD  = TDPS.OPT_SVC_CMPS_FL ) OPT_SVC_CMPS_FL_NM,
                ( SELECT C.CODE_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00077'
                  AND    B.COMMON_CD  = TDPS.MULTI_CMPS_FL ) MULTI_CMPS_FL_NM,
               TDPS.CMPS_QTY_FROM,
               TDPS.CMPS_QTY_TO,
               TDPS.CHG_DATE,
               TDPS.KPI_SVC_GRP_CD
        FROM    TPMPD_D_PROD_SVC TDPS,
                (
                  SELECT A.SVC_CD,
                         A.SVC_NM,
                         A.UPR_SVC_CD,
                         A.MAIN_SVC_CD,
                         A.DISP_PRI_NO
                  FROM  (
                           SELECT SVC_CD,
                                  SVC_NM,
                                  UPR_SVC_CD,
                                  MAIN_SVC_CD,
                                  DISP_PRI_NO
                           FROM   TPMSV_SVC TS
                           WHERE  INACT_DT = #{productDevMgt.inactDt}
                           ORDER  BY DISP_PRI_NO
                         ) A ) V_TS
        WHERE   TDPS.SVC_CD = V_TS.SVC_CD
          AND   TDPS.PROD_CD = #{productDevMgt.prodCd}
        ORDER   BY V_TS.DISP_PRI_NO ASC
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>



<select id="getAddProductServiceInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  V_TS.SVC_CD,
		        V_TS.SVC_NM,
		        V_TS.UPR_SVC_CD,
		        (
		           SELECT SVC_NM
		           FROM   TPMSV_SVC TS
		           WHERE  MSTR_FL = '1'
		           AND    TS.SVC_CD = V_TS.UPR_SVC_CD
		        ) UPR_LVL_SVC_NM,
		        (
		           SELECT SVC_NM
		           FROM   TPMSV_SVC TS
		           WHERE  MSTR_FL = '1'
		           AND    TS.SVC_CD = V_TS.MAIN_SVC_CD
		        ) MAIN_SVC_NM
		FROM    (
		          SELECT A.SVC_CD,
		                 A.SVC_NM,
		                 A.UPR_SVC_CD,
		                 A.MAIN_SVC_CD,
		                 A.DISP_PRI_NO,
		                 A.SO_ID
		          FROM   (
		                   SELECT SVC_CD,
		                          SVC_NM,
		                          UPR_SVC_CD,
		                          MAIN_SVC_CD,
		                          DISP_PRI_NO,
		                          SO_ID
		                   FROM   TPMSV_SVC
		                   WHERE  INACT_DT = #{productDevMgt.inactDt}
		                   AND MSTR_FL = '1'
		                   ORDER BY DISP_PRI_NO
		                 )A ) V_TS
		WHERE   NOT EXISTS
		               (
		                 SELECT 1
		                 FROM   TPMPD_D_PROD_SVC TDPS
		                 WHERE  TDPS.SVC_CD = V_TS.SVC_CD
		                 AND    TDPS.PROD_CD = #{productDevMgt.prodCd}
		               )
		<if test="productDevMgt.soId != null and productDevMgt.soId != '' ">
	    	AND V_TS.SO_ID = #{productDevMgt.soId}
	    </if>     		        
		ORDER   BY V_TS.DISP_PRI_NO ASC

</select>

<insert id="addProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_SVC
		(
		    SELECT #{productDevMgt.prodCd},
		           SVC.SVC_CD,
		           #{productDevMgt.inactDt},
		           #{productDevMgt.currentDay},
		           '1' SUBSCRIP_CMPS_FL  ,
		           NULL ESS_FL            ,
		           NULL OPT_SVC_CMPS_FL   ,
		           NULL MULTI_CMPS_FL     ,
		           NULL CMPS_QTY_FROM     ,
		           NULL CMPS_QTY_TO       ,
		           #{productDevMgt.mstrFl},
		           #{productDevMgt.regrId},
		           #{productDevMgt.sysdate},
		           #{productDevMgt.chgrId} ,
		           #{productDevMgt.sysdate},
		           '',
		           NULL KPI_BIZ_CL,
		           NULL PROD_TYP
		    FROM (
		            SELECT SVC_CD
		            FROM   (
		                     SELECT A.SVC_CD
		                     FROM   (
		                               SELECT SVC_CD,
		                                      UPR_SVC_CD
		                               FROM   TPMSV_SVC
		                               WHERE  INACT_DT = #{productDevMgt.inactDt}
		                               ORDER BY DISP_PRI_NO
		                            ) A
		                     WHERE A.SVC_CD = #{productDevMgt.svcCd}      
		                     UNION
		                     SELECT B.SVC_CD
		                     FROM   (
		                              SELECT SVC_CD,
		                                     UPR_SVC_CD
		                              FROM   TPMSV_SVC
		                              WHERE  INACT_DT = #{productDevMgt.inactDt}
		                              ORDER BY DISP_PRI_NO
		                             ) B
		                     WHERE B.SVC_CD = #{productDevMgt.svcCd}         
		                   ) V_TS
		            WHERE  NOT EXISTS (
		                                 SELECT 1
		                                 FROM   TPMPD_D_PROD_SVC TDPS
		                                 WHERE  TDPS.SVC_CD  = V_TS.SVC_CD
		                                 AND    TDPS.PROD_CD = #{productDevMgt.prodCd}
		                              )
		         ) SVC
		)
</insert>

<update id="modProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_D_PROD_SVC
		SET     SUBSCRIP_CMPS_FL =  #{productDevMgt.subscripCmpsFl, jdbcType=VARCHAR }  ,
		        OPT_SVC_CMPS_FL  =  #{productDevMgt.optSvcCmpsFl, jdbcType=VARCHAR }  ,
		        ESS_FL           =  #{productDevMgt.essFl, jdbcType=VARCHAR }  ,
		        MULTI_CMPS_FL    =  #{productDevMgt.multiCmpsFl, jdbcType=VARCHAR }  ,
		        CMPS_QTY_FROM    =  #{productDevMgt.cmpsQtyFrom, jdbcType=VARCHAR }  ,
		        CMPS_QTY_TO      =  #{productDevMgt.cmpsQtyTo, jdbcType=VARCHAR }  ,
		        CHGR_ID       =  #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		        CHG_DATE     =  #{productDevMgt.sysdate},
		        KPI_SVC_GRP_CD = #{productDevMgt.kpiSvcSvcGrpCd, jdbcType=VARCHAR }
		WHERE   PROD_CD  = #{productDevMgt.prodCd}
		AND     SVC_CD   = #{productDevMgt.svcCd}     
</update>

<select id="getSuprtEquipListCount" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
		SELECT  COUNT(*)
		FROM    TPMPD_D_SUPRT_EQUIP TDSE
		WHERE   TDSE.PROD_CD     = #{productDevMgt.prodCd}
		ORDER BY TDSE.DISP_PRI_NO
</select>

<select id="getSuprtEquipList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDSE.PROD_CD ,
		        TDSE.EQT_CL_CD ,
		        (SELECT TEC.EQT_CL_NM
		         FROM   IFNPM_EQT_CL TEC
		         WHERE  TEC.EQT_CL_CD = TDSE.EQT_CL_CD ) AS EQT_CL_NM ,
		        TDSE.SBJ_PROD_CD ,
		        (SELECT TP.PROD_NM
		         FROM   TPMPD_PROD TP
		         WHERE  TP.PROD_CD = TDSE.SBJ_PROD_CD
		         AND    TP.MSTR_FL = '1'
		         AND    TP.INACT_DT >= #{productDevMgt.currentDay} ) SBJ_PROD_NM ,
		        TDSE.SVC_CD ,
		        (SELECT TS.SVC_NM
		         FROM   TPMSV_SVC TS
		         WHERE  TS.SVC_CD = TDSE.SVC_CD
		         AND    TS.MSTR_FL = '1'
		         AND    TS.INACT_DT >= #{productDevMgt.currentDay} ) SVC_NM ,
		        TDSE.CMPS_QTY_FROM ,
		        TDSE.CMPS_QTY_TO   ,
		        TDSE.DISP_PRI_NO		        
		FROM    TPMPD_D_SUPRT_EQUIP TDSE
		WHERE   TDSE.PROD_CD     = #{productDevMgt.prodCd}
		ORDER BY TDSE.DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>


<select id="getEqtClCdComboList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT '[]'  AS EQT_CL_CD ,
               'SEL' AS EQT_CL_NM
        FROM DUAL
        UNION ALL
        SELECT  TEC.EQT_CL_CD ,
                TEC.EQT_CL_NM
        FROM    IFNPM_EQT_CL TEC
        WHERE   TEC.EQT_CL_CD NOT IN ( SELECT TDSE.EQT_CL_CD
                                       FROM   TPMPD_D_SUPRT_EQUIP TDSE
                                       WHERE  TDSE.PROD_CD  =  #{productDevMgt.prodCd})
		<if test="productDevMgt.soId != null">
	    	AND   TEC.SO_ID = #{productDevMgt.soId}
	    </if>                                       
</select>

<select id="getSbjProdCdComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
            SELECT '[]'  AS PROD_CD ,
                   'SEL' AS PROD_NM ,
                   '[]'  AS EQT_CL_CD
            FROM DUAL
            UNION ALL
          SELECT  A.PROD_CD ,
                  A.PROD_NM ,
                  A.EQT_CL_CD
          FROM (
                 SELECT  TP.PROD_CD ,
                         TP.PROD_NM ,
                         (select Z.EQT_CL_CD 
                          from   IFNPM_EQT_CL Z
                          where  TP.MNO_PROD_CD = Z.ITEM_NM
                          and    Z.SO_ID = #{productDevMgt.soId}
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">                       
                          and    rownum = 1 ) AS EQT_CL_CD
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
                          limit 0,1 ) AS EQT_CL_CD
                        </when>
        			</choose>                        
                  FROM    TPMPD_PROD  TP
                  WHERE   PROD_TYP    =  '23'
                  AND     MSTR_FL     = '1'
                  AND     INACT_DT >= #{productDevMgt.currentDay}
                  AND     SO_ID       = #{productDevMgt.soId}
                  ORDER BY PROD_NM
                ) A
</select>

<select id="getNextDispPriNo2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT (CASE WHEN MAX(DISP_PRI_NO) IS NULL THEN 0 + 1
        		ELSE MAX(DISP_PRI_NO) + 1 
        		END) NEXT_DISP_PRI_NO
        FROM   TPMPD_D_SUPRT_EQUIP TDSE
        WHERE  TDSE.PROD_CD  =  #{productDevMgt.prodCd}
</select>

<select id="getSbjSvcCdComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
   		SELECT '[]'   AS SVC_CD ,
   		       'SEL' AS SVC_NM
   		FROM DUAL
   		UNION ALL
	   SELECT A.SVC_CD ,
	          A.SVC_NM
	   FROM   (
				SELECT  TPS.SVC_CD ,
					    TS.SVC_NM
				FROM    TPMPD_PROD_SVC  TPS ,
				        TPMSV_SVC       TS
				WHERE   TPS.PROD_CD    =  #{productDevMgt.sbjProdCd}
				AND     TPS.MSTR_FL    = '1'
				AND     TPS.INACT_DT >= #{productDevMgt.currentDay}
				AND     TS.SVC_CD      = TPS.SVC_CD
				AND     TS.SVC_TYP     = 'EQ'
	         	AND     TS.MSTR_FL     = '1'
				AND     TS.INACT_DT >= #{productDevMgt.currentDay}
				ORDER BY SVC_NM
		      ) A
</select>

<insert id="addSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_SUPRT_EQUIP
		(
		    PROD_CD          ,
		    EQT_CL_CD        ,
		    INACT_DT       ,
		    ACT_DT        ,
		    SBJ_PROD_CD      ,
		    SVC_CD           ,
		    CMPS_QTY_FROM    ,
		    CMPS_QTY_TO      ,
		    MSTR_FL          ,
		    REGR_ID     ,
		    REG_DATE   ,
		    CHGR_ID       ,
		    CHG_DATE     ,
		    DISP_PRI_NO
		)
		VALUES
		(
		    #{productDevMgt.prodCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.eqtClCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		    #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sbjProdCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.svcCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.cmpsQtyFrom, jdbcType=VARCHAR }  ,
		    #{productDevMgt.cmpsQtyTo, jdbcType=VARCHAR }  ,
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR }  ,
		    #{productDevMgt.regrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate}  ,
		    #{productDevMgt.dispPriNo, jdbcType=VARCHAR }
		)

</insert>

<select id="getSuprtEquip" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TDSE.PROD_CD ,
		        TDSE.EQT_CL_CD ,
		        (SELECT TEC.EQT_CL_NM
		         FROM   IFNPM_EQT_CL TEC
		         WHERE  TEC.EQT_CL_CD = TDSE.EQT_CL_CD ) AS EQT_CL_NM ,
		        TDSE.SBJ_PROD_CD ,
		        TDSE.SVC_CD ,
		        TDSE.CMPS_QTY_FROM ,
		        TDSE.CMPS_QTY_TO   ,
		        TDSE.DISP_PRI_NO
		FROM    TPMPD_D_SUPRT_EQUIP TDSE
		WHERE   TDSE.PROD_CD     = #{productDevMgt.prodCd}
		AND     TDSE.EQT_CL_CD   = #{productDevMgt.eqtClCd}
</select>

<update id="modSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_SUPRT_EQUIP
		SET    INACT_DT       = #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		       ACT_DT         = #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		       SBJ_PROD_CD      = #{productDevMgt.sbjProdCd, jdbcType=VARCHAR }  ,
		       SVC_CD           = #{productDevMgt.svcCd, jdbcType=VARCHAR }  ,
		       CMPS_QTY_FROM    = #{productDevMgt.cmpsQtyFrom, jdbcType=VARCHAR }  ,
		       CMPS_QTY_TO      = #{productDevMgt.cmpsQtyTo, jdbcType=VARCHAR }  ,
		       MSTR_FL          = #{productDevMgt.mstrFl, jdbcType=VARCHAR }  ,
		       CHGR_ID       = #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		       CHG_DATE      = #{productDevMgt.sysdate}  ,
		       DISP_PRI_NO      = #{productDevMgt.dispPriNo, jdbcType=VARCHAR }
		WHERE  PROD_CD          = #{productDevMgt.prodCd}
		AND    EQT_CL_CD        = #{productDevMgt.eqtClCd}
</update>

<select id="getProductAttrListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT COUNT(*)
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_D_PROD_ATTR TDPA
		         WHERE  TDPA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDPA.MSTR_FL              = '1'
		         AND    TDPA.PROD_CD              = #{productDevMgt.prodCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getProductAttrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT VWTS.PROD_CD,
		       VWAT.ATTR_CD,
		       VWAT.ATTR_NM,
		       VWAT.REF_CD,
		       VWAT.ATTR_STRT_VAL,
		       VWAT.ATTR_END_VAL,
		       VWTS.ATTR_VAL,
			   VWTS.ATTR_VAL AS ATTR_VAL_REF_CD,
			  (
			  CASE
			    WHEN (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD) IS NULL
			    THEN VWTS.ATTR_VAL
			    ELSE
			      (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD
			      )
			  END) AS ATTR_VAL_NM,
		       VWTS.INACT_DT,
		       VWTS.ACT_DT,
		       '1' AS MSTR_FL,
		       VWTS.ATTR_VAL AS BASE_ATTR_VAL,
		       VWTS.REGR_ID,
		       VWTS.CHGR_ID		       
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_D_PROD_ATTR TDPA
		         WHERE  TDPA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDPA.MSTR_FL              = '1'
		         AND    TDPA.PROD_CD              = #{productDevMgt.prodCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>


<select id="getProductAttrList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
		SELECT VWTS.PROD_CD,
		       VWAT.ATTR_CD,
		       VWAT.ATTR_NM,
		       VWAT.REF_CD,
		       VWAT.ATTR_STRT_VAL,
		       VWAT.ATTR_END_VAL,
		       VWTS.ATTR_VAL,
			   VWTS.ATTR_VAL AS ATTR_VAL_REF_CD,
			   VWTS.ATTR_VAL AS ATTR_VAL_NM,
		       VWTS.INACT_DT,
		       VWTS.ACT_DT,
		       '1' AS MSTR_FL,
		       VWTS.ATTR_VAL AS BASE_ATTR_VAL,
		       VWTS.REGR_ID,
		       VWTS.CHGR_ID		       
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_D_PROD_ATTR TDPA
		         WHERE  TDPA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDPA.MSTR_FL              = '1'
		         AND    TDPA.PROD_CD              = #{productDevMgt.prodCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getCommonGrpCdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
 		SELECT  B.COMMON_GRP,
		        B.COMMON_CD,
		        C.CODE_NM AS COMMON_CD_NM,
		        CONCAT(CONCAT(B.COMMON_GRP, '*'), B.COMMON_CD) AS COMMON_GRP_CD
		FROM    TSYCO_CODE_DETAIL      B
        LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C  
        ON #{lngTyp} = C.LNG_TYP
        AND B.COMMON_GRP = C.COMMON_GRP
        AND B.COMMON_CD = C.COMMON_CD
		WHERE   B.COMMON_GRP IN 
		<foreach collection="commonGrp" item="item" index="index" open="(" separator="," close=")">
        	#{item.refCd}
        </foreach>		
</select>

<select id="getProductAttrCnt" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT (CASE WHEN COUNT( ATTR_CD ) IS NULL THEN
        		0 ELSE COUNT( ATTR_CD ) 
        		END ) AS DATA_CNT
        FROM TPMPD_D_PROD_ATTR  
        WHERE   PROD_CD  = #{productDevMgt.prodCd}      
          AND   ATTR_CD  = #{productDevMgt.attrCd}    
</select>

<insert id="addProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_ATTR
		(
		    PROD_CD,
		    ATTR_CD,
		    ATTR_VAL,
		    CHGR_ID,
		    CHG_DATE,
		    INACT_DT,
		    ACT_DT,
		    REGR_ID,
		    REG_DATE,
		    MSTR_FL
		)
		VALUES
		(
		    #{productDevMgt.prodCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.attrCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.attrVal, jdbcType=VARCHAR }  ,
		    #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		    #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		    #{productDevMgt.regrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR }
		)
</insert>

<update id="modProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_D_PROD_ATTR
		SET     ATTR_VAL     = #{productDevMgt.attrVal, jdbcType=VARCHAR }  ,
		        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		        CHG_DATE = #{productDevMgt.sysdate},
		        INACT_DT   = #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		        ACT_DT    = #{productDevMgt.currentDay, jdbcType=VARCHAR }
		WHERE   PROD_CD  = #{productDevMgt.prodCd}      
		AND     ATTR_CD  = #{productDevMgt.attrCd}    
</update>

<select id="getProductRelationshipList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT TDPR.PROD_CD                                                     ,
               TDPR.REL_PROD_CD                                                 ,
               TDPR.PROD_REL_TYP                                                ,
               (SELECT TDP.PROD_NM
                FROM   TPMPD_D_PROD TDP
                WHERE  TDPR.PROD_CD    = TDP.PROD_CD) PROD_NM                   ,
               (SELECT C.CODE_NM AS COMMON_CD_NM
                FROM   TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		        ON #{productDevMgt.lngTyp} = C.LNG_TYP
		        AND B.COMMON_GRP = C.COMMON_GRP
		        AND B.COMMON_CD = C.COMMON_CD
                WHERE  B.COMMON_GRP = 'PP00067'
                    AND    B.COMMON_CD  = TDPR.PROD_REL_TYP) PROD_REL_TYP_NM     ,
               (SELECT TP.PROD_NM
                FROM   TPMPD_PROD TP
                WHERE  TDPR.REL_PROD_CD  = TP.PROD_CD
                AND    TP.MSTR_FL        = '1'
                AND    TP.INACT_DT    >= #{productDevMgt.currentDay}) REL_PROD_NM,
               TDPR.CHG_DATE               
        FROM   TPMPD_D_PROD_REL TDPR
        WHERE  TDPR.PROD_CD     = #{productDevMgt.prodCd} OR TDPR.REL_PROD_CD =  #{productDevMgt.prodCd} 
        ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getProductRelationshipListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
        SELECT COUNT(*)
        FROM   TPMPD_D_PROD_REL TDPR
        WHERE  TDPR.PROD_CD     = #{productDevMgt.prodCd} OR TDPR.REL_PROD_CD =  #{productDevMgt.prodCd} 
        ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD
</select>

<select id="getProductRelComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT  TP.PROD_CD,
                TP.PROD_NM
        FROM    TPMPD_PROD TP
        WHERE   TP.PROD_CD NOT IN
                (
                  SELECT TDPR.REL_PROD_CD
                  FROM   TPMPD_D_PROD_REL TDPR
                  WHERE  TDPR.PROD_CD = #{productDevMgt.prodCd}
                )
        AND     TP.MSTR_FL = '1'
        AND     TP.PROD_TYP LIKE #{productDevMgt.prodTyp}
        AND     TP.PROD_CD != #{productDevMgt.prodCd}
        AND     TP.SO_ID    = #{productDevMgt.soId}
		<if test="productDevMgt.subsFl != null">
		AND 	TP.SUBS_FL = #{productDevMgt.subsFl}
	    </if>         
</select>

<insert id="addProductRelationship" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_PROD_REL
		(
			PROD_CD                      ,
			PROD_REL_TYP                 ,
			REL_PROD_CD                  ,
			INACT_DT                   ,
			ACT_DT                    ,
			MSTR_FL                      ,
			REGR_ID                 ,
			REG_DATE               ,
			CHGR_ID                   ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.prodCd, jdbcType=VARCHAR },
			#{productDevMgt.prodRelTyp, jdbcType=VARCHAR },
			#{productDevMgt.relProdCd, jdbcType=VARCHAR },
			#{productDevMgt.inactDt, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR } ,
			#{productDevMgt.mstrFl, jdbcType=VARCHAR },
			#{productDevMgt.regrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate},          
			#{productDevMgt.chgrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate}
		)   
</insert>

<select id="getRateItmList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDRI.RATE_ITM_CD           ,
		        TDRI.INACT_DT            ,
		        TDRI.ACT_DT             ,
		        TDRI.RATE_ITM_NM           ,
		        TDRI.RATE_ITM_ABBR_NM      ,
		        TDRI.RATE_ITM_ENG_NM       ,
		        TDRI.RATE_ITM_ENG_ABBR_NM  ,
		        TDRI.PROD_CD               ,
		        TDRI.SVC_CD                ,
		        TDRI.SVC_RATE_ITM_TYP_CD   ,
		        TSRIT.SVC_RATE_ITM_TYP_NM   ,
		        TDRI.CHRG_CTGRY            ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                   ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00031'
		           AND    B.COMMON_CD   = TDRI.CHRG_CTGRY
		        ) CHRG_CTGRY_NM,
		        TDRI.RATE_LOCAT            ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00034'
		           AND    B.COMMON_CD   = TDRI.RATE_LOCAT
		        ) RATE_LOCAT_NM,
		        TDRI.RATE_REF_TYP          ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00032'
		           AND    B.COMMON_CD   = TDRI.RATE_REF_TYP
		        ) RATE_REF_TYP_NM          ,
		        TDRI.DEFLT_RATE_ITM_CD     ,
		        (
		           SELECT TRI.RATE_ITM_NM
		           FROM   TPMPD_RATE_ITM TRI
		           WHERE  TDRI.DEFLT_RATE_ITM_CD = TRI.RATE_ITM_CD
		           AND    TRI.INACT_DT  >= #{productDevMgt.currentDay}
		        ) DEFLT_RATE_ITM_NM        ,
		        TDRI.RATE_PRI_NO           ,
		        TDRI.DISP_PRI_NO           ,
		        TDRI.MSTR_FL               ,
		        TDRI.REGR_ID          ,
		        TDRI.REG_DATE        ,
		        TDRI.CHGR_ID            ,
		        TDRI.CHG_DATE,
		        '0' AS CHK,
                TDRI.MNO_RATE_ITM_CD               
		FROM    TPMPD_D_RATE_ITM   TDRI,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE   TDRI.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TDRI.SVC_CD       = TSRIT.SVC_CD
		AND     TSRIT.INACT_DT  >= #{productDevMgt.currentDay}
		AND     TDRI.PROD_CD      = #{productDevMgt.prodCd}
		AND     TDRI.SVC_CD       = #{productDevMgt.svcCd}
		ORDER BY TDRI.DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getRateItmList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDRI.RATE_ITM_CD           ,
		        TDRI.INACT_DT            ,
		        TDRI.ACT_DT             ,
		        TDRI.RATE_ITM_NM           ,
		        TDRI.RATE_ITM_ABBR_NM      ,
		        TDRI.RATE_ITM_ENG_NM       ,
		        TDRI.PROD_CD               ,
		        TDRI.SVC_CD                ,
		        TDRI.SVC_RATE_ITM_TYP_CD   ,
		        TSRIT.SVC_RATE_ITM_TYP_NM   ,
		        TDRI.CHRG_CTGRY            ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                   ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00031'
		           AND    B.COMMON_CD   = TDRI.CHRG_CTGRY
		        ) CHRG_CTGRY_NM,
		        TDRI.RATE_LOCAT            ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00034'
		           AND    B.COMMON_CD   = TDRI.RATE_LOCAT
		        ) RATE_LOCAT_NM,
		        TDRI.RATE_REF_TYP          ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON #{productDevMgt.lngTyp} = C.LNG_TYP
		           AND B.COMMON_GRP = C.COMMON_GRP
		           AND B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00032'
		           AND    B.COMMON_CD   = TDRI.RATE_REF_TYP
		        ) RATE_REF_TYP_NM          ,
		        TDRI.DEFLT_RATE_ITM_CD     ,
		        (
		           SELECT TRI.RATE_ITM_NM
		           FROM   TPMPD_RATE_ITM TRI
		           WHERE  TDRI.DEFLT_RATE_ITM_CD = TRI.RATE_ITM_CD
		           AND    TRI.INACT_DT  >= #{productDevMgt.currentDay}
		        ) DEFLT_RATE_ITM_NM        ,
		        TDRI.RATE_PRI_NO           ,
		        TDRI.DISP_PRI_NO           ,
		        TDRI.MSTR_FL               ,
		        TDRI.REGR_ID          ,
		        TDRI.REG_DATE        ,
		        TDRI.CHGR_ID            ,
		        TDRI.CHG_DATE,
		        '0' AS CHK            
		FROM    TPMPD_RATE_ITM   TDRI,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE   TDRI.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TDRI.SVC_CD       = TSRIT.SVC_CD
		AND     TSRIT.INACT_DT  >= #{productDevMgt.currentDay}
		AND     TDRI.PROD_CD      = #{productDevMgt.prodCd}
		AND     TDRI.SVC_CD       = #{productDevMgt.svcCd}
	    AND     TDRI.MSTR_FL = '1'
	    AND     TSRIT.MSTR_FL = '1'		
		ORDER BY TDRI.DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getRateItmListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
        SELECT COUNT(*)
		FROM    TPMPD_D_RATE_ITM   TDRI,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE   TDRI.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TDRI.SVC_CD       = TSRIT.SVC_CD
		AND     TSRIT.INACT_DT  >= #{productDevMgt.currentDay}
		AND     TDRI.PROD_CD      = #{productDevMgt.prodCd}
		AND     TDRI.SVC_CD       = #{productDevMgt.svcCd}
</select>

<select id="getRateItmListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
        SELECT COUNT(*)
		FROM    TPMPD_RATE_ITM   TDRI,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE   TDRI.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TDRI.SVC_CD       = TSRIT.SVC_CD
		AND     TSRIT.INACT_DT  >= #{productDevMgt.currentDay}
		AND     TDRI.PROD_CD      = #{productDevMgt.prodCd}
		AND     TDRI.SVC_CD       = #{productDevMgt.svcCd}
	    AND     TDRI.MSTR_FL = '1'
	    AND     TSRIT.MSTR_FL = '1'		
</select>

<select id="getRetrieveSvcRateItmTypList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT #{productDevMgt.rateItmCd} RATE_ITM_CD,
		       ( CONCAT(CONCAT((SELECT PROD_NM
		          FROM   TPMPD_D_PROD
		          WHERE  PROD_CD = #{productDevMgt.prodCd}),' '), V_1.SVC_RATE_ITM_TYP_NM)
		       ) RATE_ITM_NM,
		       V_1.CHRG_CTGRY,
		       V_1.SVC_RATE_ITM_TYP_CD,
		       V_1.RATE_LOCAT,
		       V_1.RATE_PRI_NO,
		       V_1.DISP_PRI_NO,
		       #{productDevMgt.prodCd}       AS PROD_CD,
		       #{productDevMgt.svcCd}        AS SVC_CD,
		       #{productDevMgt.regrId}       AS REGR_ID,
		       #{productDevMgt.chgrId}       AS CHGR_ID
		FROM
		      (
		          SELECT TSRIT.SVC_RATE_ITM_TYP_CD,
		                 TSRIT.SVC_RATE_ITM_TYP_NM,
		                 TSRIT.CHRG_CTGRY,
		                 (
		                    SELECT B.COMMON_CD_NM
							FROM   TSYCO_CODE_DETAIL B
			                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			                ON #{productDevMgt.lngTyp} = C.LNG_TYP
			                AND 	B.COMMON_GRP = C.COMMON_GRP
			                AND 	B.COMMON_CD = C.COMMON_CD       
		                    WHERE  B.COMMON_GRP  = 'PP00031'
		                    AND    B.COMMON_CD   = TSRIT.CHRG_CTGRY
		                 ) CHRG_CTGRY_NM,
		                 TSRIT.RATE_LOCAT,
		                 TSRIT.RATE_PRI_NO,
		                 TSRIT.DISP_PRI_NO
		          FROM   TPMPD_SVC_RATE_ITM_TYP TSRIT
		          WHERE  SVC_CD = #{productDevMgt.svcCd}
		          AND  SVC_RATE_ITM_TYP_CD NOT IN (
		                                              SELECT SVC_RATE_ITM_TYP_CD
		                                              FROM   TPMPD_D_RATE_ITM
		                                              WHERE  PROD_CD = #{productDevMgt.prodCd}
		                                              AND    SVC_CD  = #{productDevMgt.svcCd}
		                                          )
		      ) V_1
</select>

<insert id="addRetrieveRateItem" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM
		(
		    RATE_ITM_CD,
		    INACT_DT,
		    ACT_DT,
		    RATE_ITM_NM,
		    PROD_CD,
		    SVC_CD,
		    SVC_RATE_ITM_TYP_CD,
		    CHRG_CTGRY,
		    RATE_LOCAT,
		    RATE_REF_TYP,
		    DEFLT_RATE_ITM_CD,
		    RATE_PRI_NO,
		    DISP_PRI_NO,
		    MSTR_FL,
		    REGR_ID,
		    REG_DATE,
		    CHGR_ID,
		    CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.rateItmCd, jdbcType=VARCHAR },
		    #{productDevMgt.inactDt, jdbcType=VARCHAR },
		    #{productDevMgt.currentDay, jdbcType=VARCHAR } ,
		    #{productDevMgt.rateItmNm, jdbcType=VARCHAR },
		    #{productDevMgt.prodCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcRateItmTypCd, jdbcType=VARCHAR },
		    #{productDevMgt.chrgCtgry, jdbcType=VARCHAR },
		    #{productDevMgt.rateLocat, jdbcType=VARCHAR },
		    #{productDevMgt.rateRefTyp, jdbcType=VARCHAR },
		    #{productDevMgt.defltRateItmNm, jdbcType=VARCHAR },
		    #{productDevMgt.ratePriNo, jdbcType=VARCHAR },
		    #{productDevMgt.dispPriNo, jdbcType=VARCHAR },
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		    #{productDevMgt.regrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate}
		)
</insert>

<insert id="addRetrieveRateItemAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_ATTR
		(
		    SELECT #{productDevMgt.rateItmCd},
		           ATTR_CD,
		           INACT_DT,
		           ACT_DT,
		           ATTR_VAL,
		           MSTR_FL,
		           #{productDevMgt.regrId},
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId},
		           #{productDevMgt.sysdate}
		    FROM   TPMPD_SVC_RATE_ITM_TYP_ATTR
		    WHERE  ATTR_CD IN (
		                        SELECT ATTR_CD
		                        FROM   TPMPD_SVC_RATE_ITM_TYP_ATTR
		                        WHERE  SVC_RATE_ITM_TYP_CD IN (
		                                                       SELECT SVC_RATE_ITM_TYP_CD
		                                                       FROM   TPMPD_D_RATE_ITM
		                                                       WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                                       AND    MSTR_FL = '1'
		                                                       AND    INACT_DT >= #{productDevMgt.currentDay}
		                                                      )
		                        MINUS
		                        SELECT ATTR_CD
		                        FROM   TPMPD_D_RATE_ITM_ATTR
		                        WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		                        AND    MSTR_FL     = '1'
		                        AND    INACT_DT >= #{productDevMgt.currentDay}
		                      )
		    AND    SVC_RATE_ITM_TYP_CD IN (
		                                    SELECT SVC_RATE_ITM_TYP_CD
		                                    FROM   TPMPD_D_RATE_ITM
		                                    WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                    AND    MSTR_FL     = '1'
		                                    AND    INACT_DT >= #{productDevMgt.currentDay}
		                                   )
		    AND   MSTR_FL = '1'
		    AND   INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<insert id="addRetrieveRateItemFactor" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_FCTR
		(
		    SELECT #{productDevMgt.rateItmCd},
		           FCTR_CD,
		           INACT_DT,
		           ACT_DT,
		           (SELECT (CASE WHEN MAX(TSRIF.FCTR_NO) IS NULL THEN 0 ELSE MAX(TSRIF.FCTR_NO) END )
				    FROM   TPMPD_D_RATE_ITM_FCTR TSRIF
					WHERE  TSRIF.RATE_ITM_CD = #{productDevMgt.rateItmCd}) + ROWNUM AS X1,
		           '0',
		           FCTR_REF_TYP,
		           TABLE_ID,
		           COLMN_ID,
		           DATA_TYP       ,
		           REF_TABLE_ID   ,
		           REF_COLMN_ID   ,
		           REF_COLMN_NM   ,
		           REF_TABLE_COND ,
		           REF_CD,
		           MSTR_FL,
		           #{productDevMgt.regrId},
       			<choose>                          
  						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         SYSDATE         ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
                         NOW()         ,
                       </when>
       			</choose>  
		           #{productDevMgt.chgrId},
		           #{productDevMgt.sysdate},
		           REF_FUNC			,
		           CHG_NULL_FL		,
		           CHG_NULL_VAL
		    FROM   TPMPD_SVC_RATE_ITM_TYP_FCTR
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">  		    
		    WHERE  FCTR_CD IN (
		                        SELECT FCTR_CD
		                        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
		                        WHERE SVC_RATE_ITM_TYP_CD IN (
		                                                       SELECT SVC_RATE_ITM_TYP_CD
		                                                       FROM   TPMPD_D_RATE_ITM
		                                                       WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                                       AND    MSTR_FL     = '1'
		                                                       AND    INACT_DT >= #{productDevMgt.currentDay}
		                                                     )
		                        MINUS
		                        SELECT FCTR_CD
		                        FROM   TPMPD_D_RATE_ITM_FCTR
		                        WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                        AND    MSTR_FL     = '1'
		                        AND    INACT_DT >= #{productDevMgt.currentDay}
		                      )
                        </when>
 						<when test="'${dbms.kind}' == 'MYSQL'">   
		    WHERE  FCTR_CD IN (
		                        SELECT A.FCTR_CD FROM (SELECT FCTR_CD
		                        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
		                        WHERE SVC_RATE_ITM_TYP_CD IN (
		                                                       SELECT SVC_RATE_ITM_TYP_CD
		                                                       FROM   TPMPD_D_RATE_ITM
		                                                       WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                                       AND    MSTR_FL     = '1'
		                                                       AND    INACT_DT >= #{productDevMgt.currentDay}
		                                                     )) A

		                        LEFT JOIN (SELECT FCTR_CD
		                        FROM   TPMPD_D_RATE_ITM_FCTR
		                        WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                        AND    MSTR_FL     = '1'
		                        AND    INACT_DT >= #{productDevMgt.currentDay}) B
						          ON A.FCTR_CD = B.FCTR_CD
						          WHERE B.FCTR_CD IS NULL			                        
		                      )
	                        </when>
        			</choose>  
		    AND    SVC_RATE_ITM_TYP_CD IN (
		                                    SELECT SVC_RATE_ITM_TYP_CD
		                                    FROM   TPMPD_D_RATE_ITM
		                                    WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                    AND    MSTR_FL     = '1'
		                                    AND    INACT_DT >= #{productDevMgt.currentDay}
		                                   )
		    AND   MSTR_FL = '1'
		    AND   INACT_DT >= #{productDevMgt.currentDay}
		)
</insert>

<select id="getAddRateItmInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	    SELECT '[]'   AS SVC_RATE_ITM_TYP_CD,
	           'SEL' AS SVC_RATE_ITM_TYP_NM,
	           NULL   AS RATE_ITM_NM,
	           NULL   AS CHRG_CTGRY,
	           NULL   AS CHRG_CTGRY_NM,
	           NULL   AS RATE_LOCAT,
	           NULL   AS RATE_PRI_NO,
	           NULL   AS DISP_PRI_NO
	    FROM DUAL
	    UNION ALL
		SELECT TSRIT.SVC_RATE_ITM_TYP_CD,
		       TSRIT.SVC_RATE_ITM_TYP_NM,
		       ( CONCAT(CONCAT((SELECT PROD_NM
		          FROM   TPMPD_D_PROD
		          WHERE  PROD_CD = #{productDevMgt.prodCd}), ' '), TSRIT.SVC_RATE_ITM_TYP_NM)
		       ) RATE_ITM_NM,
		       TSRIT.CHRG_CTGRY,
		       (
		          SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND 	B.COMMON_GRP = C.COMMON_GRP
                  AND 	B.COMMON_CD = C.COMMON_CD  
		          WHERE  B.COMMON_GRP  = 'PP00031'
		          AND    B.COMMON_CD   = TSRIT.CHRG_CTGRY
		       ) CHRG_CTGRY_NM,
		       TSRIT.RATE_LOCAT,
		       TSRIT.RATE_PRI_NO,
		       TSRIT.DISP_PRI_NO
		FROM   TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE  TSRIT.SVC_CD = #{productDevMgt.svcCd}
		AND SUBSTR(SVC_RATE_ITM_TYP_CD,1,2) = 'SR'
</select>

<select id="getDefltRateItemList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	    SELECT '[]'   AS RATE_ITM_CD,
	           'SEL' AS RATE_ITM_NM
	    FROM DUAL
	    UNION ALL
		SELECT RATE_ITM_CD,
		       RATE_ITM_NM
		FROM   TPMPD_RATE_ITM
		WHERE  PROD_CD             = #{productDevMgt.prodCd}
		AND    SVC_CD              = #{productDevMgt.svcCd}
		AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
		AND    MSTR_FL             = '1'
		AND    INACT_DT         >= #{productDevMgt.currentDay}
</select>

<insert id="addRateItm" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM
		(
		    RATE_ITM_CD,
		    INACT_DT,
		    ACT_DT,
		    RATE_ITM_NM,
		    PROD_CD,
		    SVC_CD,
		    SVC_RATE_ITM_TYP_CD,
		    CHRG_CTGRY,
		    RATE_LOCAT,
		    RATE_REF_TYP,
		    DEFLT_RATE_ITM_CD,
		    RATE_PRI_NO,
		    DISP_PRI_NO,
		    MSTR_FL,
		    REGR_ID,
		    REG_DATE,
		    CHGR_ID,
		    CHG_DATE,
            MNO_RATE_ITM_CD
		)
		VALUES
		(
		    #{productDevMgt.rateItmCd, jdbcType=VARCHAR },
		    #{productDevMgt.inactDt, jdbcType=VARCHAR },
		    #{productDevMgt.currentDay, jdbcType=VARCHAR } ,
		    #{productDevMgt.rateItmNm, jdbcType=VARCHAR },
		    #{productDevMgt.prodCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcRateItmTypCd, jdbcType=VARCHAR },
		    #{productDevMgt.chrgCtgry, jdbcType=VARCHAR },
		    #{productDevMgt.rateLocat, jdbcType=VARCHAR },
		    #{productDevMgt.rateRefTyp, jdbcType=VARCHAR },
		    #{productDevMgt.defltRateItmCd, jdbcType=VARCHAR },
		    #{productDevMgt.ratePriNo, jdbcType=VARCHAR },
		    #{productDevMgt.dispPriNo, jdbcType=VARCHAR },
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		    #{productDevMgt.regrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
            #{productDevMgt.mnoRateItmCd, jdbcType=VARCHAR }
		)

</insert>

<select id="getRateItm" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TDRI.RATE_ITM_CD           ,
		        TDRI.INACT_DT            ,
		        TDRI.ACT_DT             ,
		        TDRI.RATE_ITM_NM           ,
		        TDRI.RATE_ITM_ABBR_NM      ,
		        TDRI.RATE_ITM_ENG_NM       ,
		        TDRI.RATE_ITM_ENG_ABBR_NM  ,
		        TDRI.PROD_CD               ,
		        TDRI.SVC_CD                ,
		        TDRI.SVC_RATE_ITM_TYP_CD   ,
		        TSRIT.SVC_RATE_ITM_TYP_NM  ,
		        TDRI.CHRG_CTGRY            ,
		        (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                   ON #{productDevMgt.lngTyp} = C.LNG_TYP
                   AND 	B.COMMON_GRP = C.COMMON_GRP
                   AND 	B.COMMON_CD = C.COMMON_CD 
		           WHERE  B.COMMON_GRP  = 'PP00031'
		           AND    B.COMMON_CD   = TDRI.CHRG_CTGRY
		        ) CHRG_CTGRY_NM,
		        TDRI.RATE_LOCAT            ,
		        TDRI.RATE_REF_TYP          ,
		        TDRI.DEFLT_RATE_ITM_CD     ,
		        TDRI.RATE_PRI_NO           ,
		        TDRI.DISP_PRI_NO           ,
		        TDRI.MSTR_FL               ,
		        TDRI.REGR_ID          ,
		        TDRI.REG_DATE        ,
		        TDRI.CHGR_ID            ,
		        TDRI.CHG_DATE,
                TDRI.MNO_RATE_ITM_CD
		FROM    TPMPD_D_RATE_ITM   TDRI,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT
		WHERE   TDRI.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TDRI.SVC_CD              = TSRIT.SVC_CD
		AND     TSRIT.INACT_DT        >= #{productDevMgt.currentDay}
		AND     TDRI.RATE_ITM_CD         = #{productDevMgt.rateItmCd}

</select>

<select id="getDualRateItmNm" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  RATE_ITM_NM
		FROM    TPMPD_RATE_ITM
		WHERE   RATE_ITM_NM = #{productDevMgt.rateItmNm}
		<if test="productDevMgt.rateItmCd != null">
		AND 	RATE_ITM_CD != #{productDevMgt.rateItmCd}
	    </if>  		
		UNION
		SELECT  RATE_ITM_NM
		FROM    TPMPD_D_RATE_ITM
		WHERE   RATE_ITM_NM = #{productDevMgt.rateItmNm}
		<if test="productDevMgt.rateItmCd != null">
		AND 	RATE_ITM_CD != #{productDevMgt.rateItmCd}
	    </if>

</select>

<update id="modRateItm" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_D_RATE_ITM
		SET     RATE_ITM_CD          = #{productDevMgt.rateItmCd, jdbcType=VARCHAR },
		        RATE_ITM_NM          = #{productDevMgt.rateItmNm, jdbcType=VARCHAR },
		        RATE_ITM_ABBR_NM     = #{productDevMgt.rateItmAbbrNm, jdbcType=VARCHAR },
		        RATE_ITM_ENG_NM      = #{productDevMgt.rateItmEngNm, jdbcType=VARCHAR },
		        RATE_ITM_ENG_ABBR_NM = #{productDevMgt.rateItmEngAbbrNm, jdbcType=VARCHAR },
		        RATE_LOCAT           = #{productDevMgt.rateLocat, jdbcType=VARCHAR },
		        RATE_REF_TYP         = #{productDevMgt.rateRefTyp, jdbcType=VARCHAR },
		        DEFLT_RATE_ITM_CD    = #{productDevMgt.defltRateItmCd, jdbcType=VARCHAR },
		        RATE_PRI_NO          = #{productDevMgt.ratePriNo, jdbcType=VARCHAR },
		        DISP_PRI_NO          = #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		        CHGR_ID              = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		        CHG_DATE             = #{productDevMgt.sysdate},
                MNO_RATE_ITM_CD      = #{productDevMgt.mnoRateItmCd, jdbcType=VARCHAR }
		WHERE   RATE_ITM_CD          = #{productDevMgt.rateItmCd}
</update>

<select id="getRateItmRateItmCd" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TRI.RATE_ITM_CD
		FROM   TPMPD_RATE_ITM TRI
		WHERE  TRI.DEFLT_RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    TRI.MSTR_FL = '1'
		UNION
		SELECT TDRI.RATE_ITM_CD
		FROM   TPMPD_D_RATE_ITM TDRI
		WHERE  TDRI.DEFLT_RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    TDRI.MSTR_FL = '1'
</select>

<select id="getRateItmFctrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TF.FCTR_CD,
		        TF.FCTR_NM,
		        TDRIF.RATE_INFO_EXE_FL,
		        (SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                   ON #{productDevMgt.lngTyp} = C.LNG_TYP
                   AND 	B.COMMON_GRP = C.COMMON_GRP
                   AND 	B.COMMON_CD = C.COMMON_CD                   
		          WHERE  B.COMMON_GRP = 'PP00014'
		          AND    B.COMMON_CD  = TDRIF.RATE_INFO_EXE_FL  ) RATE_INFO_EXE_FL_NM,
		        TDRIF.FCTR_NO,
		        TDRI.SVC_RATE_ITM_TYP_CD
		FROM    TPMPD_D_RATE_ITM      TDRI,
		        TPMPD_D_RATE_ITM_FCTR TDRIF,
		        TPMBI_FCTR            TF
		WHERE   TDRI.RATE_ITM_CD = TDRIF.RATE_ITM_CD
		AND     TDRIF.FCTR_CD     = TF.FCTR_CD
		AND     TDRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND     TF.MSTR_FL        = '1'
		AND     TDRI.MSTR_FL = '1'
		AND     TF.INACT_DT    >= #{productDevMgt.currentDay}
		ORDER BY TDRIF.FCTR_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getRateItmFctrList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TF.FCTR_CD,
		        TF.FCTR_NM,
		        TDRIF.RATE_INFO_EXE_FL,
		        (SELECT C.CODE_NM AS COMMON_CD_NM
		          FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                   ON #{productDevMgt.lngTyp} = C.LNG_TYP
                   AND 	B.COMMON_GRP = C.COMMON_GRP
                   AND 	B.COMMON_CD = C.COMMON_CD                   
		          WHERE  B.COMMON_GRP = 'PP00014'
		          AND    B.COMMON_CD  = TDRIF.RATE_INFO_EXE_FL  ) RATE_INFO_EXE_FL_NM,
		        TDRIF.FCTR_NO,
		        TDRI.SVC_RATE_ITM_TYP_CD,
	            TDRIF.ACT_DT,
	            TDRIF.INACT_DT
		FROM    TPMPD_RATE_ITM      TDRI,
		        TPMPD_RATE_ITM_FCTR TDRIF,
		        TPMBI_FCTR            TF
		WHERE   TDRI.RATE_ITM_CD = TDRIF.RATE_ITM_CD
		AND     TDRIF.FCTR_CD     = TF.FCTR_CD
		AND     TDRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND     TF.MSTR_FL        = '1'
		AND     TDRI.MSTR_FL = '1'
		AND     TDRIF.MSTR_FL = '1'  		
		AND     TF.INACT_DT    >= #{productDevMgt.currentDay}
		ORDER BY TDRIF.FCTR_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getRateItmFctrListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_D_RATE_ITM      TDRI,
		        TPMPD_D_RATE_ITM_FCTR TDRIF,
		        TPMBI_FCTR            TF
		WHERE   TDRI.RATE_ITM_CD = TDRIF.RATE_ITM_CD
		AND     TDRIF.FCTR_CD     = TF.FCTR_CD
		AND     TDRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND     TF.MSTR_FL        = '1'
		AND     TDRI.MSTR_FL = '1'
		AND     TF.INACT_DT    >= #{productDevMgt.currentDay}
		ORDER BY TDRIF.FCTR_NO
</select>
<select id="getRateItmFctrListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_RATE_ITM      TDRI,
		        TPMPD_RATE_ITM_FCTR TDRIF,
		        TPMBI_FCTR            TF
		WHERE   TDRI.RATE_ITM_CD = TDRIF.RATE_ITM_CD
		AND     TDRIF.FCTR_CD     = TF.FCTR_CD
		AND     TDRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND     TF.MSTR_FL        = '1'
		AND     TDRI.MSTR_FL = '1'
		AND     TDRIF.MSTR_FL = '1'  
		AND     TF.INACT_DT    >= #{productDevMgt.currentDay}
		ORDER BY TDRIF.FCTR_NO
</select>
<select id="getRateItmRegCnt" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  CASE WHEN A.FCTR_CNT                  = 0 THEN -1 ELSE A.FCTR_CNT                   END AS FCTR_CNT                  ,
		        CASE WHEN A.ATTR_CNT                  = 0 THEN -1 ELSE A.ATTR_CNT                   END AS ATTR_CNT                  ,
		        CASE WHEN A.COND_CNT                  = 0 THEN -1 ELSE A.COND_CNT                   END AS COND_CNT                  ,
		        CASE WHEN A.RATE_CNT                  = 0 THEN -1 ELSE A.RATE_CNT                   END AS RATE_CNT                  ,
		        CASE WHEN A.DISC_EXCL_CNT             = 0 THEN -1 ELSE A.DISC_EXCL_CNT              END AS DISC_EXCL_CNT             ,
		        CASE WHEN A.DISC_SVC_RATE_ITM_TYP_CNT = 0 THEN -1 ELSE A.DISC_SVC_RATE_ITM_TYP_CNT  END AS DISC_SVC_RATE_ITM_TYP_CNT ,
		        CASE WHEN A.DISC_PERD_CNT             = 0 THEN -1 ELSE A.DISC_PERD_CNT              END AS DISC_PERD_CNT
		FROM
		      (
		       SELECT  SUM(AA.FCTR_CNT                  ) AS  FCTR_CNT                   ,
		               SUM(AA.ATTR_CNT                  ) AS  ATTR_CNT                   ,
		               SUM(AA.COND_CNT                  ) AS  COND_CNT                   ,
		               SUM(AA.RATE_CNT                  ) AS  RATE_CNT                   ,
		               SUM(AA.DISC_EXCL_CNT             ) AS  DISC_EXCL_CNT              ,
		               SUM(AA.DISC_SVC_RATE_ITM_TYP_CNT ) AS  DISC_SVC_RATE_ITM_TYP_CNT  ,
		               SUM(AA.DISC_PERD_CNT             ) AS  DISC_PERD_CNT
		       FROM (
		               SELECT  COUNT(*) AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       0        AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_RATE_ITM_FCTR
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       COUNT(*) AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       0        AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_RATE_ITM_ATTR
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       COUNT(*) AS COND_CNT,
		                       0        AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_RATE_ITM_COND
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       COUNT(*) AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_RATE
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       0        AS RATE_CNT,
		                       COUNT(*) AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_DISC_EXCL
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       0        AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       COUNT(*) AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       0        AS DISC_PERD_CNT
		               FROM    TPMPD_D_DISC_SVC_RT_ITM_TYP
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		               UNION ALL
		               SELECT  0        AS FCTR_CNT,
		                       0        AS ATTR_CNT,
		                       0        AS COND_CNT,
		                       0        AS RATE_CNT,
		                       0        AS DISC_EXCL_CNT,
		                       0        AS DISC_SVC_RATE_ITM_TYP_CNT,
		                       COUNT(*) AS DISC_PERD_CNT
		               FROM    TPMPD_D_DISC_PERD
		               WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		       ) AA
		)A
</select>

<select id="getRetrieveRateItemFactor" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		 SELECT '0' AS CHK,#{productDevMgt.rateItmCd},
		           FCTR_CD,
		           (SELECT FCTR_NM FROM TPMBI_FCTR A WHERE A.FCTR_CD = B.FCTR_CD AND A.MSTR_FL = '1') AS FCTR_NM,
		           INACT_DT,
		           ACT_DT,
        	<choose>                          
   				<when test="'${dbms.kind}' == 'ORACLE'">  		           
		           (SELECT(CASE WHEN MAX(TSRIF.FCTR_NO) IS NULL THEN 0 ELSE MAX(TSRIF.FCTR_NO) END ) 
				    FROM   TPMPD_D_RATE_ITM_FCTR TSRIF
					WHERE  TSRIF.RATE_ITM_CD = #{productDevMgt.rateItmCd}) + ROWNUM AS X1,
      			</when>
   				<when test="'${dbms.kind}' == 'MYSQL'"> 
   				 	(SELECT(CASE WHEN MAX(TSRIF.FCTR_NO) IS NULL THEN 0 ELSE MAX(TSRIF.FCTR_NO) END ) 
				    FROM   TPMPD_D_RATE_ITM_FCTR TSRIF
					WHERE  TSRIF.RATE_ITM_CD = #{productDevMgt.rateItmCd})  AS X1,
   				</when>
        	</choose> 
		           '0',
		           FCTR_REF_TYP,
		           TABLE_ID,
		           COLMN_ID,
		           DATA_TYP       ,
		           REF_TABLE_ID   ,
		           REF_COLMN_ID   ,
		           REF_COLMN_NM   ,
		           REF_TABLE_COND ,
		           REF_CD,
		           MSTR_FL,
		           #{productDevMgt.regrId}        ,
		           #{productDevMgt.sysdate}               ,
		           #{productDevMgt.chgrId}          ,
		           #{productDevMgt.sysdate}				,
		           REF_FUNC		,
		           CHG_NULL_FL		,
		           CHG_NULL_VAL
		    FROM   TPMPD_SVC_RATE_ITM_TYP_FCTR B
        	<choose>                          
   				<when test="'${dbms.kind}' == 'ORACLE'">  		    
		    WHERE  FCTR_CD IN (
		                        SELECT FCTR_CD
		                        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
		                        WHERE SVC_RATE_ITM_TYP_CD IN (
		                                                       SELECT SVC_RATE_ITM_TYP_CD
		                                                       FROM   TPMPD_D_RATE_ITM
		                                                       WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                                       AND    MSTR_FL     = '1'
		                                                       AND    INACT_DT >= #{productDevMgt.currentDay}
		                                                     )
		                        MINUS
		                        SELECT FCTR_CD
		                        FROM   TPMPD_D_RATE_ITM_FCTR
		                        WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                        AND    MSTR_FL     = '1'
		                        AND    INACT_DT >= #{productDevMgt.currentDay}
		                      )
		                      
      			</when>
   				<when test="'${dbms.kind}' == 'MYSQL'">   
		    WHERE  FCTR_CD IN (
		                        SELECT A.FCTR_CD FROM (SELECT FCTR_CD
		                        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
		                        WHERE SVC_RATE_ITM_TYP_CD IN (
		                                                       SELECT SVC_RATE_ITM_TYP_CD
		                                                       FROM   TPMPD_D_RATE_ITM
		                                                       WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                                       AND    MSTR_FL     = '1'
		                                                       AND    INACT_DT >= #{productDevMgt.currentDay}
		                                                     )) A

		                        LEFT JOIN (SELECT FCTR_CD
		                        FROM   TPMPD_D_RATE_ITM_FCTR
		                        WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                        AND    MSTR_FL     = '1'
		                        AND    INACT_DT >= #{productDevMgt.currentDay}) B
						          ON A.FCTR_CD = B.FCTR_CD
						          WHERE B.FCTR_CD IS NULL			                        
		                      )
	        	</when>
        	</choose> 
		    AND    SVC_RATE_ITM_TYP_CD IN (
		                                    SELECT SVC_RATE_ITM_TYP_CD
		                                    FROM   TPMPD_D_RATE_ITM
		                                    WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                    AND    MSTR_FL     = '1'
		                                    AND    INACT_DT >= #{productDevMgt.currentDay}
		                                   )
		    AND   MSTR_FL = '1'
		    AND   INACT_DT >= #{productDevMgt.currentDay}


</select>

<select id="getRetrieveRateItemFactorNumber" resultType="int" parameterType="String">
	SELECT  MIN(NO)  AS FCTR_NO
	  FROM  TSYCO_COPY
	 WHERE  NO &lt; 10
	   AND  NO NOT IN (SELECT  FCTR_NO
	                     FROM  TPMPD_D_RATE_ITM_FCTR
	                    WHERE  RATE_ITM_CD  = #{rateItmCd}
	                  )
</select>

<insert id="addRetrieveRateItemFactor_2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	INSERT
	INTO TPMPD_D_RATE_ITM_FCTR (
    SELECT #{productDevMgt.rateItmCd}, FCTR_CD, INACT_DT, ACT_DT ,
    (CASE WHEN FCTR_CD = 'FT00000002' THEN '9' ELSE #{productDevMgt.fctrNo} END ), '1', 
<choose>                          
	<when test="'${dbms.kind}' == 'ORACLE'">    
    FCTR_REF_TYP, TABLE_ID, COLMN_ID, DATA_TYP , REF_TABLE_ID , REF_COLMN_ID , REF_COLMN_NM , REF_TABLE_COND , REF_CD, MSTR_FL, #{productDevMgt.regrId} , SYSDATE , #{productDevMgt.chgrId} , SYSDATE , REF_FUNC,CHG_NULL_FL,CHG_NULL_VAL		  
	</when>
	<when test="'${dbms.kind}' == 'MYSQL'">   
    FCTR_REF_TYP, TABLE_ID, COLMN_ID, DATA_TYP , REF_TABLE_ID , REF_COLMN_ID , REF_COLMN_NM , REF_TABLE_COND , REF_CD, MSTR_FL, #{productDevMgt.regrId} , #{productDevMgt.sysdate} , #{productDevMgt.chgrId} , #{productDevMgt.sysdate} , REF_FUNC,CHG_NULL_FL,CHG_NULL_VAL		 		
	</when>		
</choose>  
    FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
<choose>      
	<when test="'${dbms.kind}' == 'ORACLE'">  	
    WHERE FCTR_CD IN (
        SELECT FCTR_CD
        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
        WHERE SVC_RATE_ITM_TYP_CD IN (
            SELECT SVC_RATE_ITM_TYP_CD
            FROM TPMPD_D_RATE_ITM
            WHERE RATE_ITM_CD = #{productDevMgt.rateItmCd}
              AND MSTR_FL = '1'
              AND INACT_DT >= #{productDevMgt.currentDay}
              AND FCTR_CD = #{productDevMgt.fctrCd} )
        MINUS
        SELECT FCTR_CD
        FROM TPMPD_D_RATE_ITM_FCTR
        WHERE RATE_ITM_CD = #{productDevMgt.rateItmCd}
          AND MSTR_FL = '1'
          AND INACT_DT >= #{productDevMgt.currentDay}
          )
	</when>
	<when test="'${dbms.kind}' == 'MYSQL'">         
     WHERE FCTR_CD IN (
        SELECT A.FCTR_CD FROM (SELECT FCTR_CD
        FROM TPMPD_SVC_RATE_ITM_TYP_FCTR
        WHERE SVC_RATE_ITM_TYP_CD IN (
            SELECT SVC_RATE_ITM_TYP_CD
            FROM TPMPD_D_RATE_ITM
            WHERE RATE_ITM_CD = #{productDevMgt.rateItmCd}
              AND MSTR_FL = '1'
              AND INACT_DT >= #{productDevMgt.currentDay}
              AND FCTR_CD = #{productDevMgt.fctrCd} ))A
        LEFT JOIN (
        SELECT FCTR_CD
        FROM TPMPD_D_RATE_ITM_FCTR
        WHERE RATE_ITM_CD = #{productDevMgt.rateItmCd}
          AND MSTR_FL = '1'
          AND INACT_DT >= #{productDevMgt.currentDay}) B
          ON A.FCTR_CD = B.FCTR_CD
		  WHERE B.FCTR_CD IS NULL
          )         
	</when>
</choose>         
      AND SVC_RATE_ITM_TYP_CD IN (
        SELECT SVC_RATE_ITM_TYP_CD
        FROM TPMPD_D_RATE_ITM
        WHERE RATE_ITM_CD = #{productDevMgt.rateItmCd}
          AND MSTR_FL = '1'
          AND INACT_DT >= #{productDevMgt.currentDay}
          )
      AND MSTR_FL = '1'
      AND INACT_DT >= #{productDevMgt.currentDay} )
</insert>

<select id="getModRateItmFctrInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TDRIF.RATE_ITM_CD,
			   TDRIF.FCTR_CD,
		       TF.FCTR_NM,
		       TDRIF.RATE_INFO_EXE_FL,
		       TDRIF.FCTR_NO,
		       CASE WHEN TDRIF.FCTR_NO = 0 THEN
											       (
											           SELECT (CASE WHEN MAX(FCTR_NO)+1 IS NULL THEN 1 ELSE
											           			MAX(FCTR_NO)+1 END) NEXT_FCTR_NO
											           FROM    TPMPD_D_RATE_ITM_FCTR
											           WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
											       )
	                ELSE TDRIF.FCTR_NO
	           END FCTR_NO,
	           TDRIF.FCTR_NO AS OLD_FCTR_NO,
	           TDRIF.CHGR_ID
		FROM   TPMPD_D_RATE_ITM_FCTR TDRIF,
		       TPMBI_FCTR            TF
		WHERE  TDRIF.FCTR_CD     = TF.FCTR_CD
		AND    TF.MSTR_FL        = '1'
		AND    TDRIF.RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    TDRIF.FCTR_CD     = #{productDevMgt.fctrCd}

</select>

<select id="getDualRateItmFctrNo" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  RATE_ITM_CD
		FROM    TPMPD_D_RATE_ITM_FCTR
		WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND     FCTR_NO    != 0
		AND     FCTR_NO     = #{productDevMgt.fctrNo}
		AND     FCTR_CD    != #{productDevMgt.fctrCd}
</select>

<update id="modRateItmFctr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_RATE_ITM_FCTR
		SET    FCTR_NO          = (CASE WHEN ${productDevMgt.fctrNo} IS NULL THEN 0 ELSE ${productDevMgt.fctrNo} END ),
		       RATE_INFO_EXE_FL = #{productDevMgt.rateInfoExeFl, jdbcType=VARCHAR },
		       CHGR_ID       = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		       CHG_DATE     = #{productDevMgt.sysdate}
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    FCTR_CD     = #{productDevMgt.fctrCd}
</update>

<select id="getRateItmCondFctrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT FCTR_CD
		FROM   TPMPD_D_RATE_ITM_COND
		WHERE  (    FCTR_CD = #{productDevMgt.fctrCd}
		        OR  OPRND_FCTR_CD_1 = #{productDevMgt.fctrCd}
		        OR  OPRND_FCTR_CD_2 = #{productDevMgt.fctrCd} )
		AND    RATE_ITM_CD = #{productDevMgt.rateItmCd}
</select>

<select id="getDiscPeriodFctrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT RATE_ITM_CD
		FROM   TPMPD_D_DISC_PERD
		WHERE  (   OPRND_FCTR_CD_1 = #{productDevMgt.fctrCd}
		        OR OPRND_FCTR_CD_2 = #{productDevMgt.fctrCd} )
		AND    RATE_ITM_CD = #{productDevMgt.rateItmCd}
</select>

<select id="getRateItmAttrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
SELECT VWTS.RATE_ITM_CD,
		       VWAT.ATTR_CD,
		       VWAT.ATTR_NM,
		       VWAT.REF_CD,
		       VWAT.ATTR_STRT_VAL,
		       VWAT.ATTR_END_VAL,
		       VWTS.ATTR_VAL,
		       VWTS.ATTR_VAL AS ATTR_VAL_REF_CD,
			   (
			  CASE
			    WHEN (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD) IS NULL
			    THEN VWTS.ATTR_VAL
			    ELSE
			      (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD
			      )
			  END) AS ATTR_VAL_NM,
		       VWTS.INACT_DT,
		       VWTS.ACT_DT,
		       '1' AS MSTR_FL,
		       VWTS.ATTR_VAL AS BASE_ATTR_VAL,
		       VWTS.REGR_ID,
		       VWTS.CHGR_ID
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_D_RATE_ITM_ATTR TDRIA
		         WHERE  TDRIA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDRIA.MSTR_FL              = '1'
		         AND    TDRIA.RATE_ITM_CD          = #{productDevMgt.rateItmCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>
</select>

<select id="getRateItmAttrListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
SELECT COUNT(*)
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_D_RATE_ITM_ATTR TDRIA
		         WHERE  TDRIA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDRIA.MSTR_FL              = '1'
		         AND    TDRIA.RATE_ITM_CD          = #{productDevMgt.rateItmCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getRateItmAttrListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
SELECT COUNT(*)
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_RATE_ITM_ATTR TDRIA
		         WHERE  TDRIA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDRIA.MSTR_FL              = '1'
		         AND    TDRIA.RATE_ITM_CD          = #{productDevMgt.rateItmCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getRateItmAttrList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
SELECT VWTS.RATE_ITM_CD,
		       VWAT.ATTR_CD,
		       VWAT.ATTR_NM,
		       VWAT.REF_CD,
		       VWAT.ATTR_STRT_VAL,
		       VWAT.ATTR_END_VAL,
		       VWTS.ATTR_VAL,
		       VWTS.ATTR_VAL AS ATTR_VAL_REF_CD,
			   (
			  CASE
			    WHEN (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD) IS NULL
			    THEN VWTS.ATTR_VAL
			    ELSE
			      (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD
			      )
			  END) AS ATTR_VAL_NM,
		       VWTS.INACT_DT,
		       VWTS.ACT_DT,
		       '1' AS MSTR_FL,
		       VWTS.ATTR_VAL AS BASE_ATTR_VAL,
		       VWTS.REGR_ID,
		       VWTS.CHGR_ID
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_RATE_ITM_ATTR TDRIA
		         WHERE  TDRIA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDRIA.MSTR_FL              = '1'
		         AND    TDRIA.RATE_ITM_CD          = #{productDevMgt.rateItmCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getRateItmAttributeCnt" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
        SELECT 
        	(CASE WHEN COUNT( ATTR_CD ) IS NULL THEN 0 ELSE COUNT( ATTR_CD ) END ) AS DATA_CNT
        FROM TPMPD_D_RATE_ITM_ATTR  
        WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
        AND     ATTR_CD      = #{productDevMgt.attrCd}
</select>

<update id="modRateItmAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_D_RATE_ITM_ATTR
		SET     ATTR_VAL     = #{productDevMgt.attrVal, jdbcType=VARCHAR }  ,
		        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		        CHG_DATE = #{productDevMgt.sysdate},
		        INACT_DT   = #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		        ACT_DT    = #{productDevMgt.currentDay, jdbcType=VARCHAR }
		WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND     ATTR_CD      = #{productDevMgt.attrCd}
</update>

<insert id="addRateItmAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	INSERT INTO TPMPD_D_RATE_ITM_ATTR
		(
		    RATE_ITM_CD,
		    ATTR_CD,
		    ATTR_VAL,
		    CHGR_ID,
		    CHG_DATE,
		    INACT_DT,
		    ACT_DT,
		    REGR_ID,
		    REG_DATE,
		    MSTR_FL
		)
		VALUES
		
		(
		    #{productDevMgt.rateItmCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.attrCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.attrVal, jdbcType=VARCHAR }  ,
		    #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		    #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		    #{productDevMgt.regrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR }
		)
</insert>		

<select id="getRateItmCondList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDRIC.RATE_ITM_CD,
		        TDRIC.COND_NO,
		        TF.FCTR_NM,
		        TF.FCTR_CD,
		        TDRIC.COND_OPERATOR,
		       (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00015'
		           AND    B.COMMON_CD   = TDRIC.COND_OPERATOR
		       )  COND_OPERATOR_NM,
		       (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00059'
		           AND    B.COMMON_CD   = TDRIC.OPRND_REF_FL
		       )  OPRND_REF_FL_NM,
		       TDRIC.OPRND_1,
		       TDRIC.OPRND_1 AS OPRND_1_NM,
		       (
		           SELECT TF_1.FCTR_NM
		           FROM   TPMBI_FCTR TF_1
		           WHERE  TDRIC.OPRND_FCTR_CD_1 =TF_1.FCTR_CD
		           AND    TF_1.MSTR_FL     = '1'
		           AND    TF_1.INACT_DT >= #{productDevMgt.currentDay}
		       ) OPRND_FCTR_CD_1_NM,
		       TDRIC.OPRND_2 ,
		       TDRIC.OPRND_2 AS OPRND_2_NM,
		       (
		           SELECT TF_2.FCTR_NM
		           FROM   TPMBI_FCTR TF_2
		           WHERE  TDRIC.OPRND_FCTR_CD_2 =TF_2.FCTR_CD
		           AND    TF_2.MSTR_FL     = '1'
		           AND    TF_2.INACT_DT >= #{productDevMgt.currentDay}
		       ) OPRND_FCTR_CD_2_NM ,
		       TPSF.DATA_TYP,
		       TPSF.REF_TABLE_ID,
		       TPSF.REF_COLMN_ID,
		       TPSF.REF_COLMN_NM,
		       TPSF.REF_CD
		FROM    TPMPD_D_RATE_ITM_COND TDRIC,
		        TPMPD_D_RATE_ITM_FCTR   TPSF ,
		        TPMBI_FCTR            TF
		WHERE   TDRIC.FCTR_CD     = TF.FCTR_CD
		AND     TDRIC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND     TDRIC.FCTR_CD     = TPSF.FCTR_CD
		AND     TDRIC.MSTR_FL     = '1'
		AND     TF.MSTR_FL        = '1'
		AND     TDRIC.RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		ORDER BY TDRIC.CHG_DATE DESC
<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>
</select>

<select id="getRateItmCondList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDRIC.RATE_ITM_CD,
		        TDRIC.COND_NO,
		        TF.FCTR_NM,
		        TF.FCTR_CD,
		       (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00015'
		           AND    B.COMMON_CD   = TDRIC.COND_OPERATOR
		       )  COND_OPERATOR_NM,
		       (
		           SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00059'
		           AND    B.COMMON_CD   = TDRIC.OPRND_REF_FL
		       )  OPRND_REF_FL_NM,
		       TDRIC.OPRND_1,
		       TDRIC.OPRND_1 AS OPRND_1_NM,
		       (
		           SELECT TF_1.FCTR_NM
		           FROM   TPMBI_FCTR TF_1
		           WHERE  TDRIC.OPRND_FCTR_CD_1 =TF_1.FCTR_CD
		           AND    TF_1.MSTR_FL     = '1'
		           AND    TF_1.INACT_DT >= #{productDevMgt.currentDay}
		       ) OPRND_FCTR_CD_1_NM,
		       TDRIC.OPRND_2 ,
		       TDRIC.OPRND_2 AS OPRND_2_NM,
		       (
		           SELECT TF_2.FCTR_NM
		           FROM   TPMBI_FCTR TF_2
		           WHERE  TDRIC.OPRND_FCTR_CD_2 =TF_2.FCTR_CD
		           AND    TF_2.MSTR_FL     = '1'
		           AND    TF_2.INACT_DT >= #{productDevMgt.currentDay}
		       ) OPRND_FCTR_CD_2_NM ,
		       TPSF.DATA_TYP,
		       TPSF.REF_CD,
	           TDRIC.INACT_DT,
	           TDRIC.ACT_DT
		FROM    TPMPD_RATE_ITM_COND TDRIC,
		        TPMPD_RATE_ITM_FCTR   TPSF ,
		        TPMBI_FCTR            TF
		WHERE   TDRIC.FCTR_CD     = TF.FCTR_CD
		AND     TDRIC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND     TDRIC.FCTR_CD     = TPSF.FCTR_CD
		AND     TDRIC.MSTR_FL     = '1'
		AND     TF.MSTR_FL        = '1'
    	AND     TPSF.MSTR_FL        = '1'		
		AND     TDRIC.RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		ORDER BY TDRIC.CHG_DATE DESC
<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>
</select>

<select id="getRateItmCondListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
		SELECT  COUNT(*)
		FROM    TPMPD_D_RATE_ITM_COND TDRIC,
		        TPMPD_D_RATE_ITM_FCTR   TPSF ,
		        TPMBI_FCTR            TF
		WHERE   TDRIC.FCTR_CD     = TF.FCTR_CD
		AND     TDRIC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND     TDRIC.FCTR_CD     = TPSF.FCTR_CD
		AND     TDRIC.MSTR_FL     = '1'
		AND     TF.MSTR_FL        = '1'
		AND     TDRIC.RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		ORDER BY TDRIC.CHG_DATE DESC
</select>

<select id="getRateItmCondListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
		SELECT  COUNT(*)
		FROM    TPMPD_RATE_ITM_COND TDRIC,
		        TPMPD_RATE_ITM_FCTR   TPSF ,
		        TPMBI_FCTR            TF
		WHERE   TDRIC.FCTR_CD     = TF.FCTR_CD
		AND     TDRIC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND     TDRIC.FCTR_CD     = TPSF.FCTR_CD
		AND     TDRIC.MSTR_FL     = '1'
		AND     TF.MSTR_FL        = '1'
    	AND     TPSF.MSTR_FL        = '1'		
		AND     TDRIC.RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		ORDER BY TDRIC.CHG_DATE DESC
</select>

<select id="getTableDataList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="map">
		SELECT  #{conTableMap.REF_TABLE_ID} AS COMMON_GRP,
		        ${conTableMap.REF_COLMN_ID} AS COMMON_CD,
		        CONCAT(CONCAT(#{conTableMap.REF_TABLE_ID} ,'*'), ${conTableMap.REF_COLMN_ID}) AS COMMON_GRP_CD
		FROM    ${conTableMap.REF_TABLE_ID}
		<if test="conTableMap.REF_TABLE_COND != null">
			WHERE ${conTableMap.REF_TABLE_COND}
		</if>     
		<if test='conTableMap.REF_TABLE_ID.equals("TSYCM_CODE_DETAIL_NAME")'>
	    	AND  LNG_TYP = 'ENG'
	    </if>			
		<if test='conTableMap.LNG_TYP.equals("ko")'>
			AND  LNG_TYP = 'ko'  
	    </if>   
	    <if test='conTableMap.LNG_TYP.equals("en")'>
			AND  LNG_TYP = 'en'  
	    </if> 
</select>

<select id="getAddRateItmCondInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	    SELECT '[]' AS FCTR_CD,
	           'SEL' AS FCTR_NM,
	           NULL  AS REF_CD,
	           NULL  AS REF_TABLE_ID,
		       NULL  AS REF_COLMN_ID,
		       NULL  AS REF_COLMN_NM,
		       NULL  AS REF_TABLE_COND,
		       NULL  AS DATA_TYP
	    FROM DUAL
	    UNION ALL
		SELECT A.FCTR_CD,
		       B.FCTR_NM,
		       A.REF_CD,
	           A.REF_TABLE_ID,
		       A.REF_COLMN_ID,
		       A.REF_COLMN_NM,
		       A.REF_TABLE_COND,
           	   A.DATA_TYP
		FROM   TPMPD_D_RATE_ITM_FCTR A,
		       TPMBI_FCTR B
		WHERE  A.RATE_ITM_CD = #{productDevMgt.rateItmCd}
		<if test='productDevMgt.procFl.equals("ADD_PROC")'>
		AND    A.FCTR_CD NOT IN (
		                          SELECT FCTR_CD
		                          FROM   TPMPD_D_RATE_ITM_COND
		                          WHERE  RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		                         )
	   </if>
	   <if test='productDevMgt.procFl.equals("MOD_PROC")'>
		AND    A.FCTR_CD NOT IN (
		                          SELECT FCTR_CD
		                          FROM   TPMPD_D_RATE_ITM_COND
		                          WHERE  RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
		                          AND    COND_NO     != #{productDevMgt.condNo}
		                         )
	   </if>
	  	AND    A.FCTR_CD = B.FCTR_CD
		AND    B.MSTR_FL = '1'
		AND    B.INACT_DT > #{productDevMgt.currentDay}

</select>

<insert id="addRateItmCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE_ITM_COND
		(
			RATE_ITM_CD      ,
			COND_NO          ,
			INACT_DT       ,
			ACT_DT        ,
			FCTR_CD          ,
			COND_OPERATOR    ,
			OPRND_REF_FL     ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_2          ,
			OPRND_FCTR_CD_2  ,
			MSTR_FL          ,
			REGR_ID     ,
			REG_DATE   ,
			CHGR_ID       ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.rateItmCd, jdbcType=VARCHAR }  ,
			#{productDevMgt.condNo1, jdbcType=VARCHAR }  ,
			#{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
			#{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
			#{productDevMgt.fctrCd, jdbcType=VARCHAR }  ,
			#{productDevMgt.condOperator, jdbcType=VARCHAR }  ,
			#{productDevMgt.oprndRefFl, jdbcType=VARCHAR }  ,
			#{productDevMgt.oprnd1, jdbcType=VARCHAR }  ,
			#{productDevMgt.oprndFctrCd1, jdbcType=VARCHAR }  ,
			#{productDevMgt.oprnd2, jdbcType=VARCHAR }  ,
			#{productDevMgt.oprndFctrCd2, jdbcType=VARCHAR }  ,
			#{productDevMgt.mstrFl, jdbcType=VARCHAR }	,
			#{productDevMgt.regrId, jdbcType=VARCHAR }  ,
			#{productDevMgt.sysdate},
			#{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
			#{productDevMgt.sysdate}
		)
</insert>		

<select id="getRateItmCond" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TDPSC.RATE_ITM_CD         ,
		       TDPSC.COND_NO         ,
		       TDPSC.INACT_DT      ,
		       TDPSC.FCTR_CD         ,
		       TDPSC.COND_OPERATOR   ,
		       TDPSC.OPRND_REF_FL    ,
		       TDPSC.OPRND_1         ,
		       TDPSC.OPRND_1 AS OPRND_1_NM      ,
		       TDPSC.OPRND_FCTR_CD_1 ,
		       TDPSC.OPRND_2         ,
		       TDPSC.OPRND_2  AS OPRND_2_NM      ,
		       TDPSC.OPRND_FCTR_CD_2 ,
		       TDPSC.CHGR_ID,
		       TPSF.DATA_TYP,
		       TPSF.REF_TABLE_ID,
		       TPSF.REF_COLMN_ID,
		       TPSF.REF_COLMN_NM,
		       TPSF.REF_CD
		FROM   TPMPD_D_RATE_ITM_COND TDPSC ,
			   TPMPD_D_RATE_ITM_FCTR   TPSF
		WHERE  TDPSC.MSTR_FL      = '1'
		AND    TDPSC.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND    TDPSC.COND_NO      = #{productDevMgt.condNo}
		AND    TDPSC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND    TDPSC.FCTR_CD      = TPSF.FCTR_CD

</select>

<update id="modRateItmCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_RATE_ITM_COND
		SET    INACT_DT       =  #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		       FCTR_CD          =  #{productDevMgt.fctrCd, jdbcType=VARCHAR }  ,
		       COND_OPERATOR    =  #{productDevMgt.condOperator, jdbcType=VARCHAR }  ,
		       OPRND_REF_FL     =  #{productDevMgt.oprndRefFl, jdbcType=VARCHAR }  ,
		       OPRND_1          =  #{productDevMgt.oprnd1, jdbcType=VARCHAR }  ,
		       OPRND_FCTR_CD_1  =  #{productDevMgt.oprndFctrCd1, jdbcType=VARCHAR }  ,
		       OPRND_2          =  #{productDevMgt.oprnd2, jdbcType=VARCHAR }  ,
		       OPRND_FCTR_CD_2  =  #{productDevMgt.oprndFctrCd2, jdbcType=VARCHAR }  ,
		       ACT_DT        = #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		       CHGR_ID       = #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		       CHG_DATE     = #{productDevMgt.sysdate}
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    COND_NO     = #{productDevMgt.condNo}
</update>

<select id="getAllowanceListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
         SELECT COUNT(*)
         FROM   TPMPD_D_RATE TDR
         WHERE  RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
</select>

<select id="getAllowanceListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
         SELECT COUNT(*)
         FROM   TPMPD_RATE TDR
         WHERE  RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
         AND MSTR_FL = '1'
</select>

<select id="getAllowanceList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
         SELECT TDR.RATE_ITM_CD     ,
          CASE WHEN FCTR_VAL1 !='*' THEN 
           ( SELECT C.CODE_NM AS COMMON_CD_NM
            FROM   TSYCO_CODE_DETAIL B
             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
             AND 	B.COMMON_GRP = C.COMMON_GRP
             AND 	B.COMMON_CD = C.COMMON_CD
             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '1' AND RATE_INFO_EXE_FL ='1')
             AND    B.COMMON_CD   = TDR.FCTR_VAL1)  
         WHEN   FCTR_VAL2 !='*' THEN
           ( SELECT C.CODE_NM AS COMMON_CD_NM
            FROM   TSYCO_CODE_DETAIL B
             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
             AND 	B.COMMON_GRP = C.COMMON_GRP
             AND 	B.COMMON_CD = C.COMMON_CD
             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '2' AND RATE_INFO_EXE_FL ='1')
             AND    B.COMMON_CD   = TDR.FCTR_VAL2)  
         WHEN   FCTR_VAL3 !='*' THEN 
           ( SELECT C.CODE_NM AS COMMON_CD_NM
            FROM   TSYCO_CODE_DETAIL B
             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
             AND 	B.COMMON_GRP = C.COMMON_GRP
             AND 	B.COMMON_CD = C.COMMON_CD
             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '3' AND RATE_INFO_EXE_FL ='1')
             AND    B.COMMON_CD   = TDR.FCTR_VAL3)   
            WHEN   FCTR_VAL4 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '4' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL4)     
            WHEN   FCTR_VAL5 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '5' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL5)      
            WHEN   FCTR_VAL6 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '6' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL6)     
            WHEN   FCTR_VAL7 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '7' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL7)      
            WHEN   FCTR_VAL8 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '8' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL8)   
            WHEN   FCTR_VAL9 !='*' THEN 
             ( SELECT C.CODE_NM AS COMMON_CD_NM
              FROM   TSYCO_CODE_DETAIL B
               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
               AND 	B.COMMON_GRP = C.COMMON_GRP
               AND 	B.COMMON_CD = C.COMMON_CD
               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '9' AND RATE_INFO_EXE_FL ='1')
               AND    B.COMMON_CD   = TDR.FCTR_VAL9)       
          	ELSE  ''  END AS FCTR_VAL_NM , 
                TDR.FCTR_VAL1       ,
                TDR.FCTR_VAL2       ,
                TDR.FCTR_VAL3       ,
                TDR.FCTR_VAL4       ,
                TDR.FCTR_VAL5       ,
                TDR.FCTR_VAL6       ,
                TDR.FCTR_VAL7       ,
                TDR.FCTR_VAL8       ,
                TDR.FCTR_VAL9       ,
                TDR.RATE_REF_FL     ,
          
                 (  SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00056'
		           AND    B.COMMON_CD   = TDR.RATE_REF_FL) 
                RATE_REF_FL_NM,
                TDR.RATE_VAL        ,
                TDR.RATE_FCTR_CD    ,
                CASE WHEN TDR.RATE_REF_FL  = '0' THEN '' ELSE 
                  CASE WHEN RATE_FCTR_CD IS NULL THEN RATE_FCTR_CD
                       ELSE (SELECT DISTINCT TF.FCTR_NM
                             FROM   TPMPD_D_RATE_ITM_FCTR TDRIF ,
                                    TPMBI_FCTR TF
                             WHERE  TDR.RATE_FCTR_CD   = TDRIF.FCTR_CD
                             AND    TDRIF.FCTR_CD      = TF.FCTR_CD
                             AND    TF.MSTR_FL         = '1')
                  END
                END RATE_FCTR_NM, 
                TDR.DIVI_RATE_AMT   ,
                TDR.QTY_REF_FL      ,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00057'
		           AND    B.COMMON_CD   = TDR.QTY_REF_FL) QTY_REF_FL_NM,
                TDR.QTY             ,
                TDR.QTY_FCTR_CD     ,
                CASE WHEN TDR.QTY_REF_FL   = '0' THEN '' ELSE 
                CASE WHEN QTY_FCTR_CD IS NULL THEN QTY_FCTR_CD
                     ELSE (SELECT DISTINCT TF.FCTR_NM
                           FROM   TPMPD_D_RATE_ITM_FCTR TDRIF ,
                                  TPMBI_FCTR TF
                           WHERE  TDR.QTY_FCTR_CD = TDRIF.FCTR_CD
                           AND    TDRIF.FCTR_CD   = TF.FCTR_CD
                           AND    TF.MSTR_FL      = '1')
                  END
                END QTY_FCTR_NM,  
                TDR.CRNCY_REF_FL    ,
                (SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00058'
		           AND    B.COMMON_CD   = TDR.CRNCY_REF_FL) CRNCY_REF_FL_NM,
                TDR.CRNCY_CD        ,
                (  SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00041'
		           AND    B.COMMON_CD   = TDR.CRNCY_CD ) CRNCY_CD_NM,
                TDR.CRNCY_FCTR_CD   ,
                CASE WHEN TDR.CRNCY_REF_FL   = '0' THEN '' ELSE 
                CASE WHEN CRNCY_FCTR_CD IS NULL THEN CRNCY_FCTR_CD
                     ELSE (SELECT DISTINCT TF.FCTR_NM
                           FROM   TPMPD_D_RATE_ITM_FCTR TDRIF ,
                                  TPMBI_FCTR TF
                           WHERE  TDR.CRNCY_FCTR_CD = TDRIF.FCTR_CD
                           AND    TDRIF.FCTR_CD   = TF.FCTR_CD
                           AND    TF.MSTR_FL      = '1')
                  END
                END CRNCY_FCTR_NM,  
                TDR.ALWNCE_CD ,
                CASE WHEN ALWNCE_CD IS NULL THEN ALWNCE_CD
                    ELSE (SELECT TDA.ALWNCE_NM
                          FROM   TPMPD_D_ALWNCE TDA
                          WHERE  TDA.ALWNCE_CD = TDR.ALWNCE_CD )
                END ALWNCE_NM,
                 '0' AS CHK
         FROM   TPMPD_D_RATE TDR
         WHERE  RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
</select>

<select id="getAllowanceList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
         SELECT TDR.RATE_ITM_CD     ,
	          CASE WHEN FCTR_VAL1 !='*' THEN 
	           ( SELECT C.CODE_NM AS COMMON_CD_NM
	            FROM   TSYCO_CODE_DETAIL B
	             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	             AND 	B.COMMON_GRP = C.COMMON_GRP
	             AND 	B.COMMON_CD = C.COMMON_CD
	             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '1' AND MSTR_FL ='1')
	             AND    B.COMMON_CD   = TDR.FCTR_VAL1)  
	         WHEN   FCTR_VAL2 !='*' THEN
	           ( SELECT C.CODE_NM AS COMMON_CD_NM
	            FROM   TSYCO_CODE_DETAIL B
	             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	             AND 	B.COMMON_GRP = C.COMMON_GRP
	             AND 	B.COMMON_CD = C.COMMON_CD
	             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '2' AND MSTR_FL ='1')
	             AND    B.COMMON_CD   = TDR.FCTR_VAL2)  
	         WHEN   FCTR_VAL3 !='*' THEN 
	           ( SELECT C.CODE_NM AS COMMON_CD_NM
	            FROM   TSYCO_CODE_DETAIL B
	             LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	             ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	             AND 	B.COMMON_GRP = C.COMMON_GRP
	             AND 	B.COMMON_CD = C.COMMON_CD
	             WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '3' AND MSTR_FL ='1')
	             AND    B.COMMON_CD   = TDR.FCTR_VAL3)   
	            WHEN   FCTR_VAL4 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '4' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL4)     
	            WHEN   FCTR_VAL5 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '5' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL5)      
	            WHEN   FCTR_VAL6 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '6' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL6)     
	            WHEN   FCTR_VAL7 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '7' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL7)      
	            WHEN   FCTR_VAL8 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '8' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL8)   
	            WHEN   FCTR_VAL9 !='*' THEN 
	             ( SELECT C.CODE_NM AS COMMON_CD_NM
	              FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	               ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
	               AND 	B.COMMON_GRP = C.COMMON_GRP
	               AND 	B.COMMON_CD = C.COMMON_CD
	               WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '9' AND MSTR_FL ='1')
	               AND    B.COMMON_CD   = TDR.FCTR_VAL9)       
	          	ELSE  ''  END AS FCTR_VAL_NM ,          
                TDR.FCTR_VAL1       ,
                TDR.FCTR_VAL2       ,
                TDR.FCTR_VAL3       ,
                TDR.FCTR_VAL4       ,
                TDR.FCTR_VAL5       ,
                TDR.FCTR_VAL6       ,
                TDR.FCTR_VAL7       ,
                TDR.FCTR_VAL8       ,
                TDR.FCTR_VAL9       ,
                TDR.RATE_REF_FL     ,
                (  SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00056'
		           AND    B.COMMON_CD   = TDR.RATE_REF_FL) RATE_REF_FL_NM,
                TDR.RATE_VAL        ,
                TDR.RATE_FCTR_CD    ,
                CASE WHEN RATE_FCTR_CD IS NULL THEN RATE_FCTR_CD
                     ELSE (SELECT DISTINCT TF.FCTR_NM
                           FROM   TPMPD_RATE_ITM_FCTR TDRIF ,
                                  TPMBI_FCTR TF
                           WHERE  TDR.RATE_FCTR_CD   = TDRIF.FCTR_CD
                           AND    TDRIF.FCTR_CD      = TF.FCTR_CD
                           AND    TF.MSTR_FL         = '1')
                END  RATE_FCTR_NM ,
                TDR.DIVI_RATE_AMT   ,
                TDR.QTY_REF_FL      ,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00057'
		           AND    B.COMMON_CD   = TDR.QTY_REF_FL) QTY_REF_FL_NM,
                TDR.QTY             ,
                TDR.QTY_FCTR_CD     ,
                CASE WHEN QTY_FCTR_CD IS NULL THEN QTY_FCTR_CD
                     ELSE (SELECT DISTINCT TF.FCTR_NM
                           FROM   TPMPD_RATE_ITM_FCTR TDRIF ,
                                  TPMBI_FCTR TF
                           WHERE  TDR.QTY_FCTR_CD = TDRIF.FCTR_CD
                           AND    TDRIF.FCTR_CD   = TF.FCTR_CD
                           AND    TF.MSTR_FL      = '1')
                END QTY_FCTR_NM ,
                TDR.CRNCY_REF_FL    ,
                (SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00058'
		           AND    B.COMMON_CD   = TDR.CRNCY_REF_FL) CRNCY_REF_FL_NM,
                TDR.CRNCY_CD        ,
                (  SELECT C.CODE_NM AS COMMON_CD_NM
		           FROM   TSYCO_CODE_DETAIL B
                   LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           AND 	B.COMMON_GRP = C.COMMON_GRP
		           AND 	B.COMMON_CD = C.COMMON_CD
		           WHERE  B.COMMON_GRP  = 'PP00041'
		           AND    B.COMMON_CD   = TDR.CRNCY_CD ) CRNCY_CD_NM,
                TDR.CRNCY_FCTR_CD   ,
                CASE WHEN CRNCY_FCTR_CD IS NULL THEN CRNCY_FCTR_CD
                     ELSE (SELECT DISTINCT TF.FCTR_NM
                           FROM   TPMPD_RATE_ITM_FCTR TDRIF ,
                                  TPMBI_FCTR TF
                           WHERE  TDR.CRNCY_FCTR_CD = TDRIF.FCTR_CD
                           AND    TDRIF.FCTR_CD   = TF.FCTR_CD
                           AND    TF.MSTR_FL      = '1')
                END CRNCY_FCTR_NM ,
                TDR.ALWNCE_CD ,
                CASE WHEN ALWNCE_CD IS NULL THEN ALWNCE_CD
                    ELSE (SELECT TDA.ALWNCE_NM
                          FROM   TPMPD_ALWNCE TDA
                          WHERE  TDA.ALWNCE_CD = TDR.ALWNCE_CD )
                END ALWNCE_NM,
                 '0' AS CHK,
                 ACT_DT,
                 INACT_DT
         FROM   TPMPD_RATE TDR
         WHERE  RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
         AND MSTR_FL = '1'
</select>

<select id="getAddRateItmRateFctrInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT '' AS FCTR_CD,
		       'SEL' AS FCTR_NM,
		       0 AS FCTR_NO 
         FROM DUAL       
        UNION ALL           
		SELECT A.FCTR_CD,
		       B.FCTR_NM,
		       A.FCTR_NO
		FROM   TPMPD_D_RATE_ITM_FCTR A,
		       TPMBI_FCTR B
		WHERE  A.RATE_ITM_CD = #{productDevMgt.rateItmCd}
	    AND    A.FCTR_CD = B.FCTR_CD
		AND    B.MSTR_FL = '1'
</select>

<select id="getOprndNm" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT  #{productDevMgt.fctrNo} AS FCTR_NO,
                 MAST.COMMON_GRP
                ,DETAIL.COMMON_CD
                ,COALESCE((SELECT CODE_NM 
                  FROM TSYCO_CODE_DETAIL_NAME NAME
                  WHERE NAME.COMMON_GRP = DETAIL.COMMON_GRP
                  AND   NAME.COMMON_CD  = DETAIL.COMMON_CD
                  AND   NAME.LNG_TYP    =#{productDevMgt.lngTyp}),DETAIL.COMMON_CD_NM) AS COMMON_CD_NM
                ,DETAIL.REF_CODE
                ,DETAIL.REF_CODE2
                ,DETAIL.REF_CODE3
                ,DETAIL.REF_CODE4
                ,DETAIL.DEFAULT_YN
                ,DETAIL.RMRK
                ,DETAIL.SORT_NO
                ,DETAIL.USE_YN
        FROM TSYCO_CODE_MAST MAST
            , TSYCO_CODE_DETAIL DETAIL
        WHERE   MAST.COMMON_GRP     =DETAIL.COMMON_GRP
            AND MAST.COMMON_GRP   = #{productDevMgt.refCd}
            AND DETAIL.COMMON_CD  in (${productDevMgt.oprnd1})
            AND DETAIL.USE_YN     ='Y'
            AND MAST.USE_YN       ='Y'  
</select>

<select id="getAddRateItmRateFctrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	

		SELECT  
		        TF.FCTR_NM,    
				   TPSF.DATA_TYP,
		       TPSF.REF_TABLE_ID,
		       TPSF.REF_COLMN_ID,
		       TPSF.REF_COLMN_NM,
            TPSF.REF_CD,
 		        NULL AS FCTR_VAL,
		        TPSF.FCTR_NO AS FCTR_NO,     
            TDRIC.OPRND_1,
         	  TDRIC.OPRND_2		      
		FROM    
		        TPMPD_D_RATE_ITM_FCTR   TPSF ,
            TPMPD_D_RATE_ITM_COND TDRIC,
		        TPMBI_FCTR            TF
		WHERE   TDRIC.FCTR_CD     = TF.FCTR_CD
		AND     TDRIC.RATE_ITM_CD = TPSF.RATE_ITM_CD
		AND     TDRIC.FCTR_CD     = TPSF.FCTR_CD
		AND     TDRIC.MSTR_FL     = '1'
		AND     TF.MSTR_FL        = '1'
		AND 	TPSF.RATE_INFO_EXE_FL = '1'
		AND     TDRIC.RATE_ITM_CD     = #{productDevMgt.rateItmCd}
		ORDER BY FCTR_NO ASC
		
</select>

<select id="getDupRateItmRateList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  RATE_ITM_CD
		FROM    TPMPD_D_RATE
		WHERE   RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND     FCTR_VAL1   = #{productDevMgt.fctrVal1}
		AND     FCTR_VAL2   = #{productDevMgt.fctrVal2}
		AND     FCTR_VAL3   = #{productDevMgt.fctrVal3}
		AND     FCTR_VAL4   = #{productDevMgt.fctrVal4}
		AND     FCTR_VAL5   = #{productDevMgt.fctrVal5}
		AND     FCTR_VAL6   = #{productDevMgt.fctrVal6}
		AND     FCTR_VAL7   = #{productDevMgt.fctrVal7}
		AND     FCTR_VAL8   = #{productDevMgt.fctrVal8}
		AND     FCTR_VAL9   = #{productDevMgt.fctrVal9}

</select>

<insert id="addRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_RATE
		(
		    RATE_ITM_CD     ,
		    FCTR_VAL1       ,
		    FCTR_VAL2       ,
		    FCTR_VAL3       ,
		    FCTR_VAL4       ,
		    FCTR_VAL5       ,
		    FCTR_VAL6       ,
		    FCTR_VAL7       ,
		    FCTR_VAL8       ,
		    FCTR_VAL9       ,
		    INACT_DT      ,
		    ACT_DT       ,
		    RATE_REF_FL     ,
		    RATE_VAL        ,
		    RATE_FCTR_CD    ,
		    DIVI_RATE_AMT   ,
		    QTY_REF_FL      ,
		    QTY             ,
		    QTY_FCTR_CD     ,
		    CRNCY_REF_FL    ,
		    CRNCY_CD        ,
		    CRNCY_FCTR_CD   ,
		    ALWNCE_CD       ,
		    MSTR_FL         ,
		    REGR_ID    ,
		    REG_DATE  ,
		    CHGR_ID      ,
		    CHG_DATE
		)
		VALUES
		(
		    #{productDevMgt.rateItmCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal1, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal2, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal3, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal4, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal5, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal6, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal7, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal8, jdbcType=VARCHAR }  ,
		    #{productDevMgt.fctrVal9, jdbcType=VARCHAR }  ,
		    #{productDevMgt.inactDt, jdbcType=VARCHAR }  ,
		    #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
		    #{productDevMgt.rateRefFl, jdbcType=VARCHAR }  ,
		    #{productDevMgt.rateVal, jdbcType=VARCHAR }  ,
		    #{productDevMgt.rateFctrCd, jdbcType=VARCHAR }  ,
			#{productDevMgt.diviRateAmt, jdbcType=VARCHAR }  ,
		    #{productDevMgt.qtyRefFl, jdbcType=VARCHAR }  ,
		    #{productDevMgt.qty, jdbcType=VARCHAR }  ,
		    #{productDevMgt.qtyFctrCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.crncyRefFl, jdbcType=VARCHAR }  ,
		    #{productDevMgt.crncyCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.crncyFctrCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.alwnceCd, jdbcType=VARCHAR }  ,
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR }	,
		    #{productDevMgt.regrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		    #{productDevMgt.sysdate}
		)
</insert>

<select id="getRateItmRate" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TDR.RATE_ITM_CD     ,
		       TDR.FCTR_VAL1       ,
		       CASE WHEN FCTR_VAL1 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '1')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL1)  
		           ELSE FCTR_VAL1 
	           END FCTR_VAL_NM1 ,  		       
		       TDR.FCTR_VAL2       ,
		       CASE WHEN FCTR_VAL2 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '2')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL2)  
		           ELSE FCTR_VAL2 
	           END FCTR_VAL_NM2 ,  			       
		       TDR.FCTR_VAL3       ,
		       CASE WHEN FCTR_VAL3 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '3')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL3)  
		           ELSE FCTR_VAL3 
	           END FCTR_VAL_NM3 ,  				       
		       TDR.FCTR_VAL4       ,
		       CASE WHEN FCTR_VAL4 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '4')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL4)  
		           ELSE FCTR_VAL4 
	           END FCTR_VAL_NM4 , 		       
		       TDR.FCTR_VAL5       ,
		       CASE WHEN FCTR_VAL5 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '5')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL5)  
		           ELSE FCTR_VAL5 
	           END FCTR_VAL_NM5, 		       
		       TDR.FCTR_VAL6       ,
		       CASE WHEN FCTR_VAL6 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '6')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL6)  
		           ELSE FCTR_VAL6 
	           END FCTR_VAL_NM6, 		       
		       TDR.FCTR_VAL7       ,
		       CASE WHEN FCTR_VAL7 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '7')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL7)  
		           ELSE FCTR_VAL7 
	           END FCTR_VAL_NM7, 			       
		       TDR.FCTR_VAL8       ,
		       CASE WHEN FCTR_VAL8 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '8')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL8)  
		           ELSE FCTR_VAL8 
	           END FCTR_VAL_NM8, 			       
		       TDR.FCTR_VAL9       ,
		       CASE WHEN FCTR_VAL9 !='*' THEN 
		         	(SELECT C.CODE_NM AS COMMON_CD_NM
		          	FROM   TSYCO_CODE_DETAIL B
		           	LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		           	ON 	#{productDevMgt.lngTyp} = C.LNG_TYP
		           	AND 	B.COMMON_GRP = C.COMMON_GRP
		           	AND 	B.COMMON_CD = C.COMMON_CD
		           	WHERE  B.COMMON_GRP  = (SELECT REF_CD FROM  TPMPD_D_RATE_ITM_FCTR WHERE RATE_ITM_CD = TDR.RATE_ITM_CD  AND FCTR_NO =  '9')
		           	AND    B.COMMON_CD   = TDR.FCTR_VAL9)  
		           ELSE FCTR_VAL9 
	           END FCTR_VAL_NM9, 		       
		       TDR.RATE_REF_FL     ,
		       TDR.RATE_VAL        ,
		       TDR.RATE_FCTR_CD    ,
		       TDR.DIVI_RATE_AMT   ,
		       TDR.QTY_REF_FL      ,
		       TDR.QTY             ,
		       TDR.QTY_FCTR_CD     ,
		       TDR.CRNCY_REF_FL    ,
		       TDR.CRNCY_CD        ,
		       TDR.CRNCY_FCTR_CD   ,
		       TDR.ALWNCE_CD
		FROM   TPMPD_D_RATE TDR
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    FCTR_VAL1   = #{productDevMgt.fctrVal1}
		AND    FCTR_VAL2   = #{productDevMgt.fctrVal2}
		AND    FCTR_VAL3   = #{productDevMgt.fctrVal3}
		AND    FCTR_VAL4   = #{productDevMgt.fctrVal4}
		AND    FCTR_VAL5   = #{productDevMgt.fctrVal5}
		AND    FCTR_VAL6   = #{productDevMgt.fctrVal6}
		AND    FCTR_VAL7   = #{productDevMgt.fctrVal7}
		AND    FCTR_VAL8   = #{productDevMgt.fctrVal8}
		AND    FCTR_VAL9   = #{productDevMgt.fctrVal9}

</select>

<update id="modRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_RATE
		SET    RATE_REF_FL     =   #{productDevMgt.rateRefFl, jdbcType=VARCHAR }  ,
		       RATE_VAL        =   #{productDevMgt.rateVal, jdbcType=VARCHAR }  ,
		       RATE_FCTR_CD    =   #{productDevMgt.rateFctrCd, jdbcType=VARCHAR }  ,
		       DIVI_RATE_AMT   =   #{productDevMgt.diviRateAmt, jdbcType=VARCHAR }  ,
		       QTY_REF_FL      =   #{productDevMgt.qtyRefFl, jdbcType=VARCHAR }  ,
		       QTY             =   #{productDevMgt.qty, jdbcType=VARCHAR }  ,
		       QTY_FCTR_CD     =   #{productDevMgt.qtyFctrCd, jdbcType=VARCHAR }  ,
		       CRNCY_REF_FL    =   #{productDevMgt.crncyRefFl, jdbcType=VARCHAR }  ,
		       CRNCY_CD        =   #{productDevMgt.crncyCd, jdbcType=VARCHAR }  ,
		       CRNCY_FCTR_CD   =   #{productDevMgt.crncyFctrCd, jdbcType=VARCHAR }  ,
		       ALWNCE_CD       =   #{productDevMgt.alwnceCd, jdbcType=VARCHAR }  ,
		       CHGR_ID      =   #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
		       CHG_DATE    =   #{productDevMgt.sysdate}
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND    FCTR_VAL1   = #{productDevMgt.fctrVal1}
		AND    FCTR_VAL2   = #{productDevMgt.fctrVal2}
		AND    FCTR_VAL3   = #{productDevMgt.fctrVal3}
		AND    FCTR_VAL4   = #{productDevMgt.fctrVal4}
		AND    FCTR_VAL5   = #{productDevMgt.fctrVal5}
		AND    FCTR_VAL6   = #{productDevMgt.fctrVal6}
		AND    FCTR_VAL7   = #{productDevMgt.fctrVal7}
		AND    FCTR_VAL8   = #{productDevMgt.fctrVal8}
		AND    FCTR_VAL9   = #{productDevMgt.fctrVal9}
</update>

<select id="getConfSbjList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT  TPDH.PROD_CD ,
                TPDH.PROD_NM ,
                TPDH.PROD_DVLP_DTTM,
                TPCD.CONF_REQ_CD ,
                TPCD.CONFR_CD ,
                TPCD.CONF_RSLT ,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00109'
                  AND    B.COMMON_CD  = TPCD.CONF_RSLT) CONF_RSLT_NM ,
                TPCD.CONF_DESC,
                CASE WHEN TPDH.DVLP_TYP = '1' THEN 'NEW'
                     ELSE ( SELECT C.CODE_NM AS COMMON_CD_NM
                            FROM   TSYCO_CODE_DETAIL B
		                    LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		                    ON #{productDevMgt.lngTyp} = C.LNG_TYP
		                    AND B.COMMON_GRP = C.COMMON_GRP
		                    AND B.COMMON_CD = C.COMMON_CD
                            WHERE  B.COMMON_GRP = 'PP00106'
                            AND    B.COMMON_CD  = TPDH.DVLP_TYP)
                END  PROG_GB_NM ,
                (SELECT TDP.MOD_DESC
                 FROM   TPMPD_D_PROD TDP
                 WHERE  TDP.PROD_CD = TPDH.PROD_CD ) MOD_DESC
               ,(SELECT SO_ID FROM TPMPD_D_PROD WHERE PROD_CD = TPDH.PROD_CD ) AS SO_ID
               ,(select SO_NM 
                 from   TSYCO_SO_MAST
                 where  SO_ID = (SELECT SO_ID FROM TPMPD_D_PROD WHERE PROD_CD = TPDH.PROD_CD )
                 and    USE_YN = 'Y') AS SO_NM 
        FROM    TPMPD_PROD_CONF_DTL  TPCD,
                TPMPD_PROD_CONF_HIST TPCH,
                TPMPD_PROD_DVLP_HIST TPDH
        WHERE   TPCD.CONFR_CD       = #{productDevMgt.confrCd}
			<if test="productDevMgt.confRslt != null">
		    	AND  TPCD.CONF_RSLT = #{productDevMgt.confRslt}
		    </if>	        
        AND     TPCD.CONF_REQ_CD    = TPCH.CONF_REQ_CD
        AND     TPCH.PROD_CD        = TPDH.PROD_CD
        AND     TPCH.PROD_DVLP_DTTM = TPDH.PROD_DVLP_DTTM
        AND     TPCH.CONF_STATUS   != '4'
        AND     TPDH.DVLP_STATUS  IN ('2','3','4')
        AND     TPDH.PROD_CD NOT LIKE 'PDC%'
		<if test="productDevMgt.soId != null">
	    AND   TPCD.SO_ID 	     = #{productDevMgt.soId}
	    </if>        
		<if test="productDevMgt.soId == null">
		AND	   TPCD.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>    
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>

<select id="getConfSbjListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT  COUNT(*)
        FROM    TPMPD_PROD_CONF_DTL  TPCD,        
                TPMPD_PROD_CONF_HIST TPCH,
                TPMPD_PROD_DVLP_HIST TPDH
        WHERE   TPCD.CONFR_CD       = #{productDevMgt.confrCd}
			<if test="productDevMgt.confRslt != null">
		    	AND  TPCD.CONF_RSLT = #{productDevMgt.confRslt}
		    </if>	        
        AND     TPCD.CONF_REQ_CD    = TPCH.CONF_REQ_CD
        AND     TPCH.PROD_CD        = TPDH.PROD_CD
        AND     TPCH.PROD_DVLP_DTTM = TPDH.PROD_DVLP_DTTM
        AND     TPCH.CONF_STATUS   != '4'
        AND     TPDH.DVLP_STATUS  IN ('2','3','4')
        AND     TPDH.PROD_CD NOT LIKE 'PDC%'
		<if test="productDevMgt.soId != null">
	    AND   TPCD.SO_ID 	     = #{productDevMgt.soId}
	    </if>        
		<if test="productDevMgt.soId == null">
		AND	   TPCD.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>  		  
</select>

<select id="getTransOperList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT TPDH.PROD_CD ,
               TPDH.PROD_NM ,
               TPCH.CONF_REQ_DTTM ,
               TPDH.DVLP_TYP ,
               TPDH.DVLP_STATUS ,
               ( SELECT C.CODE_NM AS COMMON_CD_NM
                 FROM   TSYCO_CODE_DETAIL B
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
                 AND B.COMMON_GRP = C.COMMON_GRP
                 AND B.COMMON_CD = C.COMMON_CD
                 WHERE  B.COMMON_GRP = 'PP00106'
                 AND    B.COMMON_CD  = TPDH.DVLP_TYP) DVLP_TYP_NM,
               TPDH.MOD_TYP,
               CASE WHEN TPDH.DVLP_TYP = '1' THEN 'NEW'
                     ELSE ( SELECT C.CODE_NM AS COMMON_CD_NM
                            FROM   TSYCO_CODE_DETAIL B
			                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			                ON #{productDevMgt.lngTyp} = C.LNG_TYP
			                AND B.COMMON_GRP = C.COMMON_GRP
			                AND B.COMMON_CD = C.COMMON_CD
                            WHERE  B.COMMON_GRP = 'PP00106'
                            AND    B.COMMON_CD  = TPDH.MOD_TYP) 
               END MOD_TYP_NM,
               TPDH.PROD_DVLP_DTTM,
               SUM( 1 )                                              AS CONF_REQ_CNT ,
               SUM(CASE WHEN TPCD.CONF_RSLT = '0' THEN 1 ELSE 0 END) AS CONFR_NONE_CNT,
               SUM(CASE WHEN TPCH.CONF_STATUS = '3' THEN 1 ELSE 0 END) AS CONFR_OK_CNT,
               SUM(CASE WHEN TPCD.CONF_RSLT = '2' THEN 1 ELSE 0 END) AS CONFR_RETURN_CNT
                  ,(SELECT SO_ID FROM TPMPD_D_PROD WHERE PROD_CD = TPDH.PROD_CD ) AS SO_ID
                  ,(select SO_NM
                     from   TSYCO_SO_MAST
                     where  SO_ID = (SELECT SO_ID FROM TPMPD_D_PROD WHERE PROD_CD = TPDH.PROD_CD )
                     and    USE_YN = 'Y') AS SO_NM
        FROM   TPMPD_PROD_DVLP_HIST TPDH,
               TPMPD_PROD_CONF_HIST TPCH,
               TPMPD_PROD_CONF_DTL  TPCD
        WHERE  TPDH.DVLP_STATUS IN ( '2', '3', '4' )
		<if test="productDevMgt.dvlpStatus != null">
	    	AND   TPDH.DVLP_STATUS = #{productDevMgt.dvlpStatus}
	    </if>           
        AND    TPDH.PROD_CD        = TPCH.PROD_CD
        AND    TPDH.PROD_DVLP_DTTM = TPCH.PROD_DVLP_DTTM
        AND    TPCH.CONF_STATUS IN ( '2', '3' )
        AND    TPCH.CONF_REQ_CD  = TPCD.CONF_REQ_CD
        AND    TPDH.PROD_CD NOT LIKE 'PDC%'    /*   */
		<if test="productDevMgt.soId != null">
	    AND   TPCD.SO_ID 	     = #{productDevMgt.soId}
	    </if>        
		<if test="productDevMgt.soId == null">
		AND	   TPCD.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>          
        GROUP BY TPDH.PROD_CD ,
                 TPDH.PROD_NM ,
                 TPCH.CONF_REQ_DTTM ,
                 TPDH.DVLP_TYP ,
                 TPDH.DVLP_STATUS ,
                 TPDH.MOD_TYP ,
                 TPDH.PROD_DVLP_DTTM,
                 TPCD.SO_ID
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>

<select id="getTransOperListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT COUNT(*)
        FROM   TPMPD_PROD_DVLP_HIST TPDH,
               TPMPD_PROD_CONF_HIST TPCH,
               TPMPD_PROD_CONF_DTL  TPCD
        WHERE  TPDH.DVLP_STATUS IN ( '2', '3', '4' )
		<if test="productDevMgt.dvlpStatus != null">
	    	AND   TPDH.DVLP_STATUS = #{productDevMgt.dvlpStatus}
	    </if>           
        AND    TPDH.PROD_CD        = TPCH.PROD_CD
        AND    TPDH.PROD_DVLP_DTTM = TPCH.PROD_DVLP_DTTM
        AND    TPCH.CONF_STATUS IN ( '2', '3' )
        AND    TPCH.CONF_REQ_CD  = TPCD.CONF_REQ_CD
        AND    TPDH.PROD_CD NOT LIKE 'PDC%'    /*   */
		<if test="productDevMgt.soId != null">
	    AND   TPCD.SO_ID 	     = #{productDevMgt.soId}
	    </if>        
		<if test="productDevMgt.soId == null">
		AND	   TPCD.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if>          		  
</select>

<select id="getConfDeptComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
   		SELECT   ''   AS ORG_ID
   		        ,'ALL' AS ORG_NM
                ,'' AS SO_ID
   		  FROM  DUAL
   		UNION ALL 
		SELECT  ORG_ID
		       ,ORG_NM
               ,SO_ID
		FROM   TSYCO_ORG_INFO
		WHERE SO_ID = #{productDevMgt.soId}    
</select>  

<select id="getConfUsrIdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	    SELECT  '' AS CONF_REQ_CD,
          B.SO_ID,
          B.ORG_ID,
          B.ORG_NM,
          A.USER_ID,
          A.USER_NAME
		  FROM TSYCO_USER A ,
		  TSYCO_ORG_INFO B
        WHERE A.ORG_ID = B.ORG_ID
		AND A.USE_YN = 'Y'
		<if test="productDevMgt.orgNm != null">
		 	AND A.USER_NAME LIKE CONCAT(CONCAT('%', #{productDevMgt.orgNm}), '%')
	    </if>		
		<if test="productDevMgt.orgId != null">
		 	AND B.ORG_ID = #{productDevMgt.orgId}
	    </if>	    
		<if test="productDevMgt.soId != null">
	    	AND   B.SO_ID 	     = #{productDevMgt.soId}
	    </if>    
	    
		<if test="productDevMgt.authChk!= null">
			AND A.USER_GROUP_ID IN (
	        SELECT USER_GROUP_ID from  TSYCO_USER_GROUP_AUTH
	        WHERE  MENU_NO  IN (SELECT COMMON_CD FROM TSYCO_CODE_DETAIL WHERE COMMON_GRP = 'PP00302')
	        AND auth_c_YN = 'Y'
	        AND auth_U_yn = 'Y') 
	    </if>    
	    	        
		<if test="productDevMgt.soId == null">
			AND	   B.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach> 	
	    </if> 
</select>  

<select id="getDupConferCd" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT CONFR_CD
		FROM   TPMPD_PROD_CONF_DTL
		WHERE  CONF_REQ_CD = #{productDevMgt.confReqCd}
		AND    CONFR_CD    = #{productDevMgt.userId}  
</select>  

<insert id="addProdConfDtl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_CONF_DTL
		(
			CONF_REQ_CD    ,
			CONFR_CD       ,
			SO_ID          ,
			CONF_ORG_CD    ,
			CONF_REQ_DTTM  ,
			CONF_DTTM      ,
			CONF_RSLT      ,
			CONF_DESC      ,
			CHGR_ID     ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.confReqCd, jdbcType=VARCHAR }  ,
			#{productDevMgt.userId, jdbcType=VARCHAR }  ,
			#{productDevMgt.soId, jdbcType=VARCHAR }  ,
			#{productDevMgt.orgId, jdbcType=VARCHAR }  , 
			#{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
			NULL           ,
			'0'            ,
			NULL           ,
			#{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
			#{productDevMgt.sysdate}
		)
</insert>

<update id="modProdDvlpConfReq" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_D_PRTNR_PROD_INFO
		SET     MOD_DESC       = #{productDevMgt.modDesc, jdbcType=VARCHAR }
		WHERE   PRTNR_PROD_ID  =  #{productDevMgt.prodCd}
</update>

<update id="modConfReturn" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        UPDATE TPMPD_PROD_CONF_DTL
        SET    CONF_DTTM     = #{productDevMgt.currentDay, jdbcType=VARCHAR }  ,
               CONF_RSLT     = #{productDevMgt.confRslt, jdbcType=VARCHAR }  ,
               CONF_DESC     = #{productDevMgt.confDesc, jdbcType=VARCHAR }  ,
               CHGR_ID       = #{productDevMgt.chgrId, jdbcType=VARCHAR }  ,
               CHG_DATE      = #{productDevMgt.sysdate}
        WHERE  CONF_REQ_CD IN ( select CONF_REQ_CD 
                                from   TPMPD_PROD_CONF_HIST
                                where  prod_cd        = #{productDevMgt.prodCd}
                                and    prod_dvlp_dttm = #{productDevMgt.prodDvlpDttm}
                                and    conf_status    = '2' )
</update>

<select id="getConfCnt" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT SUM( 1 ) AS CONF_REQ_CNT ,
		       SUM(CASE WHEN TPCD.CONF_RSLT = '1' THEN 1 ELSE 0 END) AS CONFR_OK_CNT
		FROM   TPMPD_PROD_CONF_DTL  TPCD
		WHERE  TPCD.CONF_REQ_CD  = #{productDevMgt.confReqCd}
</select>  
     
    
<select id="getProductRelationshipListAll" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
			SELECT TP.PROD_CD ,
			  TP.INACT_DT ,
			  TP.ACT_DT ,
			  TP.PROD_NM ,
			  TP.PROD_ABBR_NM ,
			  TP.PROD_ENG_NM ,
			  TP.PROD_ENG_ABBR_NM ,
			  TP.BASIC_PROD_FL ,
			  TP.USG_RATE_PRI_NO ,
			  TP.PROD_TYP ,
			  (
			    SELECT C.CODE_NM AS COMMON_CD_NM
			    FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
				 ON #{productDevMgt.lngTyp} = C.LNG_TYP
				 AND B.COMMON_GRP = C.COMMON_GRP
				 AND B.COMMON_CD = C.COMMON_CD
			    WHERE B.COMMON_GRP = 'PP00068'
			      AND B.COMMON_CD = TP.PROD_TYP) PROD_TYP_NM,
			  TP.PROD_GRP ,
			  (
			    SELECT C.CODE_NM AS COMMON_CD_NM
			    FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			    ON #{productDevMgt.lngTyp} = C.LNG_TYP
			    AND B.COMMON_GRP = C.COMMON_GRP
			    AND B.COMMON_CD = C.COMMON_CD                
			    WHERE B.COMMON_GRP = 'PP00141'
			      AND B.COMMON_CD = TP.PROD_GRP) PROD_GRP_NM,
			  TP.PROD_LVL ,
			  TP.SVC_GRP ,
			  TP.USE_MM_TYP ,
			  TP.SUBS_FL ,
			  TP.DISP_PRI_NO ,
			  TP.MOD_DESC ,
			  TP.PROD_DESC ,
			  TP.MSTR_FL ,
			  TP.REGR_ID ,
			  TP.REG_DATE ,
			  TP.CHGR_ID ,
			  TP.CHG_DATE,
			  TP.KPI_PROD_GRP_CD
			FROM TPMPD_PROD TP
			WHERE TP.MSTR_FL = '1'
			  AND TP.INACT_DT >= #{productDevMgt.currentDay}
		<if test="productDevMgt.prodNm != null">
		 	AND TP.PROD_NM LIKE  CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
	    </if>	
		<if test="productDevMgt.soId != null">
	    	AND   TP.SO_ID 	     = #{productDevMgt.soId}
	    </if>        
		<if test="productDevMgt.soId == null">
			AND	   TP.SO_ID IN
		<foreach collection="soAuthList" item="item" index="index" open="(" separator="," close=")">
        	#{item.so_id}
        </foreach>
        </if> 	       			  
		ORDER BY PROD_TYP_NM, TP.PROD_NM ASC
</select>     
     
<select id="getProductdefultRelationsList_res"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
				SELECT '0' AS CHK,TDPR.PROD_CD ,
				(
				    SELECT X.BASIC_PROD_FL
				    FROM TPMPD_PROD X
				    WHERE X.PROD_CD = TDPR.PROD_CD
				      AND MSTR_FL = '1' ) AS BASIC_PROD_FL,
			  	TDPR.REL_PROD_CD ,
			  	TDPR.PROD_REL_TYP ,
			  	(
			    SELECT TDP.PROD_NM
			    FROM TPMPD_PROD TDP
			    WHERE TDPR.PROD_CD = TDP.PROD_CD
			      AND TDP.MSTR_FL = '1'
			      AND TDP.INACT_DT >= #{productDevMgt.currentDay}) PROD_NM ,
				  (
				    SELECT B.COMMON_CD_NM
				    FROM TSYCO_CODE_DETAIL B
	                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
				    ON #{productDevMgt.lngTyp} = C.LNG_TYP
				    AND B.COMMON_GRP = C.COMMON_GRP
				    AND B.COMMON_CD = C.COMMON_CD   
				    WHERE B.COMMON_GRP = 'PP00067'
				      AND B.COMMON_CD = TDPR.PROD_REL_TYP ) PROD_REL_TYP_NM ,
				  (
				    SELECT TP.PROD_NM
				    FROM TPMPD_PROD TP
				    WHERE TDPR.REL_PROD_CD = TP.PROD_CD
				      AND TP.MSTR_FL = '1'
				      AND TP.INACT_DT >= #{productDevMgt.currentDay}) REL_PROD_NM ,
				      TDPR.INACT_DT,
                      TDPR.DEF_YN
                    ,TP.SO_ID
                    ,(select SO_NM 
                         from   TSYCO_SO_MAST
                         where  SO_ID = TP.SO_ID
                         and    USE_YN = 'Y') AS SO_NM 
				FROM TPMPD_PROD_REL TDPR
                    ,TPMPD_PROD   TP
                    ,TPMPD_PROD   TX
				WHERE TDPR.INACT_DT >= #{productDevMgt.currentDay}
				  AND TDPR.MSTR_FL = '1'
				  AND TDPR.PROD_CD = #{productDevMgt.prodCd}
                  AND TDPR.REL_PROD_CD = TP.PROD_CD
                  AND TP.SO_ID 	     = #{productDevMgt.soId}
				  AND TX.SO_ID      = #{productDevMgt.soId}
				  AND TX.PROD_CD    =  #{productDevMgt.prodCd}
				  AND TX.INACT_DT   >= #{productDevMgt.currentDay}
				  AND ( 
				  	CASE 
				  		WHEN TX.BASIC_PROD_FL = 'B' AND TDPR.PROD_REL_TYP  IN ( 'C','M') THEN 'U'  
           				WHEN TX.BASIC_PROD_FL IN ( 'V','E')  AND TDPR.PROD_REL_TYP  IN ( 'P','X','B') THEN 'U'
           				WHEN TX.BASIC_PROD_FL = 'P'  THEN 'X' END ) = 'U'  
				ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD

</select>

<select id="getProductdefultRelationsList_req"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
				SELECT '0' AS CHK,TDPR.PROD_CD ,
				(
				    SELECT X.BASIC_PROD_FL
				    FROM TPMPD_PROD X
				    WHERE X.PROD_CD = TDPR.PROD_CD
				      AND MSTR_FL = '1' ) AS BASIC_PROD_FL,
									  TDPR.REL_PROD_CD ,
					  TDPR.PROD_REL_TYP ,
					  (
					    SELECT TDP.PROD_NM
					    FROM TPMPD_PROD TDP
					    WHERE TDPR.PROD_CD = TDP.PROD_CD
					      AND TDP.MSTR_FL = '1'
					      AND TDP.INACT_DT >= #{productDevMgt.currentDay}) PROD_NM ,
					  (
					    SELECT B.COMMON_CD_NM
					    FROM TSYCO_CODE_DETAIL B
		                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
					    ON #{productDevMgt.lngTyp} = C.LNG_TYP
					    AND B.COMMON_GRP = C.COMMON_GRP
					    AND B.COMMON_CD = C.COMMON_CD  
					    WHERE  B.COMMON_GRP = 'PP00067'
					      AND  B.COMMON_CD = TDPR.PROD_REL_TYP ) PROD_REL_TYP_NM ,
					  (
					    SELECT TP.PROD_NM
					    FROM TPMPD_PROD TP
					    WHERE TDPR.REL_PROD_CD = TP.PROD_CD
					      AND TP.MSTR_FL = '1'
					      AND TP.INACT_DT >= #{productDevMgt.currentDay}) REL_PROD_NM ,
					      TDPR.INACT_DT,
                          TDPR.DEF_YN
                    ,TP.SO_ID
                    ,(select SO_NM 
                         from   TSYCO_SO_MAST
                         where  SO_ID = TP.SO_ID
                         and    USE_YN = 'Y') AS SO_NM
					FROM TPMPD_PROD_REL TDPR
                        ,TPMPD_PROD   TP
                        ,TPMPD_PROD   TX
					WHERE TDPR.INACT_DT >= #{productDevMgt.currentDay}
					  AND TDPR.MSTR_FL = '1'
					  AND TDPR.REL_PROD_CD = #{productDevMgt.prodCd}
                      AND TDPR.REL_PROD_CD = TP.PROD_CD
                  	  AND TP.SO_ID 	     = #{productDevMgt.soId}
                  	  
				  AND TX.SO_ID      = #{productDevMgt.soId}
				  AND TX.PROD_CD    =  #{productDevMgt.prodCd}
				  AND TX.INACT_DT   >= #{productDevMgt.currentDay}
				  AND ( 
				  	CASE 
				  		WHEN TX.BASIC_PROD_FL = 'B' AND TDPR.PROD_REL_TYP  IN ( 'C','M','P','S') THEN 'U'  
           				WHEN TX.BASIC_PROD_FL IN ( 'V','E')  AND TDPR.PROD_REL_TYP  IN ( 'X','B') THEN 'U'
           				WHEN TX.BASIC_PROD_FL = 'P'  THEN 'X' END ) = 'U'
           				                  	  
					ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD
</select>     
     
<select id="getProdect"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT
		*
		FROM
		TPMPD_PROD TP
		WHERE TP.MSTR_FL = '1'
		      AND TP.PROD_CD = #{productDevMgt.prodCd}
			  AND TP.INACT_DT >= #{productDevMgt.currentDay}
				<if test="productDevMgt.prodNm != null">
				 AND	TP.PROD_NM LIKE  CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
			    </if>				  
			  AND TP.SO_ID 	     = #{productDevMgt.soId}
</select>  
 
<select id="getProductRelationshipListAll_prod_case_1"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
				SELECT '0' AS CHK,
				TP.PROD_CD ,
			  TP.INACT_DT ,
			  TP.INACT_DT ,
			  TP.PROD_NM ,
			  TP.PROD_ABBR_NM ,
			  TP.PROD_ENG_NM ,
			  TP.PROD_ENG_ABBR_NM ,
			  TP.BASIC_PROD_FL ,
			  TP.USG_RATE_PRI_NO ,
			  TP.PROD_TYP ,
			  (
			    SELECT B.COMMON_CD_NM
				FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			    ON #{productDevMgt.lngTyp} = C.LNG_TYP
			    AND B.COMMON_GRP = C.COMMON_GRP
			    AND B.COMMON_CD = C.COMMON_CD  
			    WHERE  B.COMMON_GRP = 'PP00068'
			      AND  B.COMMON_CD = TP.PROD_TYP) PROD_TYP_NM,
			  TP.PROD_GRP ,
			  (
			    SELECT B.COMMON_CD_NM
				FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			    ON #{productDevMgt.lngTyp} = C.LNG_TYP
			    AND B.COMMON_GRP = C.COMMON_GRP
			    AND B.COMMON_CD = C.COMMON_CD  
			    WHERE  B.COMMON_GRP = 'PP00141'
			      AND  B.COMMON_CD = TP.PROD_GRP) PROD_GRP_NM,
			  TP.PROD_LVL ,
			  TP.SVC_GRP ,
			  TP.USE_MM_TYP ,
			  TP.SUBS_FL ,
			  TP.DISP_PRI_NO ,
			  TP.MOD_DESC ,
			  TP.PROD_DESC ,
			  TP.MSTR_FL ,
			  TP.REGR_ID ,
			  TP.REG_DATE ,
			  TP.CHGR_ID ,
			  TP.CHG_DATE,
			  TP.KPI_PROD_GRP_CD,
              '' AS DEF_YN
			FROM TPMPD_PROD TP
			WHERE TP.MSTR_FL = '1'
			  AND TP.INACT_DT >= #{productDevMgt.currentDay}
			  
			  
			  AND TP.BASIC_PROD_FL IN ( #{productDevMgt.basicProdFl}
			<if test="productDevMgt.basicProdFl_1 != null">
				, #{productDevMgt.basicProdFl_1}
		    </if>			  
			  )
			  AND TP.PROD_CD NOT IN (
							    SELECT TDPR.REL_PROD_CD
							    FROM TPMPD_PROD_REL TDPR
							    WHERE TDPR.INACT_DT >= #{productDevMgt.currentDay}
							      AND TDPR.MSTR_FL = '1'
							      AND TDPR.PROD_CD = #{productDevMgt.prodCd}
							      AND TDPR.PROD_REL_TYP =  #{productDevMgt.prodRelTyp} )
				<if test="productDevMgt.prodNm != null">
				 	TP.PROD_NM LIKE  CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
			    </if>				  
			  AND TP.SO_ID 	     = #{productDevMgt.soId}							      
			ORDER BY PROD_TYP_NM, TP.PROD_NM ASC
</select> 
     
<select id="getProductRelationshipListAll_prod_case_2"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT '0' AS CHK,
    			TP.PROD_CD ,
			  TP.INACT_DT ,
			  TP.ACT_DT ,
			  TP.PROD_NM ,
			  TP.PROD_ABBR_NM ,
			  TP.PROD_ENG_NM ,
			  TP.PROD_ENG_ABBR_NM ,
			  TP.BASIC_PROD_FL ,
			  TP.USG_RATE_PRI_NO ,
			  TP.PROD_TYP ,
			  (
			    SELECT B.COMMON_CD_NM
				FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			    ON #{productDevMgt.lngTyp} = C.LNG_TYP
			    AND B.COMMON_GRP = C.COMMON_GRP
			    AND B.COMMON_CD = C.COMMON_CD  
			    WHERE  B.COMMON_GRP = 'PP00068'
			      AND  B.COMMON_CD = TP.PROD_TYP) PROD_TYP_NM,
			  TP.PROD_GRP ,
			  (
			    SELECT B.COMMON_CD_NM
				FROM TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
			    ON #{productDevMgt.lngTyp} = C.LNG_TYP
			    AND B.COMMON_GRP = C.COMMON_GRP
			    AND B.COMMON_CD = C.COMMON_CD  
			    WHERE  B.COMMON_GRP = 'PP00141'
			      AND  B.COMMON_CD = TP.PROD_GRP) PROD_GRP_NM,
			  TP.PROD_LVL ,
			  TP.SVC_GRP ,
			  TP.USE_MM_TYP ,
			  TP.SUBS_FL ,
			  TP.DISP_PRI_NO ,
			  TP.MOD_DESC ,
			  TP.PROD_DESC ,
			  TP.MSTR_FL ,
			  TP.REGR_ID ,
			  TP.REG_DATE ,
			  TP.CHGR_ID ,
			  TP.CHG_DATE,
			  TP.KPI_PROD_GRP_CD,
              'NA' AS DEF_YN
			FROM TPMPD_PROD TP
			WHERE TP.MSTR_FL = '1'
			  AND TP.INACT_DT >= #{productDevMgt.currentDay}
			  AND TP.BASIC_PROD_FL IN (#{productDevMgt.basicProdFl}
			<if test="productDevMgt.basicProdFl_1 != null">
				, #{productDevMgt.basicProdFl_1}
		    </if>	
			  )
			  AND TP.PROD_CD NOT IN (
							    SELECT TDPR.PROD_CD
							    FROM TPMPD_PROD_REL TDPR
							    WHERE TDPR.INACT_DT >= #{productDevMgt.currentDay}
							      AND TDPR.MSTR_FL = '1'
							      AND TDPR.REL_PROD_CD = #{productDevMgt.prodCd}
							      AND TDPR.PROD_REL_TYP =  #{productDevMgt.prodRelTyp} )
				<if test="productDevMgt.prodNm != null">
				 	TP.PROD_NM LIKE  CONCAT(CONCAT('%', #{productDevMgt.prodNm}), '%')
			    </if>				  
			  AND TP.SO_ID 	     = #{productDevMgt.soId}	
			ORDER BY PROD_TYP_NM, TP.PROD_NM ASC
</select>      
     
<update id="setRelationship_1" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_REL
		SET
		MSTR_FL = 0
		WHERE
		PROD_CD = #{productDevMgt.relProdCd}
		AND PROD_REL_TYP = #{productDevMgt.prodRelTyp}
		AND 	REL_PROD_CD = #{productDevMgt.prodCd}
		AND #{productDevMgt.currentDay} > INACT_DT
		AND SO_ID = #{productDevMgt.soId}
</update>
  
<update id="setRelationship_2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_REL
		SET
		MSTR_FL = 0
		WHERE
		PROD_CD = #{productDevMgt.prodCd}
		AND PROD_REL_TYP = #{productDevMgt.prodRelTyp}
		AND 	REL_PROD_CD = #{productDevMgt.relProdCd}
		AND #{productDevMgt.currentDay} > INACT_DT
		AND SO_ID = #{productDevMgt.soId}		
</update> 
  
<update id="setProductRelationship_prod_case_1" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_REL
		(
			PROD_CD                      ,
			PROD_REL_TYP                 ,
			REL_PROD_CD                  ,
			INACT_DT                   ,
			ACT_DT                    ,
			MSTR_FL                      ,
			REGR_ID                 ,
			REG_DATE               ,
			CHGR_ID                   ,
			CHG_DATE                     ,
            DEF_YN,
            SO_ID
		)
		VALUES
		(
			#{productDevMgt.relProdCd, jdbcType=VARCHAR } ,
			#{productDevMgt.prodRelTyp, jdbcType=VARCHAR } ,
			#{productDevMgt.prodCd, jdbcType=VARCHAR } ,
			#{productDevMgt.inactDt, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR},
			#{productDevMgt.mstrFl, jdbcType=VARCHAR },
			#{productDevMgt.regrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate},
			#{productDevMgt.chgrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate},
            #{productDevMgt.defYn, jdbcType=VARCHAR },
            #{productDevMgt.soId, jdbcType=VARCHAR }
		)
</update>

<update id="setProductRelationship_prod_case_2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_REL
		(
			PROD_CD                      ,
			PROD_REL_TYP                 ,
			REL_PROD_CD                  ,
			INACT_DT                   ,
			ACT_DT                    ,
			MSTR_FL                      ,
			REGR_ID                      ,
			REG_DATE                     ,
			CHGR_ID                      ,
			CHG_DATE                     ,
            DEF_YN,
            SO_ID
		)
		VALUES
		(
			#{productDevMgt.prodCd, jdbcType=VARCHAR } ,
			#{productDevMgt.prodRelTyp, jdbcType=VARCHAR } ,
			#{productDevMgt.relProdCd, jdbcType=VARCHAR } ,
			#{productDevMgt.inactDt, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR},
			#{productDevMgt.mstrFl, jdbcType=VARCHAR },
			#{productDevMgt.regrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate},
			#{productDevMgt.chgrId, jdbcType=VARCHAR },
			#{productDevMgt.sysdate},
            #{productDevMgt.defYn, jdbcType=VARCHAR },
            #{productDevMgt.soId, jdbcType=VARCHAR }
		)
</update>
  
<update id="setProductCancel" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_REL
		SET
		INACT_DT = #{productDevMgt.inactDtChg, jdbcType=VARCHAR }
		WHERE
			PROD_CD = #{productDevMgt.prodCd}
		AND PROD_REL_TYP = #{productDevMgt.prodRelTyp}
		AND 	REL_PROD_CD = #{productDevMgt.relProdCd}
		AND MSTR_FL = '1'
</update>

<update id="setProductCancel_1" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_PROD_REL
		SET
		INACT_DT = #{productDevMgt.inactDtChg, jdbcType=VARCHAR }
		WHERE
			PROD_CD = #{productDevMgt.prodCd}
		AND PROD_REL_TYP = #{productDevMgt.prodRelTyp}
		AND 	REL_PROD_CD = #{productDevMgt.relProdCd}
		AND MSTR_FL = '1'
</update>


<insert id="addTransferProduct" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD
		(
		    SELECT PROD_CD           ,
		           INACT_DT        ,
		           SO_ID             ,
		           #{productDevMgt.transferApplyDt}     ,
		           PROD_NM           ,
		           PROD_ABBR_NM      ,
		           PROD_ENG_NM       ,
		           PROD_ENG_ABBR_NM  ,
		           BASIC_PROD_FL     ,
		           USG_RATE_PRI_NO   ,
		           PROD_TYP          ,
		           PROD_GRP          ,
		           PROD_LVL          ,
		           SVC_GRP           ,
		           USE_MM_TYP        ,
		           SUBS_FL           ,
		           CRR_ID            ,
		           DISP_PRI_NO       ,
		           MOD_DESC          ,
		           PROD_DESC         ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId}    ,
					<choose>                          
						<when test="'${dbms.kind}' == 'ORACLE'">                       
				      		CHG_DATE = SYSDATE ,
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
				        	CHG_DATE = NOW(),
						</when>
					</choose>
		           #{productDevMgt.chgrId}      ,
					<choose>                          
						<when test="'${dbms.kind}' == 'ORACLE'">                       
				      		CHG_DATE = SYSDATE, 
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
				        	CHG_DATE = NOW(),
						</when>
					</choose>
		           KPI_PROD_GRP_CD,
                   MNO_PROD_CD,
                   MNO_UNIT_SVC_CD
		    FROM   TPMPD_D_PROD
		    WHERE  PROD_CD = #{productDevMgt.prodCd}			    
		)
</insert>

<select id="getTransProdRel"  resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT 
            COUNT( PROD_CD ) AS DATA_CNT
        FROM TPMPD_D_PROD_REL  
        WHERE  PROD_CD = #{productDevMgt.prodCd}
</select>

<insert id="addTransProdRel" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_REL
		(
		    SELECT #{productDevMgt.soId},
		    	   PROD_CD              ,
		           PROD_REL_TYP         ,
		           REL_PROD_CD          ,
		           INACT_DT           ,
		           #{productDevMgt.transferApplyDt}  ,
		           MSTR_FL              ,
                   DEF_YN		,		           
		           #{productDevMgt.regrId}            ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE, 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}            ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>         
		    FROM   TPMPD_D_PROD_REL
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>

<insert id="addTransferProductSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_SUBSCRIP_COND
		(
		    SELECT  #{productDevMgt.soId},
		    		PROD_CD               ,
		           COND_NO               ,
		           INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,
		           FCTR_CD               ,
		           COND_OPERATOR         ,
		           OPRND_REF_FL          ,
		           OPRND_1               ,
		           OPRND_FCTR_CD_1       ,
		           OPRND_2               ,
		           OPRND_FCTR_CD_2       ,
		           MSTR_FL               ,
		           #{productDevMgt.regrId}        ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}          ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>
		    FROM   TPMPD_D_PROD_SUBSCRIP_COND
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>

<insert id="addTransferProductAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_ATTR
		(
		    SELECT #{productDevMgt.soId},
		    		PROD_CD           ,
		    		INACT_DT        ,
		           #{productDevMgt.transferApplyDt}     ,		    		
		           ATTR_CD           ,
		           ATTR_VAL          ,
		           MSTR_FL           ,
		           '',
		           #{productDevMgt.regrId}    ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE, 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}      ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>
		    FROM   TPMPD_D_PROD_ATTR
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>
<insert id="addTransferProductService" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_SVC
		(
		    SELECT #{productDevMgt.soId},
		    		PROD_CD           ,
		           SVC_CD            ,
		           INACT_DT        ,
		           #{productDevMgt.transferApplyDt}     ,
		           SUBSCRIP_CMPS_FL  ,
		           OPT_SVC_CMPS_FL   ,
		           MULTI_CMPS_FL     ,
		           CMPS_QTY_FROM     ,
		           CMPS_QTY_TO       ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE ,
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
		           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>		
		    FROM   TPMPD_D_PROD_SVC
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
	)
</insert>
<insert id="addTransferProductService2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_SVC
		(
		    SELECT #{productDevMgt.soId},
		    		PROD_CD           ,
		           SVC_CD            ,
		           INACT_DT        ,
		           #{productDevMgt.transferApplyDt}     ,
		           SUBSCRIP_CMPS_FL  ,
		           OPT_SVC_CMPS_FL   ,
		           MULTI_CMPS_FL     ,
		           CMPS_QTY_FROM     ,
		           CMPS_QTY_TO       ,
		           MSTR_FL           ,
		           #{productDevMgt.regrId}    ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE, 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}      ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>		
		    FROM   TPMPD_D_PROD_SVC
		    WHERE  PROD_CD = #{productDevMgt.prodCd}
		    AND SVC_CD = #{productDevMgt.svcCd}
	)
</insert>

<insert id="addTransferProdSuprtGift" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_PROD_SUPRT_GIFT
		(
		  SELECT #{productDevMgt.soId},
		  			PROD_CD               ,
		         GIFT_ID               ,
		         REL_PROD_CD	,
		         INACT_DT            ,
		         #{productDevMgt.transferApplyDt}   ,
		         MSTR_FL               ,
	           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE, 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
	           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>		
		  FROM   TPMPD_D_PROD_SUPRT_GIFT
		  WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>

<select id="getTransferSuprtEquip"  resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    SELECT 
        COUNT( PROD_CD ) AS DATA_CNT
    FROM TPMPD_D_SUPRT_EQUIP  
    WHERE  PROD_CD = #{productDevMgt.prodCd}

</select>

<insert id="addTransferSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    INSERT INTO TPMPD_SUPRT_EQUIP
    (
		    PROD_CD          ,
		    EQT_CL_CD        ,
		    INACT_DT       ,
		    ACT_DT        ,
		    SBJ_PROD_CD      ,
		    SVC_CD           ,
		    CMPS_QTY_FROM    ,
		    CMPS_QTY_TO      ,
		    MSTR_FL          ,
		    REGR_ID     ,
		    REG_DATE   ,
		    CHGR_ID       ,
		    CHG_DATE     ,
		    DISP_PRI_NO
	)
    (
        SELECT PROD_CD              ,
               EQT_CL_CD            ,
               INACT_DT           ,
               #{productDevMgt.transferApplyDt}  ,
               SBJ_PROD_CD          ,
               SVC_CD               ,
               CMPS_QTY_FROM        ,
               CMPS_QTY_TO          ,
               MSTR_FL              ,
	           #{productDevMgt.regrId}    ,
	           #{productDevMgt.sysdate}           ,
	           #{productDevMgt.chgrId}      ,
	           #{productDevMgt.sysdate}	,
               DISP_PRI_NO
        FROM   TPMPD_D_SUPRT_EQUIP
        WHERE  PROD_CD = #{productDevMgt.prodCd}
    )
</insert>

<select id="getTransferRateItem"  resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT 
            COUNT( PROD_CD ) AS DATA_CNT
        FROM TPMPD_D_RATE_ITM  
        WHERE  PROD_CD = #{productDevMgt.prodCd}
</select>
<insert id="addTransferRateItem" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM
		(
			SELECT #{productDevMgt.soId}           ,
				   RATE_ITM_CD           ,
			       INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,
			       RATE_ITM_NM           ,
			       RATE_ITM_ABBR_NM      ,
			       RATE_ITM_ENG_NM       ,
			       PROD_CD               ,
			       SVC_CD                ,
			       SVC_RATE_ITM_TYP_CD   ,
			       CHRG_CTGRY            ,
			       RATE_LOCAT            ,
			       RATE_REF_TYP          ,
			       DEFLT_RATE_ITM_CD     ,
			       RATE_PRI_NO           ,
			       DISP_PRI_NO           ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE ,
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
		           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
			FROM   TPMPD_D_RATE_ITM
			WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>
<insert id="addTransferRateItem2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM
		(
			SELECT #{productDevMgt.soId}           ,
				   RATE_ITM_CD           ,
			       INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,
			       RATE_ITM_NM           ,
			       RATE_ITM_ABBR_NM      ,
			       RATE_ITM_ENG_NM       ,
			       PROD_CD               ,
			       SVC_CD                ,
			       SVC_RATE_ITM_TYP_CD   ,
			       CHRG_CTGRY            ,
			       RATE_LOCAT            ,
			       RATE_REF_TYP          ,
			       DEFLT_RATE_ITM_CD     ,
			       RATE_PRI_NO           ,
			       DISP_PRI_NO           ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}      ,
					<choose>                          
						<when test="'${dbms.kind}' == 'ORACLE'">                       
				      		CHG_DATE = SYSDATE 
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
				        	CHG_DATE = NOW()
						</when>
					</choose>
			FROM   TPMPD_D_RATE_ITM
			WHERE  PROD_CD = #{productDevMgt.prodCd}
			AND RATE_ITM_CD = #{productDevMgt.rateItmCd}
		)
</insert>
<insert id="addTransferRateItemAttribute" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_ATTR
		(
			SELECT  #{productDevMgt.soId},
					RATE_ITM_CD           ,
			       ATTR_CD               ,
			       INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,
			       ATTR_VAL              ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE ,
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}      ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>
			FROM   TPMPD_D_RATE_ITM_ATTR
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_D_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                  )
		)
</insert>

<insert id="addTransferRateItemAttribute2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_ATTR
		(
			SELECT  #{productDevMgt.soId},
					RATE_ITM_CD           ,
			       ATTR_CD               ,
			       INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,
			       ATTR_VAL              ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE, 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
		           #{productDevMgt.chgrId}      ,
					<choose>                          
						<when test="'${dbms.kind}' == 'ORACLE'">                       
				      		CHG_DATE = SYSDATE 
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
				        	CHG_DATE = NOW()
						</when>
					</choose>
			FROM   TPMPD_D_RATE_ITM_ATTR
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd} 
                AND ATTR_CD =      #{productDevMgt.attrCd}             
		)
</insert>
<insert id="addTransferRateItemFactor" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_FCTR
		(
			SELECT  #{productDevMgt.soId},
			       RATE_ITM_CD       ,
				   FCTR_CD           ,
				   INACT_DT        ,
		           #{productDevMgt.transferApplyDt}     ,
				   FCTR_NO           ,
				   RATE_INFO_EXE_FL  ,
		       	   MSTR_FL           ,           
				   FCTR_REF_TYP      ,
			       TABLE_ID          ,
				   COLMN_ID          ,
			       DATA_TYP          ,
				   REF_CD            ,
            	   REF_FUNC,
          		   CHG_NULL_FL,
          		   CHG_NULL_VAL,
		           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE, 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
		           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
			FROM   TPMPD_D_RATE_ITM_FCTR
			WHERE  RATE_ITM_CD IN (
                                     SELECT RATE_ITM_CD
                                     FROM   TPMPD_D_RATE_ITM
                                     WHERE  PROD_CD = #{productDevMgt.prodCd}
                                  )
		)
</insert>
<insert id="addTransferRateItemFactor2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_FCTR
		(
			SELECT  #{productDevMgt.soId},
			       RATE_ITM_CD       ,
				   FCTR_CD           ,
				   INACT_DT        ,
		           #{productDevMgt.transferApplyDt}     ,
				   FCTR_NO           ,
				   RATE_INFO_EXE_FL  ,
		       	   MSTR_FL           ,           
				   FCTR_REF_TYP      ,
			       TABLE_ID          ,
				   COLMN_ID          ,
			       DATA_TYP          ,
				   REF_CD            ,
            	   REF_FUNC,
          		   CHG_NULL_FL,
          		   CHG_NULL_VAL,
		           #{productDevMgt.regrId}    ,
		           #{productDevMgt.sysdate}           ,
		           #{productDevMgt.chgrId}      ,
		           #{productDevMgt.sysdate}	
			FROM   TPMPD_D_RATE_ITM_FCTR
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND FCTR_CD = #{productDevMgt.fctrCd}
		)
</insert>

<insert id="addTransferDiscSvcRateItmTyp2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_DISC_SVC_RATE_ITM_TYP
		(
			SELECT #{productDevMgt.soId},
			       INACT_DT            ,     
		           #{productDevMgt.transferApplyDt}   ,             
			 	   RATE_ITM_CD           ,
			       SVC_RATE_ITM_TYP_CD   ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         #{productDevMgt.sysdate}	,
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
                          NOW(),
                        </when>
        			</choose>  
		           #{productDevMgt.chgrId}      ,
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         #{productDevMgt.sysdate}	
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
                          NOW()
                        </when>
        			</choose>  	
			FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND SVC_RATE_ITM_TYP_CD      = #{productDevMgt.svcRateItmTypCd}
                                 
		)

</insert>

<insert id="addTransferDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_DISC_SVC_RATE_ITM_TYP
		(
			SELECT #{productDevMgt.soId},
			       INACT_DT            ,     
		           #{productDevMgt.transferApplyDt}   ,             
			 	   RATE_ITM_CD           ,
			       SVC_RATE_ITM_TYP_CD   ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         #{productDevMgt.sysdate}	,
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
                          NOW(),
                        </when>
        			</choose>  
		           #{productDevMgt.chgrId}      ,
        			<choose>                          
   						<when test="'${dbms.kind}' == 'ORACLE'">                       
                         #{productDevMgt.sysdate}	
						</when>                          
						<when test="'${dbms.kind}' == 'MYSQL'">                         
                          NOW()
                        </when>
        			</choose>  	
			FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP
			WHERE  RATE_ITM_CD IN (
                                    SELECT RATE_ITM_CD
                                    FROM   TPMPD_D_RATE_ITM
                                    WHERE  PROD_CD = #{productDevMgt.prodCd}
                                  )
		)

</insert>

<insert id="addTransferRateItemCondition" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_COND
		(
			SELECT #{productDevMgt.soId},
					RATE_ITM_CD      ,
				   COND_NO          ,
				   INACT_DT       ,
		           #{productDevMgt.transferApplyDt}     ,
				   FCTR_CD          ,
				   COND_OPERATOR    ,
				   OPRND_REF_FL     ,
				   OPRND_1          ,
				   OPRND_FCTR_CD_1  ,
				   OPRND_2          ,
				   OPRND_FCTR_CD_2  ,
			       MSTR_FL          ,
		           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE ,
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
		           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
			FROM   TPMPD_D_RATE_ITM_COND
			WHERE  RATE_ITM_CD IN (
                                    SELECT RATE_ITM_CD
                                    FROM   TPMPD_D_RATE_ITM
                                    WHERE  PROD_CD = #{productDevMgt.prodCd}
                                  )
		)
</insert>
<insert id="addTransferRateItemCondition2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE_ITM_COND
		(
			SELECT #{productDevMgt.soId},
					RATE_ITM_CD      ,
				   COND_NO          ,
				   INACT_DT       ,
		           #{productDevMgt.transferApplyDt}     ,
				   FCTR_CD          ,
				   COND_OPERATOR    ,
				   OPRND_REF_FL     ,
				   OPRND_1          ,
				   OPRND_FCTR_CD_1  ,
				   OPRND_2          ,
				   OPRND_FCTR_CD_2  ,
			       MSTR_FL          ,
		           #{productDevMgt.regrId}    ,
		           #{productDevMgt.sysdate}           ,
		           #{productDevMgt.chgrId}      ,
		           #{productDevMgt.sysdate}	
			FROM   TPMPD_D_RATE_ITM_COND
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
			AND COND_NO = #{productDevMgt.condNo}
                                 
		)
</insert>
<insert id="addTransferRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE
		(
		    SELECT #{productDevMgt.soId},
		           RATE_ITM_CD           ,
		           INACT_DT            ,
		            #{productDevMgt.transferApplyDt}   ,		           
		           FCTR_VAL1             ,
		           FCTR_VAL2             ,
		           FCTR_VAL3             ,
		           FCTR_VAL4             ,
		           FCTR_VAL5             ,
		           FCTR_VAL6             ,
		           FCTR_VAL7             ,
		           FCTR_VAL8             ,
		           FCTR_VAL9             ,
		           RATE_REF_FL           ,
		           RATE_VAL              ,
		           RATE_FCTR_CD          ,
		           DIVI_RATE_AMT         ,
		           QTY_REF_FL            ,
		           QTY                   ,
		           QTY_FCTR_CD           ,
		           CRNCY_REF_FL          ,
		           CRNCY_CD              ,
		           CRNCY_FCTR_CD         ,
		           ALWNCE_CD             ,
		           MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
		           #{productDevMgt.chgrId}      ,		           
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE ,
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
		    FROM   TPMPD_D_RATE
		    WHERE  RATE_ITM_CD IN (
		                          SELECT RATE_ITM_CD
		                          FROM   TPMPD_D_RATE_ITM
		                          WHERE  PROD_CD = #{productDevMgt.prodCd}
		                          )
		)
</insert>
<insert id="addTransferRate2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_RATE
		(
		    SELECT #{productDevMgt.soId},
		           RATE_ITM_CD           ,
		           INACT_DT            ,
		            #{productDevMgt.transferApplyDt}   ,		           
		           FCTR_VAL1             ,
		           FCTR_VAL2             ,
		           FCTR_VAL3             ,
		           FCTR_VAL4             ,
		           FCTR_VAL5             ,
		           FCTR_VAL6             ,
		           FCTR_VAL7             ,
		           FCTR_VAL8             ,
		           FCTR_VAL9             ,
		           RATE_REF_FL           ,
		           RATE_VAL              ,
		           RATE_FCTR_CD          ,
		           DIVI_RATE_AMT         ,
		           QTY_REF_FL            ,
		           QTY                   ,
		           QTY_FCTR_CD           ,
		           CRNCY_REF_FL          ,
		           CRNCY_CD              ,
		           CRNCY_FCTR_CD         ,
		           ALWNCE_CD             ,
		           MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
		           #{productDevMgt.chgrId}      ,		           
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE, 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW(),
					</when>
				</choose>
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>
		    FROM   TPMPD_D_RATE
		    WHERE  RATE_ITM_CD =  #{productDevMgt.rateItmCd}
			AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
			AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
			AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
			AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
			AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
			AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
			AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
			AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
			AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
		)
</insert>

<insert id="addTransferDiscExcl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_DISC_EXCL
		(
			SELECT 
					#{productDevMgt.soId},
			       INACT_DT            ,
		           #{productDevMgt.transferApplyDt}   ,		       			
					RATE_ITM_CD           ,
			       SVC_RATE_ITM_TYP_CD   ,
			       MSTR_FL               ,
		           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE, 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
		           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
			FROM   TPMPD_D_DISC_EXCL
			WHERE  RATE_ITM_CD IN (
                                SELECT RATE_ITM_CD
                                FROM   TPMPD_D_RATE_ITM
                                WHERE  PROD_CD = #{productDevMgt.prodCd}
                                  )
		)
</insert>

<insert id="addTransferDiscPeriod" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_DISC_PERD
		(
		  SELECT #{productDevMgt.soId},
		  			RATE_ITM_CD           ,
		         INACT_DT            ,
		         #{productDevMgt.transferApplyDt}   ,
		         OPERATOR              ,
		         OPRND_REF_FL_1        ,
		         OPRND_1               ,
		         OPRND_FCTR_CD_1       ,
		         OPRND_REF_FL_2        ,
		         OPRND_2               ,
		         OPRND_FCTR_CD_2       ,
		         MSTR_FL               ,
	           #{productDevMgt.regrId}    ,
		<choose>                          
			<when test="'${dbms.kind}' == 'ORACLE'">                       
	      		CHG_DATE = SYSDATE ,
			</when>                          
			<when test="'${dbms.kind}' == 'MYSQL'">                         
	        	CHG_DATE = NOW(),
			</when>
		</choose>
	           #{productDevMgt.chgrId}      ,
		<choose>                          
			<when test="'${dbms.kind}' == 'ORACLE'">                       
	      		CHG_DATE = SYSDATE 
			</when>                          
			<when test="'${dbms.kind}' == 'MYSQL'">                         
	        	CHG_DATE = NOW()
			</when>
		</choose>
		  FROM   TPMPD_D_DISC_PERD
		  WHERE  RATE_ITM_CD IN (
		                         SELECT RATE_ITM_CD
		                         FROM   TPMPD_D_RATE_ITM
		                         WHERE  PROD_CD = #{productDevMgt.prodCd}
		                         )
		)

</insert>

<insert id="addTransferAllowance" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_ALWNCE
		(
		  SELECT ALWNCE_CD              ,
		         INACT_DT             ,
		         #{productDevMgt.transferApplyDt}    ,
		         ALWNCE_NM              ,
		         PROD_CD                ,
		         ALWNCE_TYP             ,
		         ALWNCE_APPL_LVL        ,
		         ALWNCE_UNT             ,
		         ALWNCE_AMT_SBJ         ,
		         ALWNCE_APPL_UOM        ,
		         ALWNCE_AMT_TYP         ,
		         PRORATE_TYP            ,
		         REGT_ALWNCE_AMT        ,
		         ALWNCE_AMNT            ,
		         ROLLOVR_FL             ,
		         ROLLOVR_CNT            ,
		         THRS_NOTI_MTHD_REF_FL  ,
		         THRS_NOTI_MTHD         ,
		         THRS_UOM               ,
		         THRS1                  ,
		         THRS2                  ,
		         THRS3                  ,
		         MSTR_FL                ,
	           #{productDevMgt.regrId}    ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE ,
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW(),
				</when>
			</choose>
	           #{productDevMgt.chgrId}      ,
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
		  FROM   TPMPD_D_ALWNCE
		  WHERE  PROD_CD = #{productDevMgt.prodCd}
		)
</insert>

<delete id="delProdConfDtl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_PROD_CONF_DTL
		WHERE  CONF_REQ_CD = #{productDevMgt.confReqCd}
		<if test="productDevMgt.confrCd != null">
    		AND    CONFR_CD    = #{productDevMgt.confrCd} 
    	</if>	 
		
</delete>

<delete id="delProdConfHist" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		DELETE
		FROM   TPMPD_PROD_CONF_HIST
		WHERE  CONF_REQ_CD = #{productDevMgt.confReqCd} 
</delete>

<select id="getProdDvlpStatus"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  MAX(TPDH.DVLP_STATUS) AS DVLP_STATUS
	    FROM    TPMPD_PROD_DVLP_HIST TPDH
	    WHERE   TPDH.PROD_CD  =  #{productDevMgt.prodCd}
	    AND     TPDH.DVLP_STATUS NOT IN ('5','6')
</select>

<select id="getModProductServiceInit"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TDPS.INACT_DT        ,
		        TDPS.ACT_DT         ,
		        TDPS.SUBSCRIP_CMPS_FL  ,
		        TDPS.ESS_FL            ,
		        TDPS.OPT_SVC_CMPS_FL   ,
		        TDPS.MULTI_CMPS_FL     ,
		        TDPS.CMPS_QTY_FROM     ,
		        TDPS.CMPS_QTY_TO       ,
		        TDPS.MSTR_FL           ,
		        TDPS.REGR_ID      ,
		        TDPS.REG_DATE    ,
		        TDPS.CHGR_ID        ,
		        TDPS.CHG_DATE      ,
		        TDPS.PROD_CD           ,
		        TDPS.SVC_CD				,
		        TDPS.KPI_SVC_GRP_CD
		FROM    TPMPD_D_PROD_SVC TDPS
		WHERE   TDPS.PROD_CD  = #{productDevMgt.prodCd}
		AND     TDPS.SVC_CD   = #{productDevMgt.svcCd}
</select>

<select id="getDiscExclListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_D_DISC_EXCL TDDE,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT,
		        TPMSV_SVC TS,
		        TPMPD_D_RATE_ITM TDRI
		WHERE   TDDE.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TSRIT.SVC_CD             = TS.SVC_CD
		AND     TSRIT.MSTR_FL            = '1'
		AND     TS.MSTR_FL               = '1'
		AND     TDRI.MSTR_FL             = '1'
		AND     TDDE.RATE_ITM_CD         =  #{productDevMgt.rateItmCd}
		AND     TDDE.RATE_ITM_CD         = TDRI.RATE_ITM_CD
		AND     TDRI.CHRG_CTGRY IN ('A', 'M', 'D')
		ORDER BY TDDE.CHG_DATE DESC
</select>

<select id="getDiscExclListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_DISC_EXCL TDDE,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT,
		        TPMSV_SVC TS,
		        TPMPD_RATE_ITM TDRI
		WHERE   TDDE.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TSRIT.SVC_CD             = TS.SVC_CD
		AND     TSRIT.MSTR_FL            = '1'
		AND     TS.MSTR_FL               = '1'
		AND     TDRI.MSTR_FL             = '1'
		AND     TDDE.MSTR_FL             = '1'   		
		AND     TDDE.RATE_ITM_CD         =  #{productDevMgt.rateItmCd}
		AND     TDDE.RATE_ITM_CD         = TDRI.RATE_ITM_CD
		AND     TDRI.CHRG_CTGRY IN ('A', 'M', 'D')
		AND     TDDE.INACT_DT > #{productDevMgt.currentDay}
		ORDER BY TDDE.CHG_DATE DESC
</select>

<select id="getDiscExclList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
		SELECT  TDDE.RATE_ITM_CD,
		        TDDE.SVC_RATE_ITM_TYP_CD,
		        TS.SVC_NM,
		        TS.SVC_CD,
		        TSRIT.SVC_RATE_ITM_TYP_NM,
		        TDRI.CHRG_CTGRY,
		        TDRI.RATE_PRI_NO,
		        (
		          SELECT TS_IN.SVC_NM
		          FROM   TPMSV_SVC TS_IN
		          WHERE  TS_IN.SVC_CD = TS.MAIN_SVC_CD
		        ) MAIN_SVC_NM
		FROM    TPMPD_D_DISC_EXCL TDDE,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT,
		        TPMSV_SVC TS,
		        TPMPD_D_RATE_ITM TDRI
		WHERE   TDDE.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TSRIT.SVC_CD             = TS.SVC_CD
		AND     TSRIT.MSTR_FL            = '1'
		AND     TS.MSTR_FL               = '1'
		AND     TDRI.MSTR_FL             = '1'
		AND     TDDE.RATE_ITM_CD         =  #{productDevMgt.rateItmCd}
		AND     TDDE.RATE_ITM_CD         = TDRI.RATE_ITM_CD
		AND     TDRI.CHRG_CTGRY IN ('A', 'M', 'D')
		ORDER BY TDDE.CHG_DATE DESC

	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getDiscExclList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
		SELECT  TDDE.RATE_ITM_CD,
		        TDDE.SVC_RATE_ITM_TYP_CD,
		        TS.SVC_NM,
		        TS.SVC_CD,
		        TSRIT.SVC_RATE_ITM_TYP_NM,
		        TDRI.CHRG_CTGRY,
		        TDRI.RATE_PRI_NO,
		        (
		          SELECT TS_IN.SVC_NM
		          FROM   TPMSV_SVC TS_IN
		          WHERE  TS_IN.SVC_CD = TS.MAIN_SVC_CD
		        ) MAIN_SVC_NM,
	            TDDE.INACT_DT,
	            TDDE.ACT_DT
		FROM    TPMPD_DISC_EXCL TDDE,
		        TPMPD_SVC_RATE_ITM_TYP TSRIT,
		        TPMSV_SVC TS,
		        TPMPD_RATE_ITM TDRI
		WHERE   TDDE.SVC_RATE_ITM_TYP_CD = TSRIT.SVC_RATE_ITM_TYP_CD
		AND     TSRIT.SVC_CD             = TS.SVC_CD
		AND     TSRIT.MSTR_FL            = '1'
		AND     TS.MSTR_FL               = '1'
		AND     TDRI.MSTR_FL             = '1'
		AND     TDDE.MSTR_FL             = '1'   		
		AND     TDDE.RATE_ITM_CD         =  #{productDevMgt.rateItmCd}
		AND     TDDE.RATE_ITM_CD         = TDRI.RATE_ITM_CD
		AND     TDRI.CHRG_CTGRY IN ('A', 'M', 'D')
		AND     TDDE.INACT_DT &gt; #{productDevMgt.currentDay}
		ORDER BY TDDE.CHG_DATE DESC

	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getAddDiscExclInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TSRIT.SVC_RATE_ITM_TYP_CD,
		        TSRIT.SVC_RATE_ITM_TYP_NM,
		        (
                  SELECT SVC_NM
                  FROM   TPMSV_SVC TS_IN
                  WHERE  TS_IN.SVC_CD = TS.MAIN_SVC_CD
		 		  AND    TS_IN.MSTR_FL = '1'
                ) MAIN_SVC_NM,
                TS.SVC_NM
		FROM    TPMPD_SVC_RATE_ITM_TYP  TSRIT,
		        TPMSV_SVC               TS
		WHERE   TSRIT.INACT_DT >= #{productDevMgt.currentDay}
		AND     TSRIT.CHRG_CTGRY IN ('A', 'D', 'M')
		AND     TSRIT.RATE_PRI_NO  &lt;= (SELECT RATE_PRI_NO
		                                  FROM   TPMPD_D_RATE_ITM
		                                  WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd})
		AND     TSRIT.SVC_RATE_ITM_TYP_CD NOT IN (
		                                            SELECT SVC_RATE_ITM_TYP_CD
		                                            FROM   TPMPD_D_DISC_EXCL
		                                            WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		                                          )
		AND     TSRIT.SVC_CD   = TS.SVC_CD
		AND     TSRIT.SVC_CD IN (
                                 SELECT  TS.SVC_CD
                                 FROM    TPMSV_SVC TS
                                 WHERE   TS.MAIN_SVC_CD = (SELECT TS1.MAIN_SVC_CD
                                                           FROM   TPMSV_SVC TS1
                                                           WHERE  TS1.SVC_CD = ( SELECT SVC_CD
                                                                                 FROM   TPMPD_D_RATE_ITM
                                                                                 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd})
                                                          )
                                )
		AND     TS.INACT_DT >= #{productDevMgt.currentDay}
</select>

<insert id="addDiscExcl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_EXCL
		(
		    RATE_ITM_CD           ,
		    SVC_RATE_ITM_TYP_CD   ,
		    INACT_DT            ,
		    ACT_DT             ,
		    MSTR_FL               ,
		    REGR_ID          ,
		    REG_DATE        ,
		    CHGR_ID            ,
		    CHG_DATE
		)
		VALUES
		(
		    #{productDevMgt.rateItmCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcRateItmTypCd, jdbcType=VARCHAR },
		    #{productDevMgt.inactDt, jdbcType=VARCHAR },    
		    #{productDevMgt.currentDay, jdbcType=VARCHAR},
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		    #{productDevMgt.regrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate}
		)
</insert>

<select id="getDiscSvcRateItmTypListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_D_DISC_SVC_RT_ITM_TYP TDDSRIT
		WHERE   TDDSRIT.RATE_ITM_CD = #{productDevMgt.rateItmCd}
</select>

<select id="getDiscSvcRateItmTypListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  COUNT(*)
		FROM    TPMPD_DISC_SVC_RATE_ITM_TYP TDDSRIT
		WHERE   TDDSRIT.RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND TDDSRIT.MSTR_FL = '1'
</select>

<select id="getDiscSvcRateItmTypList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
		SELECT  TDDSRIT.RATE_ITM_CD                    ,
		        TDDSRIT.SVC_RATE_ITM_TYP_CD            ,
		        (SELECT TSRIT.SVC_RATE_ITM_TYP_NM
		         FROM   TPMPD_SVC_RATE_ITM_TYP  TSRIT
		         WHERE  TSRIT.SVC_RATE_ITM_TYP_CD = TDDSRIT.SVC_RATE_ITM_TYP_CD
		         AND    TSRIT.MSTR_FL  = '1'   ) SVC_RATE_ITM_TYP_NM
		FROM    TPMPD_D_DISC_SVC_RT_ITM_TYP TDDSRIT
		WHERE   TDDSRIT.RATE_ITM_CD = #{productDevMgt.rateItmCd}
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getDiscSvcRateItmTypList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
		SELECT  TDDSRIT.RATE_ITM_CD                    ,
		        TDDSRIT.SVC_RATE_ITM_TYP_CD            ,
		        (SELECT TSRIT.SVC_RATE_ITM_TYP_NM
		         FROM   TPMPD_SVC_RATE_ITM_TYP  TSRIT
		         WHERE  TSRIT.SVC_RATE_ITM_TYP_CD = TDDSRIT.SVC_RATE_ITM_TYP_CD
		         AND    TSRIT.MSTR_FL  = '1'   ) SVC_RATE_ITM_TYP_NM,
	             TDDSRIT.INACT_DT,
	             TDDSRIT.ACT_DT
		FROM    TPMPD_DISC_SVC_RATE_ITM_TYP TDDSRIT
		WHERE   TDDSRIT.RATE_ITM_CD = #{productDevMgt.rateItmCd}
		AND TDDSRIT.MSTR_FL = '1'
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getAddDiscSvcRateItmTypInit" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TSRIT.SVC_RATE_ITM_TYP_CD,
		        TSRIT.SVC_RATE_ITM_TYP_NM
		FROM    TPMPD_SVC_RATE_ITM_TYP  TSRIT
		WHERE   TSRIT.INACT_DT >= #{productDevMgt.currentDay}
		AND     TSRIT.CHRG_CTGRY IN ('N', 'R', 'U')
		AND     TSRIT.SVC_RATE_ITM_TYP_CD
					NOT IN (
                              SELECT SVC_RATE_ITM_TYP_CD
                              FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP
                              WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
                            )
       AND     TSRIT.SVC_CD IN (
                                 SELECT  TS.SVC_CD
                                 FROM    TPMSV_SVC TS
                                 WHERE   TS.MAIN_SVC_CD = (SELECT TS1.MAIN_SVC_CD
                                                           FROM   TPMSV_SVC TS1
                                                           WHERE  TS1.SVC_CD = ( SELECT SVC_CD
                                                                                 FROM   TPMPD_D_RATE_ITM
                                                                                 WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd})
                                                          )
                                )
</select>

<insert id="addDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_SVC_RT_ITM_TYP
		(
		    RATE_ITM_CD           ,
		    SVC_RATE_ITM_TYP_CD   ,
		    INACT_DT            ,
		    ACT_DT             ,
		    MSTR_FL               ,
		    REGR_ID          ,
		    REG_DATE        ,
		    CHGR_ID            ,
		    CHG_DATE
		)
		VALUES
		(
		    #{productDevMgt.rateItmCd, jdbcType=VARCHAR },
		    #{productDevMgt.svcRateItmTypCd, jdbcType=VARCHAR },
		    #{productDevMgt.inactDt, jdbcType=VARCHAR },    
		    #{productDevMgt.currentDay, jdbcType=VARCHAR},
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		    #{productDevMgt.regrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate}
		)    
</insert>

<select id="getDiscPerdListCount" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT  COUNT(*)
        FROM    TPMPD_D_DISC_PERD TDDP
        WHERE   TDDP.MSTR_FL     = '1'
        AND     TDDP.RATE_ITM_CD = #{productDevMgt.rateItmCd}
        ORDER BY TDDP.CHG_DATE DESC
</select>

<select id="getDiscPerdListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        SELECT  COUNT(*)
        FROM    TPMPD_DISC_PERD TDDP
        WHERE   TDDP.MSTR_FL     = '1'
        AND     TDDP.RATE_ITM_CD = #{productDevMgt.rateItmCd}
        ORDER BY TDDP.CHG_DATE DESC
</select>

<select id="getDiscPerdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
        SELECT  TDDP.RATE_ITM_CD,
               (
                   SELECT C.CODE_NM AS COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00016'
                   AND    B.COMMON_CD   = TDDP.OPERATOR
               )  OPERATOR_NM,
               (
                   SELECT C.CODE_NM AS COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00059'
                   AND    B.COMMON_CD   = TDDP.OPRND_REF_FL_1
               )  OPRND_REF_FL_1_NM,
               TDDP.OPRND_1,
               (
                   SELECT TF_1.FCTR_NM
                   FROM   TPMBI_FCTR TF_1
                   WHERE  TDDP.OPRND_FCTR_CD_1 =TF_1.FCTR_CD
                   AND    TF_1.MSTR_FL     = '1'
                   AND    TF_1.INACT_DT >= #{productDevMgt.currentDay}
               ) OPRND_FCTR_CD_1_NM,
               (
                   SELECT C.CODE_NM AS COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00059'
                   AND    B.COMMON_CD   = TDDP.OPRND_REF_FL_2
               )  OPRND_REF_FL_2_NM,
               TDDP.OPRND_2 ,
               (
                   SELECT TF_2.FCTR_NM
                   FROM   TPMBI_FCTR TF_2
                   WHERE  TDDP.OPRND_FCTR_CD_2 =TF_2.FCTR_CD
                   AND    TF_2.MSTR_FL     = '1'
                   AND    TF_2.INACT_DT >= #{productDevMgt.currentDay}
               ) OPRND_FCTR_CD_2_NM
        FROM    TPMPD_D_DISC_PERD TDDP
        WHERE   TDDP.MSTR_FL     = '1'
        AND     TDDP.RATE_ITM_CD = #{productDevMgt.rateItmCd}
        ORDER BY TDDP.CHG_DATE DESC
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getDiscPerdList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>
        SELECT  TDDP.RATE_ITM_CD,
               (
                   SELECT B.COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	               LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00016'
                   AND    B.COMMON_CD   = TDDP.OPERATOR
               )  OPERATOR_NM,
               (
                   SELECT B.COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00059'
                   AND    B.COMMON_CD   = TDDP.OPRND_REF_FL_1
               )  OPRND_REF_FL_1_NM,
               TDDP.OPRND_1,
               (
                   SELECT TF_1.FCTR_NM
                   FROM   TPMBI_FCTR TF_1
                   WHERE  TDDP.OPRND_FCTR_CD_1 =TF_1.FCTR_CD
                   AND    TF_1.MSTR_FL     = '1'
                   AND    TF_1.INACT_DT >= #{productDevMgt.currentDay}
               ) OPRND_FCTR_CD_1_NM,
               (
                   SELECT B.COMMON_CD_NM
                   FROM   TSYCO_CODE_DETAIL B
	                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                 ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                 AND B.COMMON_GRP = C.COMMON_GRP
	                 AND B.COMMON_CD = C.COMMON_CD
                   WHERE  B.COMMON_GRP  = 'PP00059'
                   AND    B.COMMON_CD   = TDDP.OPRND_REF_FL_2
               )  OPRND_REF_FL_2_NM,
               TDDP.OPRND_2 ,
               (
                   SELECT TF_2.FCTR_NM
                   FROM   TPMBI_FCTR TF_2
                   WHERE  TDDP.OPRND_FCTR_CD_2 =TF_2.FCTR_CD
                   AND    TF_2.MSTR_FL     = '1'
                   AND    TF_2.INACT_DT >= #{productDevMgt.currentDay}
               ) OPRND_FCTR_CD_2_NM,
               TDDP.INACT_DT,
        		TDDP.ACT_DT
        FROM    TPMPD_DISC_PERD TDDP
        WHERE   TDDP.MSTR_FL     = '1'
        AND     TDDP.RATE_ITM_CD = #{productDevMgt.rateItmCd}
        ORDER BY TDDP.CHG_DATE DESC
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>		
</select>	

<select id="getOprndFctrCd" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	    SELECT '[]' AS FCTR_CD,
	           'SEL' AS FCTR_NM,
	           NULL  AS REF_CD,
	           NULL  AS REF_TABLE_ID,
		       NULL  AS REF_COLMN_ID,
		       NULL  AS REF_COLMN_NM,
		       NULL  AS REF_TABLE_COND
	    FROM DUAL
	    UNION ALL		
		SELECT A.FCTR_CD,
		       B.FCTR_NM,
		       A.REF_CD,
	           A.REF_TABLE_ID,
		       A.REF_COLMN_ID,
		       A.REF_COLMN_NM,
		       A.REF_TABLE_COND		       
		FROM   TPMPD_D_RATE_ITM_FCTR A,
		       TPMBI_FCTR B
		WHERE  A.RATE_ITM_CD = #{productDevMgt.rateItmCd}
	    AND    A.FCTR_CD = B.FCTR_CD
		AND    B.MSTR_FL = '1'
		AND    B.INACT_DT > #{productDevMgt.currentDay}
</select>

<insert id="addDiscPerd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		INSERT INTO TPMPD_D_DISC_PERD
		(
			RATE_ITM_CD      ,
			INACT_DT       ,
			ACT_DT        ,
			OPERATOR         ,
			OPRND_REF_FL_1   ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_REF_FL_2   ,
			OPRND_2          ,
			OPRND_FCTR_CD_2  ,
			MSTR_FL          ,
			REGR_ID     ,
			REG_DATE   ,
			CHGR_ID       ,
			CHG_DATE
		)
		VALUES
		(
			#{productDevMgt.rateItmCd, jdbcType=VARCHAR },
			#{productDevMgt.inactDt, jdbcType=VARCHAR },
			#{productDevMgt.currentDay, jdbcType=VARCHAR},
			#{productDevMgt.operator, jdbcType=VARCHAR },   
			#{productDevMgt.oprndRefFl1, jdbcType=VARCHAR },
			#{productDevMgt.oprnd1, jdbcType=VARCHAR }, 
			#{productDevMgt.oprndFctrCd1, jdbcType=VARCHAR },    
			#{productDevMgt.oprndRefFl2, jdbcType=VARCHAR },
			#{productDevMgt.oprnd2, jdbcType=VARCHAR }, 
			#{productDevMgt.oprndFctrCd2, jdbcType=VARCHAR },  
		    #{productDevMgt.mstrFl, jdbcType=VARCHAR },
		    #{productDevMgt.regrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate},
		    #{productDevMgt.chgrId, jdbcType=VARCHAR },
		    #{productDevMgt.sysdate}
		)		   
</insert>

<delete id="delDiscPerd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
        DELETE
        FROM   TPMPD_D_DISC_PERD
        <if test='productDevMgt.delFl.equals("PROD_DELETE")'>
        WHERE  RATE_ITM_CD IN (
                               SELECT RATE_ITM_CD
                               FROM TPMPD_D_RATE_ITM
                               WHERE PROD_CD = #{productDevMgt.prodCd}
                              )        
        </if>

		<if test='productDevMgt.delFl.equals("SERVICE_DELETE")'>
			WHERE RATE_ITM_CD IN (
			                 SELECT TDRI.RATE_ITM_CD
			                 FROM   TPMPD_D_PROD_SVC TDRS,
			                        TPMPD_D_RATE_ITM TDRI
			                 WHERE  TDRS.PROD_CD = #{productDevMgt.prodCd}
			                 AND    TDRS.SVC_CD IN (
			                               SELECT SVC_CD
			                               FROM   TPMSV_SVC WHERE SVC_CD = #{productDevMgt.svcCd}
			                                        )
			                 AND    TDRS.SVC_CD = TDRI.SVC_CD
			                       )		
		</if>

		<if test='productDevMgt.delFl.equals("RATE_ITM_DELETE")'>
			WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
		</if>
</delete>

<select id="getDiscPerd" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT TDDP.RATE_ITM_CD     ,
		       TDDP.INACT_DT      ,
		       TDDP.OPERATOR        ,
		       TDDP.OPRND_REF_FL_1  ,
		       TDDP.OPRND_1         ,
		       TDDP.OPRND_FCTR_CD_1 ,
		       TDDP.OPRND_REF_FL_2  ,
		       TDDP.OPRND_2         ,
		       TDDP.OPRND_FCTR_CD_2 ,
		       TDDP.CHGR_ID
		FROM   TPMPD_D_DISC_PERD TDDP
		WHERE  TDDP.MSTR_FL      = '1'
		AND    TDDP.RATE_ITM_CD      = #{productDevMgt.rateItmCd}

</select>

<insert id="modDiscPerd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_D_DISC_PERD
		SET    INACT_DT       =  #{productDevMgt.inactDt, jdbcType=VARCHAR },
		       OPERATOR         =  #{productDevMgt.operator, jdbcType=VARCHAR },
		       OPRND_REF_FL_1   =  #{productDevMgt.oprndRefFl1, jdbcType=VARCHAR },
		       OPRND_1          =  #{productDevMgt.oprnd1, jdbcType=VARCHAR }, 
		       OPRND_FCTR_CD_1  =  #{productDevMgt.oprndFctrCd1, jdbcType=VARCHAR },    
		       OPRND_REF_FL_2   =  #{productDevMgt.oprndRefFl2, jdbcType=VARCHAR },
		       OPRND_2          =  #{productDevMgt.oprnd2, jdbcType=VARCHAR }, 
		       OPRND_FCTR_CD_2  =  #{productDevMgt.oprndFctrCd2, jdbcType=VARCHAR },  
		       ACT_DT        =  #{productDevMgt.currentDay, jdbcType=VARCHAR},
		       CHGR_ID       =  #{productDevMgt.chgrId, jdbcType=VARCHAR },
		       CHG_DATE     =  #{productDevMgt.sysdate}
		WHERE  RATE_ITM_CD = #{productDevMgt.rateItmCd}
	   
</insert>


<select id="getTransProdOper" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT ACT_DT
		FROM   TPMPD_PROD
		WHERE  PROD_CD = #{productDevMgt.prodCd}
		AND    MSTR_FL      = '1'
		<if test="productDevMgt.soId != null">
	    AND SO_ID = #{productDevMgt.soId}
	    </if>
</select>

<update id="modTransProd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">

	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
		 	UPDATE TPMPD_PROD
			SET  ( INACT_DT        ,
			       ACT_DT         ,
			       PROD_NM           ,
			       PROD_ABBR_NM      ,
			       PROD_ENG_NM       ,
			       PROD_ENG_ABBR_NM  ,
			       BASIC_PROD_FL     ,
			       USG_RATE_PRI_NO   ,
			       PROD_LVL          ,
			       SVC_GRP           ,
			       USE_MM_TYP        ,
			       SUBS_FL           ,
			       CRR_ID            ,
			       DISP_PRI_NO       ,
			       MOD_DESC          ,
			       PROD_DESC         ,
			       CHGR_ID        ,
			       CHG_DATE     ,
			       KPI_PROD_GRP_CD ) =
			    (
			    SELECT INACT_DT        ,
		                    ACT_DT         ,
		                    PROD_NM           ,
		                    PROD_ABBR_NM      ,
		                    PROD_ENG_NM       ,
		                    PROD_ENG_ABBR_NM  ,
		                    BASIC_PROD_FL     ,
		                    USG_RATE_PRI_NO   ,
		                    PROD_LVL          ,
		                    SVC_GRP           ,
		                    USE_MM_TYP        ,
		                    SUBS_FL           ,
		                    CRR_ID            ,
		                    DISP_PRI_NO       ,
		                    MOD_DESC          ,
		                    PROD_DESC         ,
		                    #{productDevMgt.chgrId}      ,
		                    #{productDevMgt.sysdate}				,
		                    KPI_PROD_GRP_CD
		             FROM  TPMPD_D_PROD
		             WHERE PROD_CD = #{productDevMgt.prodCd}
				    <if test="productDevMgt.soId != null">
				  AND SO_ID = #{productDevMgt.soId}
				    </if>
		             )
			WHERE PROD_CD = #{productDevMgt.prodCd}
			AND   MSTR_FL     = '1'
		    <if test="productDevMgt.soId != null">
		  AND SO_ID = #{productDevMgt.soId}
		    </if>     
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
		UPDATE TPMPD_PROD A JOIN (
	    	SELECT INACT_DT        ,
                    ACT_DT         ,
                    PROD_NM           ,
                    PROD_ABBR_NM      ,
                    PROD_ENG_NM       ,
                    PROD_ENG_ABBR_NM  ,
                    BASIC_PROD_FL     ,
                    USG_RATE_PRI_NO   ,
                    PROD_LVL          ,
                    SVC_GRP           ,
                    USE_MM_TYP        ,
                    SUBS_FL           ,
                    CRR_ID            ,
                    DISP_PRI_NO       ,
                    MOD_DESC          ,
                    PROD_DESC         ,
                    #{productDevMgt.chgrId}   AS CHGR_ID   ,
                    #{productDevMgt.sysdate}	AS CHG_DATE			,
                    KPI_PROD_GRP_CD
             FROM  TPMPD_D_PROD
             WHERE PROD_CD = #{productDevMgt.prodCd}
             
		    <if test="productDevMgt.soId != null">
		  	AND SO_ID = #{productDevMgt.soId}
		    </if>   
             )AS B
             ON A.PROD_CD = #{productDevMgt.prodCd} 
		    
		    <if test="productDevMgt.soId != null">
		  	 AND A.SO_ID = #{productDevMgt.soId}
		    </if>                
             
             AND A.MSTR_FL = '1'
			 SET  
			   A.INACT_DT  = B.INACT_DT      ,
			   A.ACT_DT  = A.ACT_DT        ,
		       A.PROD_NM  =   A.PROD_NM        ,
		       A.PROD_ABBR_NM  = A.PROD_ABBR_NM    ,
		       A.PROD_ENG_NM =    A.PROD_ENG_NM   ,
		       A.PROD_ENG_ABBR_NM = A.PROD_ENG_ABBR_NM,
		       A.BASIC_PROD_FL  = A.BASIC_PROD_FL  ,
		       A.USG_RATE_PRI_NO = A.USG_RATE_PRI_NO ,
		       A.PROD_LVL =  A.PROD_LVL  ,
		       A.SVC_GRP  = A.SVC_GRP         ,
		       A.USE_MM_TYP = A.USE_MM_TYP      ,
		       A.SUBS_FL   = A.SUBS_FL        ,
		       A.CRR_ID   =  A.CRR_ID       ,
		       A.DISP_PRI_NO =  A.DISP_PRI_NO    ,
		       A.MOD_DESC   = A.MOD_DESC        ,
		       A.PROD_DESC   = A.PROD_DESC       ,
		       A.CHGR_ID   = A.CHGR_ID    ,
		       A.CHG_DATE  = A.CHG_DATE  ,
		       A.KPI_PROD_GRP_CD = A.KPI_PROD_GRP_CD    
    	</when>
	</choose>  
    
</update>

<update id="modTransProdExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       MSTR_FL      = '0' ,
	       CHGR_ID   =  #{productDevMgt.chgrId, jdbcType=VARCHAR }      ,
		<choose>                          
			<when test="'${dbms.kind}' == 'ORACLE'">                       
	      		CHG_DATE = SYSDATE 
			</when>                          
			<when test="'${dbms.kind}' == 'MYSQL'">                         
	        	CHG_DATE = NOW()
			</when>
		</choose>
    WHERE  PROD_CD = #{productDevMgt.prodCd}
	AND    MSTR_FL      = '1'
    <if test="productDevMgt.soId != null">
  AND SO_ID = #{productDevMgt.soId}
    </if>
</update>

<update id="modTransUpdDelProdRel" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_REL TPR
	SET    INACT_DT      =  #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       CHGR_ID      =  #{productDevMgt.chgrId, jdbcType=VARCHAR },
	       CHG_DATE    =  #{productDevMgt.sysdate}
	WHERE  TPR.MSTR_FL     =  '1'
	AND    TPR.PROD_CD     =  #{productDevMgt.prodCd}
	AND    TPR.INACT_DT  =  '99991231'
	AND    NOT EXISTS
	       ( SELECT 1
	         FROM   TPMPD_D_PROD_REL TDPR
	         WHERE  TDPR.PROD_CD      = TPR.PROD_CD
	         AND    TDPR.PROD_REL_TYP = TPR.PROD_REL_TYP
	         AND    TDPR.REL_PROD_CD  = TPR.REL_PROD_CD
	         AND    TDPR.INACT_DT   = TPR.INACT_DT   )
</update>

<select id="getTransProdRelDvlpList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  PROD_CD                      ,
		    PROD_REL_TYP                 ,
		    REL_PROD_CD                  ,
		    INACT_DT                   ,
		    ACT_DT                    ,
		    MSTR_FL                      ,
		    REGR_ID                 ,
		    REG_DATE               ,
		    CHGR_ID                   ,
		    CHG_DATE
	FROM    TPMPD_D_PROD_REL
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	<!-- AND     CHG_DATE != '20010101'  -->
</select>

<select id="getTransDualListProdRel" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT PROD_CD
	FROM   TPMPD_PROD_REL
	WHERE  PROD_CD      = #{productDevMgt.prodCd}
	AND    PROD_REL_TYP = #{productDevMgt.prodRelTyp}
	AND    REL_PROD_CD  = #{productDevMgt.relProdCd}
	AND    MSTR_FL = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<update id="modTransProdRelMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_PROD_REL
	SET     MSTR_FL      = '0' ,
	        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	        CHG_DATE = #{productDevMgt.sysdate}
	WHERE   PROD_CD      = #{productDevMgt.prodCd}
	AND     PROD_REL_TYP = #{productDevMgt.prodRelTyp}
	AND     REL_PROD_CD  = #{productDevMgt.relProdCd}
	AND     MSTR_FL       = '1'
	AND     INACT_DT &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelProdSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SUBSCRIP_COND TPSC
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	       CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TPSC.MSTR_FL     = '1'
	AND    TPSC.PROD_CD     = #{productDevMgt.prodCd}
	AND    TPSC.INACT_DT  = '99991231'
	AND    NOT EXISTS
	       ( SELECT 1
	         FROM   TPMPD_D_PROD_SUBSCRIP_COND TDPSC
	         WHERE  TDPSC.PROD_CD     = TPSC.PROD_CD
	         AND    TDPSC.COND_NO     = TPSC.COND_NO
	         AND    TDPSC.INACT_DT  = TPSC.INACT_DT   )
</update>

<select id="getTransProdSubscripCondList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  PROD_CD          ,
	        COND_NO          ,
	        INACT_DT       ,
	        ACT_DT        ,
	        FCTR_CD          ,
	        COND_OPERATOR    ,
	        OPRND_REF_FL     ,
	        OPRND_1          ,
	        OPRND_FCTR_CD_1  ,
	        OPRND_2          ,
	        OPRND_FCTR_CD_2  ,
	        MSTR_FL          ,
	        REGR_ID     ,
	        REG_DATE   ,
	        CHGR_ID       ,
	        CHG_DATE
	FROM    TPMPD_D_PROD_SUBSCRIP_COND
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	<!--  AND     CHG_DATE != '20010101'-->
</select>
	
<select id="getTransDualListProdSubscrip" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT PROD_CD
	FROM   TPMPD_PROD_SUBSCRIP_COND
	WHERE  PROD_CD      = #{productDevMgt.prodCd}
	AND    COND_NO      = #{productDevMgt.condNo}
	AND    MSTR_FL = '1'
</select>

<select id="getTransProdSubscripCondComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  FCTR_CD          ,
	        COND_OPERATOR    ,
	        OPRND_REF_FL     ,
	        OPRND_1          ,
	        OPRND_FCTR_CD_1  ,
	        OPRND_2          ,
	        OPRND_FCTR_CD_2
	FROM    ${productDevMgt.tableId}
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	AND     COND_NO   =  #{productDevMgt.condNo}
	AND     MSTR_FL   =  '1'
</select>

<update id="modTransProdSubscripCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SUBSCRIP_COND TPSC
	SET    ( INACT_DT            ,
	         ACT_DT             ,
	         FCTR_CD               ,
	         COND_OPERATOR         ,
	         OPRND_REF_FL          ,
	         OPRND_1               ,
	         OPRND_FCTR_CD_1       ,
	         OPRND_2               ,
	         OPRND_FCTR_CD_2       ,
	         MSTR_FL               ,
	         CHGR_ID            ,
	         CHG_DATE            ) =
	       ( SELECT INACT_DT            ,
	                ACT_DT             ,
	                FCTR_CD               ,
	                COND_OPERATOR         ,
	                OPRND_REF_FL          ,
	                OPRND_1               ,
	                OPRND_FCTR_CD_1       ,
	                OPRND_2               ,
	                OPRND_FCTR_CD_2       ,
	                MSTR_FL               ,
	                #{productDevMgt.chgrId},
	                #{productDevMgt.sysdate}
	         FROM   TPMPD_D_PROD_SUBSCRIP_COND TDPSC
	         WHERE  TDPSC.PROD_CD = TPSC.PROD_CD
	         AND    TPDSC.COND_NO = TPSC.COND_NO)
	WHERE   TPSC.PROD_CD  = #{productDevMgt.prodCd}
	AND     TPSC.COND_NO  = #{productDevMgt.condNo}
	AND     TPSC.MSTR_FL  = '1'
</update>
	
<update id="modTransProdSubscripCondExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SUBSCRIP_COND
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       MSTR_FL      = '0',
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
    WHERE  PROD_CD      = #{productDevMgt.prodCd}
    AND    COND_NO      = #{productDevMgt.condNo}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransUpdDelProdAttr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_ATTR TPA
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	       CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TPA.MSTR_FL     = '1'
	AND    TPA.PROD_CD     = #{productDevMgt.prodCd}
	AND    TPA.INACT_DT  = '99991231'
	AND    NOT EXISTS
	       ( SELECT 1
	         FROM   TPMPD_D_PROD_ATTR TDPA
	         WHERE  TDPA.PROD_CD     = TPA.PROD_CD
	         AND    TDPA.ATTR_CD     = TPA.ATTR_CD
	         AND    TDPA.INACT_DT  = TPA.INACT_DT   )
</update>

<select id="getTransProdAttrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  PROD_CD          ,
	        ATTR_CD          ,
	        INACT_DT       ,
	        ACT_DT        ,
	        ATTR_VAL         ,
	        MSTR_FL          ,
	        REGR_ID     ,
	        REG_DATE   ,
	        CHGR_ID       ,
	        CHG_DATE
	FROM    TPMPD_D_PROD_ATTR
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListProdAttr" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT PROD_CD
	FROM   TPMPD_PROD_ATTR
	WHERE  PROD_CD      = #{productDevMgt.prodCd}
	AND    ATTR_CD      = #{productDevMgt.attrCd}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransProdAttrComp"  resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  ATTR_VAL
	FROM    ${productDevMgt.tableId}
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	AND     ATTR_CD   =  #{productDevMgt.attrCd}
	AND     MSTR_FL   =  '1'
</select>
		
<update id="modTransProdAttr"  parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">

	<choose>                          
  		<when test="'${dbms.kind}' == 'ORACLE'">                       
			UPDATE TPMPD_PROD_ATTR TPA
			SET    ( INACT_DT            ,
			         ACT_DT             ,
			         ATTR_VAL              ,
			         MSTR_FL               ,
			         CHGR_ID            ,
			         CHG_DATE            ) =
			       ( SELECT INACT_DT            ,
			                EFFECT_DT             ,
			                ATTR_VAL              ,
			                MSTR_FL               ,
			                #{productDevMgt.chgrId}          ,
			                SYSDATE
			         FROM   TPMPD_D_PROD_ATTR TDPA
			         WHERE  TDPA.PROD_CD = TPA.PROD_CD
			         AND    TDPA.ATTR_CD = TPA.ATTR_CD)
			WHERE   TPA.PROD_CD  = #{productDevMgt.prodCd}
			AND     TPA.ATTR_CD  = #{productDevMgt.attrCd}
			AND     TPA.MSTR_FL  = '1'       
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			UPDATE TPMPD_PROD_ATTR TPA JOIN
			( 
			  SELECT 
			    INACT_DT            ,
			    ACT_DT             ,
			    ATTR_VAL              ,
			    MSTR_FL               ,
			    #{productDevMgt.chgrId} AS CHGR_ID         ,
			    NOW() AS CHG_DATE
			  FROM   TPMPD_D_PROD_ATTR TDPA
			  WHERE  TDPA.PROD_CD = #{productDevMgt.prodCd}
			  AND    TDPA.ATTR_CD = #{productDevMgt.attrCd}
			) AS B
			ON TPA.PROD_CD  = #{productDevMgt.prodCd}
			AND TPA.ATTR_CD  = #{productDevMgt.attrCd}
			AND TPA.MSTR_FL  = '1'
			SET    
			  TPA.INACT_DT  = B.INACT_DT          ,
			  TPA.ACT_DT   = B.ACT_DT         ,
			  TPA.ATTR_VAL = B.ATTR_VAL            ,
			  TPA.MSTR_FL = B.MSTR_FL             ,
			  TPA.CHGR_ID = B.CHGR_ID          ,
			  TPA.CHG_DATE  = B.CHG_DATE          
		</when>
	</choose> 
</update>

<update id="modTransProdAttrMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_PROD_ATTR
	SET     MSTR_FL      = '0' ,
	        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE   PROD_CD      = #{productDevMgt.prodCd}
	AND     ATTR_CD      = #{productDevMgt.attrCd}
	AND     MSTR_FL      = '1'
	AND     INACT_DT &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelProdSvc" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SVC TPS
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  TPS.MSTR_FL     = '1'
	AND    TPS.PROD_CD     = #{productDevMgt.prodCd}
	AND    TPS.INACT_DT  = '99991231'
	<!-- AND    NOT EXISTS
	AND   EXISTS 	
	       ( SELECT 1
	         FROM   TPMPD_D_PROD_SVC TDPS
	         WHERE  TDPS.PROD_CD     = TPS.PROD_CD
	         AND    TDPS.SVC_CD     = TPS.SVC_CD
	         AND    TDPS.INACT_DT  = TPS.INACT_DT   ) -->
</update>

<select id="getTransProdSvcList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  PROD_CD          ,
	        SVC_CD           ,
	        INACT_DT       ,
	        ACT_DT        ,
	        SUBSCRIP_CMPS_FL ,
	        ESS_FL           ,
	        OPT_SVC_CMPS_FL  ,
	        MULTI_CMPS_FL    ,
	        CMPS_QTY_FROM    ,
	        CMPS_QTY_TO      ,
	        MSTR_FL          ,
	        REGR_ID     ,
	        REG_DATE   ,
	        CHGR_ID       ,
	        CHG_DATE
	FROM    TPMPD_D_PROD_SVC
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	<!--  AND     CHG_DATE != '20010101'-->
</select>	

<select id="getTransDualListProdSvc" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT PROD_CD
	FROM   TPMPD_PROD_SVC
	WHERE  PROD_CD      = #{productDevMgt.prodCd}
	AND    SVC_CD       = #{productDevMgt.svcCd}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransProdSvcComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  SUBSCRIP_CMPS_FL  ,
	        OPT_SVC_CMPS_FL   ,
	        MULTI_CMPS_FL     ,
	        CMPS_QTY_FROM     ,
	        CMPS_QTY_TO
	FROM     ${productDevMgt.tableId}
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	AND     SVC_CD    =  #{productDevMgt.svcCd}
	AND     MSTR_FL   =  '1'
</select>

<update id="modTransProdSvc" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
		  	UPDATE TPMPD_PROD_SVC TPS
			SET    ( INACT_DT            ,
			         ACT_DT             ,
			         SUBSCRIP_CMPS_FL      ,
			         ESS_FL                ,
			         OPT_SVC_CMPS_FL       ,
			         MULTI_CMPS_FL         ,
			         CMPS_QTY_FROM         ,
			         CMPS_QTY_TO           ,
			         MSTR_FL               ,
			         CHGR_ID            ,
			         CHG_DATE            ) =
			       ( SELECT INACT_DT        ,
			                ACT_DT         ,
			                SUBSCRIP_CMPS_FL  ,
			                ESS_FL            ,
			                OPT_SVC_CMPS_FL   ,
			                MULTI_CMPS_FL     ,
			                CMPS_QTY_FROM     ,
			                CMPS_QTY_TO       ,
			                MSTR_FL           ,
			                #{productDevMgt.chgrId},
	                         SYSDATE         
			         FROM   TPMPD_D_PROD_SVC TDPS
			         WHERE  TDPS.PROD_CD = TPS.PROD_CD
			         AND    TDPS.SVC_CD  = TPS.SVC_CD)
			WHERE   TPS.PROD_CD  = #{productDevMgt.prodCd}
			AND     TPS.SVC_CD   = #{productDevMgt.svcCd}
			AND     TPS.MSTR_FL  = '1'
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			 UPDATE TPMPD_PROD_SVC TPS JOIN
			( 
			  SELECT 
			    INACT_DT        ,
			    ACT_DT         ,
			    SUBSCRIP_CMPS_FL  ,
			    OPT_SVC_CMPS_FL   ,
			    MULTI_CMPS_FL     ,
			    CMPS_QTY_FROM     ,
			    CMPS_QTY_TO       ,
			    MSTR_FL           ,
			    #{productDevMgt.chgrId} AS CHGR_ID,
			    NOW() AS  CHG_DATE   
			  FROM   TPMPD_D_PROD_SVC TDPS
			  WHERE  TDPS.PROD_CD = #{productDevMgt.prodCd}
			  AND    TDPS.SVC_CD  = #{productDevMgt.svcCd}) AS B
			ON   TPS.PROD_CD  = #{productDevMgt.prodCd}
			AND     TPS.SVC_CD   = #{productDevMgt.svcCd}
			AND     TPS.MSTR_FL  = '1' 
			SET
			  TPS.INACT_DT = B.INACT_DT,
			  TPS.ACT_DT = B.ACT_DT ,
			  TPS.SUBSCRIP_CMPS_FL = B.SUBSCRIP_CMPS_FL ,
			  TPS.OPT_SVC_CMPS_FL = B.OPT_SVC_CMPS_FL ,
			  TPS.MULTI_CMPS_FL = B.MULTI_CMPS_FL ,
			  TPS.CMPS_QTY_FROM = B.CMPS_QTY_FROM ,
			  TPS.CMPS_QTY_TO = B.CMPS_QTY_TO ,
			  TPS.MSTR_FL = B.MSTR_FL,
			  TPS.CHGR_ID = B.CHGR_ID           ,
			  TPS.CHG_DATE = B.CHG_DATE       
		</when>
	</choose> 

</update>

<update id="modTransProdSvcExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SVC
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       MSTR_FL      = '0',
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
    WHERE  PROD_CD      = #{productDevMgt.prodCd}
    AND    SVC_CD       = #{productDevMgt.svcCd}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransProdSvcMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_PROD_SVC
	SET     MSTR_FL      = '0' ,
	        CHGR_ID   =  #{productDevMgt.chgrId, jdbcType=VARCHAR },
	        CHG_DATE = #{productDevMgt.sysdate}
	WHERE   PROD_CD       = #{productDevMgt.prodCd}
	AND     SVC_CD        = #{productDevMgt.svcCd}
	AND     MSTR_FL       = '1'
	AND     INACT_DT &lt; #{productDevMgt.transferApplyDt}
</update>	

  <update id="modTransUpdDelProdSuprtGift" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_PROD_SUPRT_GIFT TDE
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	       CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TDE.MSTR_FL     = '1'
	AND    TDE.PROD_CD     =  #{productDevMgt.prodCd}
	AND    TDE.INACT_DT  = '99991231'
	AND    NOT EXISTS
	       ( SELECT 1
	         FROM   TPMPD_D_PROD_SUPRT_GIFT TDPSG
	         WHERE  TDPSG.PROD_CD      = TDE.PROD_CD
	         AND    TDPSG.GIFT_ID      = TDE.GIFT_ID
	         AND    TDPSG.INACT_DT   = TDE.INACT_DT   )
  </update>

<select id="getTransProdSuprtGiftDvlpList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  PROD_CD                      ,
	        GIFT_ID                      ,
	        INACT_DT                   ,
	        ACT_DT                    ,
	        MSTR_FL                      ,
	        REGR_ID                 ,
	        REG_DATE               ,
	        CHGR_ID                   ,
	        CHG_DATE
	FROM    TPMPD_D_PROD_SUPRT_GIFT
	WHERE   PROD_CD  = #{productDevMgt.prodCd}
	<!-- AND     CHG_DATE != '20010101' -->
</select>

 <select id="getTransDualListProdSuprtGift" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT PROD_CD
		FROM   TPMPD_PROD_SUPRT_GIFT
		WHERE  PROD_CD      = #{productDevMgt.prodCd}
		AND    GIFT_ID      =  #{productDevMgt.giftId}
		AND    MSTR_FL      =  '1'
		AND    EXPIRAT_DT   > #TRANSFER_APPLY_DT#
 </select>

	<update id="modTransProdSuprtGiftMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_PROD_SUPRT_GIFT
		SET     MSTR_FL      = '0' ,
		        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
			<choose>                          
				<when test="'${dbms.kind}' == 'ORACLE'">                       
		      		CHG_DATE = SYSDATE 
				</when>                          
				<when test="'${dbms.kind}' == 'MYSQL'">                         
		        	CHG_DATE = NOW()
				</when>
			</choose>
		WHERE   PROD_CD      = #{productDevMgt.prodCd}
		AND     GIFT_ID      = #{productDevMgt.giftId}
		AND     MSTR_FL      = '1'
		AND     EXPIRAT_DT &lt; #{productDevMgt.transferApplyDt}
	</update>
	
  <update id="modTransUpdDelSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    UPDATE TPMPD_SUPRT_EQUIP TSE
    SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
           CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
           CHG_DATE = #{productDevMgt.sysdate}
    WHERE  TSE.MSTR_FL     = '1'
    AND    TSE.PROD_CD     = #{productDevMgt.prodCd}
    AND    TSE.INACT_DT  = '99991231'
    AND    NOT EXISTS
           ( SELECT 1
             FROM   TPMPD_D_SUPRT_EQUIP TDSE
             WHERE  TDSE.PROD_CD     = TSE.PROD_CD
             AND    TDSE.EQT_CL_CD   = TSE.EQT_CL_CD
             AND    TDSE.INACT_DT  = TSE.INACT_DT   )
  </update>	
	
    <select id="getTransSuprtEquipList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    SELECT  PROD_CD          ,
            EQT_CL_CD        ,
            INACT_DT       ,
            ACT_DT        ,
            SBJ_PROD_CD      ,
            SVC_CD           ,
            CMPS_QTY_FROM    ,
            CMPS_QTY_TO      ,
            MSTR_FL          ,
            REGR_ID     ,
            REG_DATE   ,
            CHGR_ID       ,
            CHG_DATE     ,
            DISP_PRI_NO
    FROM    TPMPD_D_SUPRT_EQUIP
    WHERE   PROD_CD   =  #{productDevMgt.prodCd}
    <!--  AND     CHG_DATE != '20010101'-->
  </select>	
	
  <select id="getTransDualListSuprtEquip" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    SELECT PROD_CD
    FROM   TPMPD_SUPRT_EQUIP
    WHERE  PROD_CD      = #{productDevMgt.prodCd}
    AND    EQT_CL_CD    = #{productDevMgt.eqtClCd}
    AND    MSTR_FL      = '1'
  </select>
  
  <select id="getTransSuprtEquipComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    SELECT  SBJ_PROD_CD      ,
            SVC_CD           ,
            CMPS_QTY_FROM    ,
            CMPS_QTY_TO      ,
            DISP_PRI_NO
    FROM    ${productDevMgt.tableId}
    WHERE   PROD_CD   =  #{productDevMgt.prodCd}
    AND     EQT_CL_CD =  #{productDevMgt.eqtClCd}
  </select> 

  <update id="modTransSuprtEquip" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    UPDATE TPMPD_SUPRT_EQUIP TSE
    SET    ( INACT_DT            ,
             ACT_DT             ,
             SBJ_PROD_CD           ,
             SVC_CD                ,
             CMPS_QTY_FROM         ,
             CMPS_QTY_TO           ,
             MSTR_FL               ,
             CHGR_ID            ,
             CHG_DATE          ,
             DISP_PRI_NO             ) =
           ( SELECT INACT_DT            ,
                    ACT_DT             ,
                    SBJ_PROD_CD           ,
                    SVC_CD                ,
                    CMPS_QTY_FROM         ,
                    CMPS_QTY_TO           ,
                    MSTR_FL               ,
                    #{productDevMgt.chgrId} ,
                    #{productDevMgt.sysdate}    ,
                    DISP_PRI_NO
             FROM   TPMPD_D_SUPRT_EQUIP TDSE
             WHERE  TDSE.PROD_CD   = TSE.PROD_CD
             AND    TDSE.EQT_CL_CD = TSE.EQT_CL_CD)
    WHERE   TSE.PROD_CD    = #{productDevMgt.prodCd}
    AND     TSE.EQT_CL_CD  = #{productDevMgt.eqtClCd}
    AND     TSE.MSTR_FL  = '1'
  </update>

 	<update id="modTransSuprtEquipMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE  TPMPD_SUPRT_EQUIP
		SET     MSTR_FL      = '0' ,
		        CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		        CHG_DATE = #{productDevMgt.sysdate}
		WHERE   PROD_CD       = #{productDevMgt.prodCd}
		AND     EQT_CL_CD     = #{productDevMgt.eqtClCd}
		AND     MSTR_FL       = '1'
		AND     EXPIRAT_DT &lt; #{productDevMgt.transferApplyDt}
	</update>

	<update id="modTransUpdDelRateItm" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		UPDATE TPMPD_RATE_ITM TRI
		SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		       CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
				<choose>                          
					<when test="'${dbms.kind}' == 'ORACLE'">                       
			      		CHG_DATE = SYSDATE 
					</when>                          
					<when test="'${dbms.kind}' == 'MYSQL'">                         
			        	CHG_DATE = NOW()
					</when>
				</choose>
		WHERE  TRI.MSTR_FL     = '1'
		AND    TRI.PROD_CD     = #{productDevMgt.prodCd}
		AND    TRI.INACT_DT  = '99991231'
		<!-- AND    NOT EXISTS -->
		AND    EXISTS		
		       ( SELECT 1
		         FROM   TPMPD_D_RATE_ITM TDRI
		         WHERE  TDRI.RATE_ITM_CD  = TRI.RATE_ITM_CD
		         AND    TDRI.INACT_DT   = TRI.INACT_DT   )
	</update>

	<select id="getTransRateItmList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  RATE_ITM_CD           ,
		        INACT_DT            ,
		        ACT_DT             ,
		        RATE_ITM_NM           ,
		        RATE_ITM_ABBR_NM      ,
		        RATE_ITM_ENG_NM       ,
		        RATE_ITM_ENG_ABBR_NM  ,
		        PROD_CD               ,
		        SVC_CD                ,
		        SVC_RATE_ITM_TYP_CD   ,
		        CHRG_CTGRY            ,
		        RATE_LOCAT            ,
		        RATE_REF_TYP          ,
		        DEFLT_RATE_ITM_CD     ,
		        RATE_PRI_NO           ,
		        DISP_PRI_NO           ,
		        MSTR_FL               ,
		        REGR_ID          ,
		        REG_DATE        ,
		        CHGR_ID            ,
		        CHG_DATE
		FROM    TPMPD_D_RATE_ITM
		WHERE   PROD_CD   =  #{productDevMgt.prodCd}
		<!--  AND     CHG_DATE != '20010101'-->
	</select>
	
	<select id="getTransDualListRateItm" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT PROD_CD
		FROM   TPMPD_RATE_ITM
		WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
		AND    MSTR_FL      = '1'
		AND    INACT_DT   > #{productDevMgt.transferApplyDt}
	</select>	

	<select id="getTransRateItmComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  RATE_ITM_NM           ,
		        RATE_ITM_ABBR_NM      ,
		        RATE_ITM_ENG_NM       ,
		        PROD_CD               ,
		        SVC_CD                ,
		        SVC_RATE_ITM_TYP_CD   ,
		        CHRG_CTGRY            ,
		        RATE_LOCAT            ,
		        RATE_REF_TYP          ,
		        DEFLT_RATE_ITM_CD     ,
		        RATE_PRI_NO           ,
		        DISP_PRI_NO
		FROM    ${productDevMgt.tableId}
		WHERE   RATE_ITM_CD   =  #{productDevMgt.rateItmCd}
		AND     MSTR_FL       = '1'
	</select>

<update id="modTransRateItm" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
			UPDATE TPMPD_RATE_ITM TRI
			SET    ( INACT_DT            ,
					 ACT_DT             ,
					 RATE_ITM_NM           ,
					 RATE_ITM_ABBR_NM      ,
					 RATE_ITM_ENG_NM       ,
					 PROD_CD               ,
					 SVC_CD                ,
					 SVC_RATE_ITM_TYP_CD   ,
					 CHRG_CTGRY            ,
					 RATE_LOCAT            ,
					 RATE_REF_TYP          ,
					 DEFLT_RATE_ITM_CD     ,
					 RATE_PRI_NO           ,
					 DISP_PRI_NO           ,
					 
					 MSTR_FL               ,
					 CHGR_ID            ,
					 CHG_DATE            ) =
				   ( SELECT INACT_DT            ,
							ACT_DT             ,
							RATE_ITM_NM           ,
							RATE_ITM_ABBR_NM      ,
							RATE_ITM_ENG_NM       ,
							PROD_CD               ,
							SVC_CD                ,
							SVC_RATE_ITM_TYP_CD   ,
							CHRG_CTGRY            ,
							RATE_LOCAT            ,
							RATE_REF_TYP          ,
							DEFLT_RATE_ITM_CD     ,
							RATE_PRI_NO           ,
							DISP_PRI_NO           ,
							MSTR_FL               ,
							#{productDevMgt.chgrId}          ,
							#{productDevMgt.sysdate}
					 FROM   TPMPD_D_RATE_ITM TDRI
					 WHERE  TDRI.RATE_ITM_CD = TRI.RATE_ITM_CD)
			WHERE   TRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TRI.MSTR_FL  = '1'
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			UPDATE TPMPD_RATE_ITM TRI JOIN
		    ( SELECT INACT_DT            ,
		        ACT_DT             ,
						RATE_ITM_NM           ,
						RATE_ITM_ABBR_NM      ,
						RATE_ITM_ENG_NM       ,
						PROD_CD               ,
						SVC_CD                ,
						SVC_RATE_ITM_TYP_CD   ,
						CHRG_CTGRY            ,
						RATE_LOCAT            ,
						RATE_REF_TYP          ,
						DEFLT_RATE_ITM_CD     ,
						RATE_PRI_NO           ,
						DISP_PRI_NO           ,
						MSTR_FL               ,
						#{productDevMgt.chgrId}  AS CHGR_ID        ,
						NOW() AS CHG_DATE
					FROM   TPMPD_D_RATE_ITM TDRI
					WHERE  TDRI.RATE_ITM_CD = #{productDevMgt.rateItmCd}
					AND TDRI.PROD_CD =#{productDevMgt.prodCd} ) AS B
			  ON   TRI.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			  AND TRI.PROD_CD = #{productDevMgt.prodCd}
			  AND     TRI.MSTR_FL  = '1'
		    	SET   
		      TRI.INACT_DT = B.INACT_DT           ,
		  		 TRI.ACT_DT  = B.ACT_DT           ,
		  		 TRI.RATE_ITM_NM  = B.RATE_ITM_NM         ,
		  		 TRI.RATE_ITM_ABBR_NM = B.RATE_ITM_ABBR_NM     ,
		  		 TRI.RATE_ITM_ENG_NM = B.RATE_ITM_ENG_NM      ,
		  		 TRI.PROD_CD = B.PROD_CD              ,
		  		 TRI.SVC_CD  = B.SVC_CD              ,
		  		 TRI.SVC_RATE_ITM_TYP_CD = B.SVC_RATE_ITM_TYP_CD  ,
		  		 TRI.CHRG_CTGRY = B.CHRG_CTGRY           ,
		  		 TRI.RATE_LOCAT  = B.RATE_LOCAT          ,
		  		 TRI.RATE_REF_TYP = B.RATE_REF_TYP         ,
		  		 TRI.DEFLT_RATE_ITM_CD = B.DEFLT_RATE_ITM_CD     ,
		  		 TRI.RATE_PRI_NO = B.RATE_PRI_NO           ,
		  		 TRI.DISP_PRI_NO  = B.DISP_PRI_NO         ,
		  		 TRI.MSTR_FL = B.MSTR_FL              ,
		  		 TRI.CHGR_ID  = B.CHGR_ID          ,
		  		 TRI.CHG_DATE = B.CHG_DATE      
		</when>
	</choose> 

</update>

<update id="modTransRateItmExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransRateItmMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_RATE_ITM
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId} ,
			CHG_DATE = #{productDevMgt.sysdate}
	WHERE   RATE_ITM_CD   = #{productDevMgt.rateItmCd}
	AND     MSTR_FL       = '1'
	AND     INACT_DT &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelRateItmAttr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_ATTR TRIA
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  TRIA.MSTR_FL     = '1'
	AND    TRIA.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
								 FROM   TPMPD_RATE_ITM TRI
								 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
	AND    TRIA.INACT_DT  = '99991231'
		<!-- AND    NOT EXISTS -->
		AND    EXISTS	
		   ( SELECT 1
			 FROM   TPMPD_D_RATE_ITM_ATTR TDRIA
			 WHERE  TDRIA.RATE_ITM_CD  = TRIA.RATE_ITM_CD
			 AND    TDRIA.ATTR_CD      = TRIA.ATTR_CD
			 AND    TDRIA.INACT_DT   = TRIA.INACT_DT   )
</update>

<select id="getTransRateItmAttrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_ITM_CD           ,
			ATTR_CD               ,
			INACT_DT            ,
			ACT_DT             ,
			ATTR_VAL              ,
			MSTR_FL               ,
			REGR_ID          ,
			REG_DATE        ,
			CHGR_ID            ,
			CHG_DATE
	FROM    TPMPD_D_RATE_ITM_ATTR
	WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_D_RATE_ITM TDRI
							 WHERE  TDRI.PROD_CD = #{productDevMgt.prodCd} )
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListRateItmAttr" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_RATE_ITM_ATTR
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    ATTR_CD      = #{productDevMgt.attrCd}
	AND    MSTR_FL      = '1'
	<!-- AND    ACT_DT   > #{productDevMgt.transferApplyDt} 2017.07.21 -->
	AND    ACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransRateItmAttrComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  ATTR_VAL
	FROM    ${productDevMgt.tableId}
	WHERE   RATE_ITM_CD   =  #{productDevMgt.rateItmCd}
	AND     ATTR_CD       =  #{productDevMgt.attrCd}
	AND     MSTR_FL   =  '1'
</select>

<update id="modTransRateItmAttr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">

	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
			UPDATE TPMPD_RATE_ITM_ATTR TRIA
			SET    ( INACT_DT            ,
					 ACT_DT             ,
					 ATTR_VAL              ,
					 MSTR_FL               ,
					 CHGR_ID            ,
					 CHG_DATE            ) =
				   ( SELECT INACT_DT     ,
							ACT_DT      ,
							ATTR_VAL       ,
							MSTR_FL        ,
							#{productDevMgt.chgrId}   ,
		                    SYSDATE   
					 FROM   TP_D_RATE_ITM_ATTR TDRIA
					 WHERE  TDRIA.RATE_ITM_CD = TRIA.RATE_ITM_CD
					 AND    TDRIA.ATTR_CD     = TRIA.ATTR_CD   )
			WHERE   TRIA.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TRIA.ATTR_CD      = #{productDevMgt.attrCd}
			AND     TRIA.MSTR_FL      = '1'       
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			UPDATE TPMPD_RATE_ITM_ATTR TRIA JOIN
			( 
			  SELECT 
			    INACT_DT     ,
			    ACT_DT      ,
			    ATTR_VAL       ,
			    MSTR_FL        ,
			    #{productDevMgt.chgrId} AS CHGR_ID  ,
			    NOW() AS CHG_DATE     
			  FROM   TPMPD_D_RATE_ITM_ATTR TDRIA
			  WHERE  TDRIA.RATE_ITM_CD = #{productDevMgt.rateItmCd}
			  AND    TDRIA.ATTR_CD     = #{productDevMgt.attrCd} 
			) AS B
			ON   TRIA.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TRIA.ATTR_CD      = #{productDevMgt.attrCd}
			AND     TRIA.MSTR_FL      = '1'
			SET     
			  TRIA.INACT_DT =  B.INACT_DT ,
			  TRIA.ACT_DT  = B.ACT_DT ,
			  TRIA.ATTR_VAL = B.ATTR_VAL ,
			  TRIA.MSTR_FL = B.MSTR_FL  ,
			  TRIA.CHGR_ID = B.CHGR_ID ,
			  TRIA.CHG_DATE = B.CHG_DATE         
		</when>
	</choose>

</update>

<update id="modTransRateItmAttrExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_ATTR
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    ATTR_CD      =  #{productDevMgt.attrCd}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransRateItmAttrMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_RATE_ITM_ATTR
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND     ATTR_CD      = #{productDevMgt.attrCd}
	AND     MSTR_FL       = '1'
	AND     INACT_DT &lt;= #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelRateItmFctr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_FCTR TRIF
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		   CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TRIF.MSTR_FL     = '1'
	AND    TRIF.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
								 FROM   TPMPD_RATE_ITM TRI
								 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd}  )
	AND    TRIF.INACT_DT  = '99991231'
		<!-- AND    NOT EXISTS -->
		AND    EXISTS	
		   ( SELECT 1
			 FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
			 WHERE  TDRIF.RATE_ITM_CD  = TRIF.RATE_ITM_CD
			 AND    TDRIF.FCTR_CD      = TRIF.FCTR_CD
			 AND    TDRIF.INACT_DT   = TRIF.INACT_DT   )
</update>

<select id="getTransRateItmFctrList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_ITM_CD       ,
			FCTR_CD           ,
			INACT_DT        ,
			ACT_DT         ,
			FCTR_NO           ,
			RATE_INFO_EXE_FL  ,
			FCTR_REF_TYP      ,
			TABLE_ID          ,
			COLMN_ID          ,
			DATA_TYP          ,
			REF_TABLE_ID      ,
			REF_COLMN_ID      ,
			REF_COLMN_NM      ,
			REF_TABLE_COND    ,
			REF_CD            ,
			MSTR_FL           ,
			REGR_ID      ,
			REG_DATE    ,
			CHGR_ID        ,
			CHG_DATE
	FROM    TPMPD_D_RATE_ITM_FCTR
	WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_D_RATE_ITM TDRI
							 WHERE  TDRI.PROD_CD = #{productDevMgt.prodCd} )
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListRateItmFctr" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_RATE_ITM_FCTR
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    FCTR_CD      = #{productDevMgt.fctrCd}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransRateItmFctrComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  FCTR_NO           ,
			RATE_INFO_EXE_FL  ,
			FCTR_REF_TYP      ,
			TABLE_ID          ,
			COLMN_ID          ,
			DATA_TYP          ,
			<!--  
			REF_TABLE_ID      ,
			REF_COLMN_ID      ,
			REF_COLMN_NM      ,
			REF_TABLE_COND    ,
			-->
			REF_CD	,
			REF_FUNC		,
			CHG_NULL_FL			,
			CHG_NULL_VAL
	FROM    ${productDevMgt.tableId}
	WHERE   RATE_ITM_CD   =  #{productDevMgt.rateItmCd}
	AND     FCTR_CD       =  #{productDevMgt.fctrCd}
	AND     MSTR_FL       =  '1'
</select>

<update id="modTransRateItmFctr" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		<choose>                          
			<when test="'${dbms.kind}' == 'ORACLE'">                       
				UPDATE TPMPD_RATE_ITM_FCTR TRIF
				SET    ( INACT_DT        ,
						 ACT_DT         ,
						 FCTR_NO           ,
						 RATE_INFO_EXE_FL  ,
						 FCTR_REF_TYP      ,
						 TABLE_ID          ,
						 COLMN_ID          ,
						 DATA_TYP          ,
						 REF_CD            ,
						 MSTR_FL           ,
						 CHGR_ID        ,
						 CHG_DATE    ,
						 REF_FUNC   ,
						 CHG_NULL_FL				,
						 CHG_NULL_VAL     ) =
					   ( SELECT INACT_DT        ,
								ACT_DT         ,
								FCTR_NO           ,
								RATE_INFO_EXE_FL  ,
								FCTR_REF_TYP      ,
								TABLE_ID          ,
								COLMN_ID          ,
								DATA_TYP          ,
								REF_CD            ,
								MSTR_FL           ,
								#{productDevMgt.chgrId}      ,
           						SYSDATE         ,
								REF_FUNC		,
								CHG_NULL_FL		,
								CHG_NULL_VAL
						 FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
						 WHERE  TDRIF.RATE_ITM_CD = TRIF.RATE_ITM_CD
						 AND    TDRIF.FCTR_CD     = TRIF.FCTR_CD   )
				WHERE   TRIF.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
				AND     TRIF.FCTR_CD      = #{productDevMgt.fctrCd}
				AND     TRIF.MSTR_FL      = '1'
			</when>                          
			<when test="'${dbms.kind}' == 'MYSQL'">                         
				UPDATE TPMPD_RATE_ITM_FCTR TRIF JOIN
				( 
				  SELECT 
				    INACT_DT        ,
				    ACT_DT         ,
				    FCTR_NO           ,
				    RATE_INFO_EXE_FL  ,
				    FCTR_REF_TYP      ,
				    TABLE_ID          ,
				    COLMN_ID          ,
				    DATA_TYP          ,
				    REF_CD            ,
				    MSTR_FL           ,
				    #{productDevMgt.chgrId}   AS CHGR_ID   ,
				    NOW() AS  CHG_DATE    ,
				    REF_FUNC		,
				    CHG_NULL_FL		,
				    CHG_NULL_VAL
				  FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
				  WHERE  TDRIF.RATE_ITM_CD = #{productDevMgt.rateItmCd}
				  AND    TDRIF.FCTR_CD     = #{productDevMgt.fctrCd}   ) AS B
				ON   TRIF.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
				AND     TRIF.FCTR_CD      = #{productDevMgt.fctrCd}
				AND     TRIF.MSTR_FL      = '1'
				SET 
				  TRIF.INACT_DT = B.INACT_DT        ,
				  TRIF.ACT_DT = B.ACT_DT        ,
				  TRIF.FCTR_NO = B.FCTR_NO          ,
				  TRIF.RATE_INFO_EXE_FL = B.RATE_INFO_EXE_FL ,
				  TRIF.FCTR_REF_TYP = B.FCTR_REF_TYP     ,
				  TRIF.TABLE_ID  = B.TABLE_ID        ,
				  TRIF.COLMN_ID  = B.COLMN_ID        ,
				  TRIF.DATA_TYP  = B.DATA_TYP        ,
				  TRIF.REF_CD   = B.REF_CD         ,
				  TRIF.MSTR_FL = B.MSTR_FL          ,
				  TRIF.CHGR_ID = B.CHGR_ID       ,
				  TRIF.CHG_DATE = B.CHG_DATE    ,
				  TRIF.REF_FUNC = B.REF_FUNC  ,
				  TRIF.CHG_NULL_FL	= B.CHG_NULL_FL			,
				  TRIF.CHG_NULL_VAL = B.CHG_NULL_VAL 
			</when>
		</choose>  

</update>

<update id="modTransRateItmFctrExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_FCTR
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    FCTR_CD      =  #{productDevMgt.fctrCd}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransRateItmFctrMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_RATE_ITM_FCTR
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND     FCTR_CD      = #{productDevMgt.fctrCd}
	AND     MSTR_FL      = '1'
	AND     INACT_DT  &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelDiscSvcRateItmTyp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
UPDATE TPMPD_DISC_SVC_RATE_ITM_TYP TDSRIT
SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	   CHG_DATE = #{productDevMgt.sysdate}
WHERE  TDSRIT.MSTR_FL     = '1'
AND    TDSRIT.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
								   FROM   TPMPD_RATE_ITM TRI
								   WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
AND    TDSRIT.INACT_DT  = '99991231'
<!-- AND    NOT EXISTS -->
AND    EXISTS	
	   ( SELECT 1
		 FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP TDDSRIT
		 WHERE  TDDSRIT.RATE_ITM_CD              = TDSRIT.RATE_ITM_CD
		 AND    TDDSRIT.SVC_RATE_ITM_TYP_CD      = TDSRIT.SVC_RATE_ITM_TYP_CD
		 AND    TDDSRIT.INACT_DT               = TDSRIT.INACT_DT   )
</update>

<select id="getTransDiscSvcRateItmTypDvlpList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
SELECT  RATE_ITM_CD                  ,
		SVC_RATE_ITM_TYP_CD          ,
		INACT_DT                   ,
		ACT_DT                    ,
		MSTR_FL                      ,
		REGR_ID                 ,
		REG_DATE               ,
		CHGR_ID                   ,
		CHG_DATE
FROM    TPMPD_D_DISC_SVC_RT_ITM_TYP
WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
						 FROM   TPMPD_RATE_ITM TRI
						 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListDiscSvcRateItmTyp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_DISC_SVC_RATE_ITM_TYP
	WHERE  RATE_ITM_CD         = #{productDevMgt.rateItmCd}
	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
	AND    MSTR_FL             = '1'
	AND    INACT_DT          > #{productDevMgt.transferApplyDt}
</select>

<update id="modTransDiscSvcRateItmTypMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_DISC_SVC_RATE_ITM_TYP
	SET    MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD         = #{productDevMgt.rateItmCd}
	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
	AND    MSTR_FL             = '1'
	AND    INACT_DT          &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelRateItmCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_COND TRIC
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  TRIC.MSTR_FL     = '1'
	AND    TRIC.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
								 FROM   TPMPD_RATE_ITM TRI
								 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
	AND    TRIC.INACT_DT  = '99991231'
		<!-- AND    NOT EXISTS -->
		AND    EXISTS	
		   ( SELECT 1
			 FROM   TPMPD_D_RATE_ITM_COND TDRIC
			 WHERE  TDRIC.RATE_ITM_CD  = TRIC.RATE_ITM_CD
			 AND    TDRIC.COND_NO      = TRIC.COND_NO
			 AND    TDRIC.INACT_DT   = TRIC.INACT_DT   )
</update>

<select id="getTransRateItmCondList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_ITM_CD       ,
			COND_NO           ,
			INACT_DT        ,
			ACT_DT         ,
			FCTR_CD          ,
			COND_OPERATOR    ,
			OPRND_REF_FL     ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_2          ,
			OPRND_FCTR_CD_2  ,
			MSTR_FL           ,
			REGR_ID      ,
			REG_DATE    ,
			CHGR_ID        ,
			CHG_DATE
	FROM    TPMPD_D_RATE_ITM_COND
	WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_D_RATE_ITM TDRI
							 WHERE  TDRI.PROD_CD = #{productDevMgt.prodCd} )
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListRateItmCond" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_RATE_ITM_COND
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    COND_NO      = #{productDevMgt.condNo}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransRateItmCondComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  FCTR_CD          ,
			COND_OPERATOR    ,
			OPRND_REF_FL     ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_2          ,
			OPRND_FCTR_CD_2
	FROM    ${productDevMgt.tableId}
	WHERE   RATE_ITM_CD   =  #{productDevMgt.rateItmCd}
	AND     COND_NO       =  #{productDevMgt.condNo}
	AND     MSTR_FL   =  '1'
</select>

<select id="getTransDiscSvcRateItmComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT 
		RATE_ITM_CD, 
		SVC_RATE_ITM_TYP_CD 
	FROM TPMPD_DISC_SVC_RATE_ITM_TYP
	WHERE RATE_ITM_CD =  #{productDevMgt.rateItmCd}
	AND SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
	AND     MSTR_FL       =  '1'	
</select>

<update id="modTransRateItmCond" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
		 	UPDATE TPMPD_RATE_ITM_COND TRIC
			SET    ( INACT_DT        ,
					 ACT_DT         ,
					 FCTR_CD           ,
					 COND_OPERATOR     ,
					 OPRND_REF_FL      ,
					 OPRND_1           ,
					 OPRND_FCTR_CD_1   ,
					 OPRND_2           ,
					 OPRND_FCTR_CD_2   ,
					 MSTR_FL           ,
					 CHGR_ID        ,
					 CHG_DATE            ) =
				   ( SELECT INACT_DT        ,
							ACT_DT         ,
							FCTR_CD           ,
							COND_OPERATOR     ,
							OPRND_REF_FL      ,
							OPRND_1           ,
							OPRND_FCTR_CD_1   ,
							OPRND_2           ,
							OPRND_FCTR_CD_2   ,
							MSTR_FL           ,
							#{productDevMgt.chgrId}      ,
							SYSDATE
					 FROM   TPMPD_D_RATE_ITM_COND TDRIC
					 WHERE  TDRIC.RATE_ITM_CD = TRIC.RATE_ITM_CD
					 AND    TDRIC.COND_NO     = TRIC.COND_NO   )
			WHERE   TRIC.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TRIC.COND_NO      = #{productDevMgt.condNo}
			AND     TRIC.MSTR_FL      = '1'     		
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			  UPDATE TPMPD_RATE_ITM_COND TRIC JOIN( 
			  SELECT 
			    INACT_DT        ,
			    ACT_DT         ,
			    FCTR_CD           ,
			    COND_OPERATOR     ,
			    OPRND_REF_FL      ,
			    OPRND_1           ,
			    OPRND_FCTR_CD_1   ,
			    OPRND_2           ,
			    OPRND_FCTR_CD_2   ,
			    MSTR_FL           ,
			    #{productDevMgt.chgrId}  AS  CHGR_ID  ,
			    NOW() AS CHG_DATE
			  FROM   TPMPD_D_RATE_ITM_COND TDRIC
			  WHERE  TDRIC.RATE_ITM_CD = #{productDevMgt.rateItmCd}
			    AND    TDRIC.COND_NO     = #{productDevMgt.condNo}  ) AS B
			ON   TRIC.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			  AND     TRIC.COND_NO      = #{productDevMgt.condNo}
			  AND     TRIC.MSTR_FL      = '1'
			SET  
			  TRIC.INACT_DT   = B.INACT_DT     ,
			  TRIC.ACT_DT = B.ACT_DT,
			  TRIC.FCTR_CD = B.FCTR_CD,
			  TRIC.COND_OPERATOR = B.COND_OPERATOR,
			  TRIC.OPRND_REF_FL = B.OPRND_REF_FL,
			  TRIC.OPRND_1 = B.OPRND_1,
			  TRIC.OPRND_FCTR_CD_1 = B.OPRND_FCTR_CD_1,
			  TRIC.OPRND_2 = B.OPRND_2,
			  TRIC.OPRND_FCTR_CD_2 = B.OPRND_FCTR_CD_2,
			  TRIC.MSTR_FL = B.MSTR_FL,
			  TRIC.CHGR_ID = B.CHGR_ID,
			  TRIC.CHG_DATE = B.CHG_DATE      
		</when>
	</choose>
</update>

<update id="modTransDiscSvcRateItmComp" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
		 	UPDATE TPMPD_DISC_SVC_RATE_ITM_TYP TRIC
			SET    ( INACT_DT        ,
					 ACT_DT         ,
					 RATE_ITM_CD           ,
					 SVC_RATE_ITM_TYP_CD     ,
					 MSTR_FL           ,
					 CHGR_ID        ,
					 CHG_DATE            ) =
				   ( SELECT INACT_DT        ,
  					 ACT_DT         ,
  					 RATE_ITM_CD           ,
  					 SVC_RATE_ITM_TYP_CD     ,
  					 MSTR_FL           ,
					#{productDevMgt.chgrId}      ,
					SYSDATE
					 FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP TDRIC
					 WHERE  TDRIC.RATE_ITM_CD = TRIC.RATE_ITM_CD
					 AND    TDRIC.SVC_RATE_ITM_TYP_CD     = TRIC.SVC_RATE_ITM_TYP_CD   )
			WHERE   TRIC.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TRIC.SVC_RATE_ITM_TYP_CD      = #{productDevMgt.svcRateItmTypCd}
			AND     TRIC.MSTR_FL      = '1'    		
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			UPDATE TPMPD_DISC_SVC_RATE_ITM_TYP TRIC
			( 
			  SELECT 
			    INACT_DT        ,
			    ACT_DT         ,
			    RATE_ITM_CD           ,
			    SVC_RATE_ITM_TYP_CD     ,
			    MSTR_FL           ,
			    #{productDevMgt.chgrId}      ,
			    NOW()
			  FROM   TPMPD_D_DISC_SVC_RT_ITM_TYP TDRIC
			  WHERE  TDRIC.RATE_ITM_CD = #{productDevMgt.rateItmCd}
			  AND    TDRIC.SVC_RATE_ITM_TYP_CD     =  #{productDevMgt.svcRateItmTypCd}  ) AS B
			ON   TRIC.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			  AND     TRIC.SVC_RATE_ITM_TYP_CD      = #{productDevMgt.svcRateItmTypCd}
			  AND     TRIC.MSTR_FL      = '1'    
			SET    TRIC.INACT_DT    = INACT_DT    ,
			TRIC.ACT_DT = B.ACT_DT,
			TRIC.RATE_ITM_CD = B.RATE_ITM_CD,
			TRIC.SVC_RATE_ITM_TYP_CD = B.SVC_RATE_ITM_TYP_CD,
			TRIC.MSTR_FL = B.MSTR_FL,
			TRIC.CHGR_ID = B.CHGR_ID,
			TRIC.CHG_DATE = B.CHG_DATE     
		</when>
	</choose>
</update>

<update id="modTransRateItmCondExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE_ITM_COND
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    COND_NO      =  #{productDevMgt.condNo}
	AND    MSTR_FL      = '1'
</update>
<update id="modTransDiscSvcRateItmTypExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_DISC_SVC_RATE_ITM_TYP
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    SVC_RATE_ITM_TYP_CD      = #{productDevMgt.svcRateItmTypCd}
	AND    MSTR_FL      = '1'
</update>
<update id="modTransRateItmCondMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_RATE_ITM_COND
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
			CHG_DATE = #{productDevMgt.sysdate}
	WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND     COND_NO      = #{productDevMgt.condNo}
	AND     MSTR_FL      = '1'
	AND     INACT_DT  &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE TR
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		   CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TR.MSTR_FL     = '1'
	AND    TR.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							   FROM   TPMPD_RATE_ITM TRI
							   WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
	AND    TR.INACT_DT  = '99991231'
		<!-- AND    NOT EXISTS -->
		AND    EXISTS	
		   ( SELECT 1
			 FROM   TPMPD_D_RATE TDR
			 WHERE  TDR.RATE_ITM_CD = TR.RATE_ITM_CD
			 AND    TDR.FCTR_VAL1   = TR.FCTR_VAL1
			 AND    TDR.FCTR_VAL2   = TR.FCTR_VAL2
			 AND    TDR.FCTR_VAL3   = TR.FCTR_VAL3
			 AND    TDR.FCTR_VAL4   = TR.FCTR_VAL4
			 AND    TDR.FCTR_VAL5   = TR.FCTR_VAL5
			 AND    TDR.FCTR_VAL6   = TR.FCTR_VAL6
			 AND    TDR.FCTR_VAL7   = TR.FCTR_VAL7
			 AND    TDR.FCTR_VAL8   = TR.FCTR_VAL8
			 AND    TDR.FCTR_VAL9   = TR.FCTR_VAL9
			 AND    TDR.INACT_DT    = TR.INACT_DT   )
</update>

<select id="getTransRateList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_ITM_CD     ,
			FCTR_VAL1       ,
			FCTR_VAL2       ,
			FCTR_VAL3       ,
			FCTR_VAL4       ,
			FCTR_VAL5       ,
			FCTR_VAL6       ,
			FCTR_VAL7       ,
			FCTR_VAL8       ,
			FCTR_VAL9       ,
			INACT_DT      ,
			ACT_DT       ,
			RATE_REF_FL     ,
			RATE_VAL        ,
			RATE_FCTR_CD    ,
			DIVI_RATE_AMT   ,
			QTY_REF_FL      ,
			QTY             ,
			QTY_FCTR_CD     ,
			CRNCY_REF_FL    ,
			CRNCY_CD        ,
			CRNCY_FCTR_CD   ,
			ALWNCE_CD       ,
			MSTR_FL         ,
			REGR_ID    ,
			REG_DATE  ,
			CHGR_ID      ,
			CHG_DATE
	FROM    TPMPD_D_RATE
	WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_D_RATE_ITM TDRI
							 WHERE  TDRI.PROD_CD = #{productDevMgt.prodCd} )
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListRate" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_RATE
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
	AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
	AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
	AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
	AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
	AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
	AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
	AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
	AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransRateComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_REF_FL     ,
			RATE_VAL        ,
			RATE_FCTR_CD    ,
			DIVI_RATE_AMT   ,
			QTY_REF_FL      ,
			QTY             ,
			QTY_FCTR_CD     ,
			CRNCY_REF_FL    ,
			CRNCY_CD        ,
			CRNCY_FCTR_CD   ,
			ALWNCE_CD
	FROM    ${productDevMgt.tableId}
	WHERE   RATE_ITM_CD  =  #{productDevMgt.rateItmCd}
	AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
	AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
	AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
	AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
	AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
	AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
	AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
	AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
	AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
	AND     MSTR_FL      = '1'
</select>

<update id="modTransRate" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
			UPDATE TPMPD_RATE TR
			SET    (
					   INACT_DT      ,
					   ACT_DT       ,
					   RATE_REF_FL     ,
					   RATE_VAL        ,
					   RATE_FCTR_CD    ,
					   DIVI_RATE_AMT   ,
					   QTY_REF_FL      ,
					   QTY             ,
					   QTY_FCTR_CD     ,
					   CRNCY_REF_FL    ,
					   CRNCY_CD        ,
					   CRNCY_FCTR_CD   ,
					   ALWNCE_CD       ,
					   MSTR_FL         ,
					   CHGR_ID      ,
					   CHG_DATE            ) =
				   (   SELECT INACT_DT      ,
							  ACT_DT       ,
							  RATE_REF_FL     ,
							  RATE_VAL        ,
							  RATE_FCTR_CD    ,
							  DIVI_RATE_AMT   ,
							  QTY_REF_FL      ,
							  QTY             ,
							  QTY_FCTR_CD     ,
							  CRNCY_REF_FL    ,
							  CRNCY_CD        ,
							  CRNCY_FCTR_CD   ,
							  ALWNCE_CD       ,
							  MSTR_FL         ,
							  #CHGR_ID#    ,
		                      SYSDATE   
					   FROM   TPMPD_D_RATE TDR
					   WHERE  TDR.RATE_ITM_CD = TR.RATE_ITM_CD
					   AND    TDR.FCTR_VAL1   = TR.FCTR_VAL1
					   AND    TDR.FCTR_VAL2   = TR.FCTR_VAL2
					   AND    TDR.FCTR_VAL3   = TR.FCTR_VAL3
					   AND    TDR.FCTR_VAL4   = TR.FCTR_VAL4
					   AND    TDR.FCTR_VAL5   = TR.FCTR_VAL5
					   AND    TDR.FCTR_VAL6   = TR.FCTR_VAL6
					   AND    TDR.FCTR_VAL7   = TR.FCTR_VAL7
					   AND    TDR.FCTR_VAL8   = TR.FCTR_VAL8
					   AND    TDR.FCTR_VAL9   = TR.FCTR_VAL9      )
			WHERE   TR.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
			AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
			AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
			AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
			AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
			AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
			AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
			AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
			AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
			AND     TR.MSTR_FL      = '1'
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
			UPDATE TPMPD_RATE TR JOIN(   
			  SELECT 
			    INACT_DT      ,
			    ACT_DT       ,
			    RATE_REF_FL     ,
			    RATE_VAL        ,
			    RATE_FCTR_CD    ,
			    DIVI_RATE_AMT   ,
			    QTY_REF_FL      ,
			    QTY             ,
			    QTY_FCTR_CD     ,
			    CRNCY_REF_FL    ,
			    CRNCY_CD        ,
			    CRNCY_FCTR_CD   ,
			    ALWNCE_CD       ,
			    MSTR_FL         ,
			    #{productDevMgt.chgrId}  AS  CHGR_ID  ,
			    NOW()  AS   CHG_DATE   
			  FROM   TPMPD_D_RATE TDR
			  WHERE  TDR.RATE_ITM_CD = #{productDevMgt.rateItmCd}
			    AND    TDR.FCTR_VAL1   = #{productDevMgt.fctrVal1}
			    AND    TDR.FCTR_VAL2   = #{productDevMgt.fctrVal2}
			    AND    TDR.FCTR_VAL3   = #{productDevMgt.fctrVal3}
			    AND    TDR.FCTR_VAL4   = #{productDevMgt.fctrVal4}
			    AND    TDR.FCTR_VAL5   = #{productDevMgt.fctrVal5}
			    AND    TDR.FCTR_VAL6   = #{productDevMgt.fctrVal6}
			    AND    TDR.FCTR_VAL7   = #{productDevMgt.fctrVal7}
			    AND    TDR.FCTR_VAL8   = #{productDevMgt.fctrVal8}
			    AND    TDR.FCTR_VAL9   = #{productDevMgt.fctrVal9} ) AS B
			  ON   TR.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			    AND    TR.FCTR_VAL1    = #{productDevMgt.fctrVal1}
			    AND    TR.FCTR_VAL2    = #{productDevMgt.fctrVal2}
			    AND    TR.FCTR_VAL3    = #{productDevMgt.fctrVal3}
			    AND    TR.FCTR_VAL4    = #{productDevMgt.fctrVal4}
			    AND    TR.FCTR_VAL5    = #{productDevMgt.fctrVal5}
			    AND    TR.FCTR_VAL6    = #{productDevMgt.fctrVal6}
			    AND    TR.FCTR_VAL7    = #{productDevMgt.fctrVal7}
			    AND    TR.FCTR_VAL8    = #{productDevMgt.fctrVal8}
			    AND    TR.FCTR_VAL9    = #{productDevMgt.fctrVal9}
			    AND    TR.MSTR_FL      = '1'
			SET 
			  TR.INACT_DT = B.INACT_DT,
			  TR.ACT_DT = B.ACT_DT,
			  TR.RATE_REF_FL = B.RATE_REF_FL,
			  TR.RATE_VAL = B.RATE_VAL,
			  TR.RATE_FCTR_CD = B.RATE_FCTR_CD,
			  TR.DIVI_RATE_AMT = B.DIVI_RATE_AMT,
			  TR.QTY_REF_FL = B.QTY_REF_FL,
			  TR.QTY = B.QTY,
			  TR.QTY_FCTR_CD = B.QTY_FCTR_CD,
			  TR.CRNCY_REF_FL = B.CRNCY_REF_FL,
			  TR.CRNCY_CD = B.CRNCY_CD,
			  TR.CRNCY_FCTR_CD = B.CRNCY_FCTR_CD,
			  TR.ALWNCE_CD = B.ALWNCE_CD,
			  TR.MSTR_FL = B.MSTR_FL,
			  TR.CHGR_ID = B.CHGR_ID,
			  TR.CHG_DATE = B.CHG_DATE   
		</when>
	</choose>  

</update>

<update id="modTransRateExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_RATE
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
	AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
	AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
	AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
	AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
	AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
	AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
	AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
	AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
	AND     MSTR_FL      = '1'
</update>

<update id="modTransRateMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_RATE
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
			CHG_DATE = #{productDevMgt.sysdate}
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    FCTR_VAL1    = #{productDevMgt.fctrVal1}
	AND    FCTR_VAL2    = #{productDevMgt.fctrVal2}
	AND    FCTR_VAL3    = #{productDevMgt.fctrVal3}
	AND    FCTR_VAL4    = #{productDevMgt.fctrVal4}
	AND    FCTR_VAL5    = #{productDevMgt.fctrVal5}
	AND    FCTR_VAL6    = #{productDevMgt.fctrVal6}
	AND    FCTR_VAL7    = #{productDevMgt.fctrVal7}
	AND    FCTR_VAL8    = #{productDevMgt.fctrVal8}
	AND    FCTR_VAL9    = #{productDevMgt.fctrVal9}
	AND     MSTR_FL      = '1'
	AND     INACT_DT  &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelDiscExcl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
UPDATE TPMPD_DISC_EXCL TDE
SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
	   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	   CHG_DATE = #{productDevMgt.sysdate}
WHERE  TDE.MSTR_FL     = '1'
AND    TDE.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							FROM   TPMPD_RATE_ITM TRI
							WHERE  TRI.PROD_CD = #{productDevMgt.prodCd} )
AND    TDE.INACT_DT  = '99991231'
<!-- AND    NOT EXISTS -->
AND    EXISTS	
	   ( SELECT 1
		 FROM   TPMPD_D_DISC_EXCL TDDE
		 WHERE  TDDE.RATE_ITM_CD              = TDE.RATE_ITM_CD
		 AND    TDDE.SVC_RATE_ITM_TYP_CD      = TDE.SVC_RATE_ITM_TYP_CD
		 AND    TDDE.INACT_DT               = TDE.INACT_DT   )
</update>

<select id="getTransDiscExclDvlpList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
SELECT  RATE_ITM_CD                  ,
		SVC_RATE_ITM_TYP_CD          ,
		INACT_DT                   ,
		ACT_DT                    ,
		MSTR_FL                      ,
		REGR_ID                 ,
		REG_DATE               ,
		CHGR_ID                   ,
		CHG_DATE
FROM    TPMPD_D_DISC_EXCL
WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_RATE_ITM TRI
							 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd} )
<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListDiscExcl" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_DISC_EXCL
	WHERE  RATE_ITM_CD         = #{productDevMgt.rateItmCd}
	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
	AND    MSTR_FL = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<update id="modTransDiscExclMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_DISC_EXCL
	SET    MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD         = #{productDevMgt.rateItmCd}
	AND    SVC_RATE_ITM_TYP_CD = #{productDevMgt.svcRateItmTypCd}
	AND    MSTR_FL             = '1'
	AND    INACT_DT          &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelDiscPerd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_DISC_PERD TDP
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		   CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TDP.MSTR_FL     = '1'
	AND    TDP.RATE_ITM_CD IN ( SELECT RATE_ITM_CD
								 FROM   TPMPD_RATE_ITM TRI
								 WHERE  TRI.PROD_CD     = #{productDevMgt.prodCd}  )
	AND    TDP.INACT_DT  = '99991231'
<!-- AND    NOT EXISTS -->
AND    EXISTS	
		   ( SELECT 1
			 FROM   TPMPD_D_DISC_PERD TDDP
			 WHERE  TDDP.RATE_ITM_CD  = TDP.RATE_ITM_CD
			 AND    TDDP.INACT_DT   = TDP.INACT_DT   )
</update>

<select id="getTransDiscPerdList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  RATE_ITM_CD       ,
			INACT_DT        ,
			ACT_DT         ,
			OPERATOR         ,
			OPRND_REF_FL_1   ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_REF_FL_2   ,
			OPRND_2          ,
			OPRND_FCTR_CD_2  ,
			MSTR_FL           ,
			REGR_ID      ,
			REG_DATE    ,
			CHGR_ID        ,
			CHG_DATE
	FROM    TPMPD_D_DISC_PERD
	WHERE   RATE_ITM_CD IN ( SELECT RATE_ITM_CD
							 FROM   TPMPD_D_RATE_ITM TDRI
							 WHERE  TDRI.PROD_CD = #{productDevMgt.prodCd} )
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListDiscPerd" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT RATE_ITM_CD
	FROM   TPMPD_DISC_PERD
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    MSTR_FL      = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransDiscPerdComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  OPERATOR         ,
			OPRND_REF_FL_1   ,
			OPRND_1          ,
			OPRND_FCTR_CD_1  ,
			OPRND_REF_FL_2   ,
			OPRND_2          ,
			OPRND_FCTR_CD_2
	FROM    ${productDevMgt.tableId}
	WHERE   RATE_ITM_CD   =  #{productDevMgt.rateItmCd}
	AND     MSTR_FL      = '1'
</select>

<update id="modTransDiscPerd" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
		 	UPDATE TPMPD_DISC_PERD TDP
			SET    ( INACT_DT        ,
					 ACT_DT         ,
					 OPERATOR         ,
					 OPRND_REF_FL_1   ,
					 OPRND_1          ,
					 OPRND_FCTR_CD_1  ,
					 OPRND_REF_FL_2   ,
					 OPRND_2          ,
					 OPRND_FCTR_CD_2 ,
					 MSTR_FL           ,
					 CHGR_ID        ,
					 CHG_DATE            ) =
				   ( SELECT INACT_DT        ,
							ACT_DT         ,
							OPERATOR         ,
							OPRND_REF_FL_1   ,
							OPRND_1          ,
							OPRND_FCTR_CD_1  ,
							OPRND_REF_FL_2   ,
							OPRND_2          ,
							OPRND_FCTR_CD_2 ,
							MSTR_FL           ,
							#{productDevMgt.chgrId}      ,
		                    SYSDATE         
					 FROM   TPMPD_D_DISC_PERD TDDP
					 WHERE  TDDP.RATE_ITM_CD = TDP.RATE_ITM_CD  )
			WHERE   TDP.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
			AND     TDP.MSTR_FL      = '1'    
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
 			UPDATE TPMPD_DISC_PERD TDP JOIN
		   ( SELECT INACT_DT        ,
					ACT_DT         ,
					OPERATOR         ,
					OPRND_REF_FL_1   ,
					OPRND_1          ,
					OPRND_FCTR_CD_1  ,
					OPRND_REF_FL_2   ,
					OPRND_2          ,
					OPRND_FCTR_CD_2 ,
					MSTR_FL           ,
					#{productDevMgt.chgrId} AS CHGR_ID     ,
         			NOW() AS CHG_DATE  
			 FROM   TPMPD_D_DISC_PERD TDDP
			 WHERE  TDDP.RATE_ITM_CD = #{productDevMgt.rateItmCd}  ) AS B
			ON   TDP.RATE_ITM_CD  = #{productDevMgt.rateItmCd}
				AND     TDP.MSTR_FL      = '1'
			SET  
		       TDP.INACT_DT = B.INACT_DT,
					 TDP.ACT_DT = B.ACT_DT,
					 TDP.OPERATOR = B.OPERATOR,
					 TDP.OPRND_REF_FL_1 = B.OPRND_REF_FL_1,
					 TDP.OPRND_1 = B.OPRND_1,
					 TDP.OPRND_FCTR_CD_1 = B.OPRND_FCTR_CD_1,
					 TDP.OPRND_REF_FL_2 = B.OPRND_REF_FL_2,
					 TDP.OPRND_2 = B.OPRND_2,
					 TDP.OPRND_FCTR_CD_2 = B.OPRND_FCTR_CD_2,
					 TDP.MSTR_FL = B.MSTR_FL,
					 TDP.CHGR_ID = B.CHGR_ID,  
					 TDP.CHG_DATE = B.CHG_DATE    
		</when>
	</choose>  

</update>

<update id="modTransDiscPerdExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_DISC_PERD
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   MSTR_FL      = '0',
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE  RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND    MSTR_FL      = '1'
</update>

<update id="modTransDiscPerdMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_DISC_PERD
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
			CHG_DATE = #{productDevMgt.sysdate}
	WHERE   RATE_ITM_CD  = #{productDevMgt.rateItmCd}
	AND     MSTR_FL      = '1'
	AND     INACT_DT  &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransUpdDelAlwnce" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TPMPD_ALWNCE TA
	SET    INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
		   CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
		   CHG_DATE = #{productDevMgt.sysdate}
	WHERE  TA.MSTR_FL     = '1'
	AND    TA.PROD_CD     = #{productDevMgt.prodCd, jdbcType=VARCHAR }
	AND    TA.INACT_DT  = '99991231'
	AND    NOT EXISTS
		   ( SELECT 1
			 FROM   TPMPD_D_ALWNCE TDA
			 WHERE  TDA.ALWNCE_CD   = TA.ALWNCE_CD
			 AND    TDA.INACT_DT  = TA.INACT_DT   )
</update>

<select id="getTransAlwnceList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  ALWNCE_CD              ,
			INACT_DT             ,
			ACT_DT              ,
			ALWNCE_NM              ,
			PROD_CD                ,
			ALWNCE_TYP             ,
			ALWNCE_APPL_LVL        ,
			ALWNCE_UNT             ,
			ALWNCE_AMT_SBJ         ,
			ALWNCE_APPL_UOM        ,
			ALWNCE_AMT_TYP         ,
			PRORATE_TYP            ,
			REGT_ALWNCE_AMT        ,
			ALWNCE_AMNT            ,
			ROLLOVR_FL             ,
			ROLLOVR_CNT            ,
			THRS_NOTI_MTHD_REF_FL  ,
			THRS_NOTI_MTHD         ,
			THRS_UOM               ,
			THRS1                  ,
			THRS2                  ,
			THRS3                  ,
			MSTR_FL                ,
			REGR_ID           ,
			REG_DATE         ,
			CHGR_ID             ,
			CHG_DATE
	FROM    TPMPD_D_ALWNCE
	WHERE   PROD_CD   =  #{productDevMgt.prodCd}
	<!--  AND     CHG_DATE != '20010101'-->
</select>

<select id="getTransDualListAlwnce" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT PROD_CD
	FROM   TPMPD_ALWNCE
	WHERE  ALWNCE_CD    = #{productDevMgt.alwnceCd}
	AND    MSTR_FL = '1'
	AND    INACT_DT   > #{productDevMgt.transferApplyDt}
</select>

<select id="getTransAlwnceComp" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	SELECT  ALWNCE_NM              ,
			PROD_CD                ,
			ALWNCE_TYP             ,
			ALWNCE_APPL_LVL        ,
			ALWNCE_UNT             ,
			ALWNCE_AMT_SBJ         ,
			ALWNCE_APPL_UOM        ,
			ALWNCE_AMT_TYP         ,
			PRORATE_TYP            ,
			REGT_ALWNCE_AMT        ,
			ALWNCE_AMNT            ,
			ROLLOVR_FL             ,
			ROLLOVR_CNT            ,
			THRS_NOTI_MTHD_REF_FL  ,
			THRS_NOTI_MTHD         ,
			THRS_UOM               ,
			THRS1                  ,
			THRS2                  ,
			THRS3
	FROM    ${productDevMgt.tableId}
	WHERE   ALWNCE_CD =  #{productDevMgt.alwnceCd}
	AND     MSTR_FL      = '1'
</select>	

<!--  -->
<update id="modTransAlwnce" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE TP_ALWNCE TA
	SET    ( INACT_DT             ,
	         ACT_DT              ,
	         ALWNCE_NM              ,
	         PROD_CD                ,
	         ALWNCE_TYP             ,
	         ALWNCE_APPL_LVL        ,
	         ALWNCE_UNT             ,
	         ALWNCE_AMT_SBJ         ,
	         ALWNCE_APPL_UOM        ,
	         ALWNCE_AMT_TYP         ,
	         PRORATE_TYP            ,
	         REGT_ALWNCE_AMT        ,
	         ALWNCE_AMNT            ,
	         ROLLOVR_FL             ,
	         ROLLOVR_CNT            ,
	         THRS_NOTI_MTHD_REF_FL  ,
	         THRS_NOTI_MTHD         ,
	         THRS_UOM               ,
	         THRS1                  ,
	         THRS2                  ,
	         THRS3                  ,
	         MSTR_FL                ,
	         CHGR_ID             ,
	         CHG_DATE            ) =
	       ( SELECT INACT_DT             ,
	                ACT_DT              ,
	                ALWNCE_NM              ,
	                PROD_CD                ,
	                ALWNCE_TYP             ,
	                ALWNCE_APPL_LVL        ,
	                ALWNCE_UNT             ,
	                ALWNCE_AMT_SBJ         ,
	                ALWNCE_APPL_UOM        ,
	                ALWNCE_AMT_TYP         ,
	                PRORATE_TYP            ,
	                REGT_ALWNCE_AMT        ,
	                ALWNCE_AMNT            ,
	                ROLLOVR_FL             ,
	                ROLLOVR_CNT            ,
	                THRS_NOTI_MTHD_REF_FL  ,
	                THRS_NOTI_MTHD         ,
	                THRS_UOM               ,
	                THRS1                  ,
	                THRS2                  ,
	                THRS3                  ,
	                MSTR_FL                ,
	                #{productDevMgt.chgrId}          ,
	                #{productDevMgt.sysdate}
	         FROM   TPMPD_D_ALWNCE TDA
	         WHERE  TDA.ALWNCE_CD = TA.ALWNCE_CD )
	WHERE   TA.ALWNCE_CD  = #{productDevMgt.alwnceCd}
	AND     TA.MSTR_FL  = '1'
</update>

<update id="modTransAlwnceExpirateDt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_ALWNCE
	SET     INACT_DT   = #{productDevMgt.transferApplyDt, jdbcType=VARCHAR },
			MSTR_FL      = '0',
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
	<choose>                          
		<when test="'${dbms.kind}' == 'ORACLE'">                       
      		CHG_DATE = SYSDATE 
		</when>                          
		<when test="'${dbms.kind}' == 'MYSQL'">                         
        	CHG_DATE = NOW()
		</when>
	</choose>
	WHERE   ALWNCE_CD    =  #{productDevMgt.alwnceCd}
	AND     MSTR_FL      = '1'
</update>	

<update id="modTransAlwnceMstrFl" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	UPDATE  TPMPD_ALWNCE
	SET     MSTR_FL      = '0' ,
			CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
			CHG_DATE = #{productDevMgt.sysdate}
	WHERE   ALWNCE_CD    = #{productDevMgt.alwnceCd}
	AND     MSTR_FL      = '1'
	AND     INACT_DT  &lt; #{productDevMgt.transferApplyDt}
</update>

<update id="modTransferExpiration" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
    UPDATE  ${productDevMgt.tableId}
    SET     SUBS_FL   = '0',
               CHGR_ID   = #{productDevMgt.chgrId, jdbcType=VARCHAR },
               CHG_DATE  = #{productDevMgt.sysdate}
       WHERE   ${productDevMgt.updCond}
       AND     MSTR_FL   = '1'
</update>

<delete id="delTransDvlpTable" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	DELETE
	FROM   ${productDevMgt.tableId}
	WHERE  ${productDevMgt.deleteCond}
</delete>

<delete id="delProdrateReq" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	DELETE FROM TPMPD_RATE_ITM
     	WHERE PROD_CD = #{productDevMgt.prodCd} 
   	AND  ACT_DT > INACT_DT
</delete>

<select id="getProductListCount2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
				SELECT COUNT(*)
		FROM   TPMPD_PROD TDP
		WHERE  1=1
		<if test="productDevMgt.prodTyp != null and productDevMgt.prodTyp != ''">
	       AND  TDP.PROD_TYP = #{productDevMgt.prodTyp}
	    </if>
		<if test="productDevMgt.prodGrp != null and productDevMgt.prodGrp != ''">
	       AND  TDP.PROD_GRP = #{productDevMgt.prodGrp}
	    </if>	    
		<if test="productDevMgt.soId != null and productDevMgt.soId != ''">
	       AND  TDP.SO_ID = #{productDevMgt.soId}
	    </if>		    
		ORDER BY PROD_TYP, DISP_PRI_NO
</select>

<select id="getProductList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
				SELECT TDP.PROD_CD           ,
		       TDP.INACT_DT        ,
		       TDP.ACT_DT         ,
		       TDP.PROD_NM           ,
		       TDP.PROD_ABBR_NM      ,
		       TDP.PROD_ENG_NM       ,
		       TDP.PROD_ENG_ABBR_NM  ,
               TDP.MNO_PROD_CD,
		       TDP.BASIC_PROD_FL     ,
		       
		       ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD
                 WHERE  TCD.COMMON_GRP = 'PP00069'
                 AND    TCD.COMMON_CD  = TDP.BASIC_PROD_FL  ) BASIC_PROD_FL_NM,
		       TDP.USG_RATE_PRI_NO   ,
		       TDP.PROD_TYP          ,
		       ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD          
                 WHERE  TCD.COMMON_GRP = 'PP00068'
                 AND    TCD.COMMON_CD  = TDP.PROD_TYP) PROD_TYP_NM,
		       TDP.PROD_GRP          ,
		       ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                 ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                 AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                 AND TCD.COMMON_CD = TCD1.COMMON_CD                  
                 WHERE  TCD.COMMON_GRP = 'PP00141'
                 AND    TCD.COMMON_CD  = TDP.PROD_GRP) PROD_GRP_NM,
		       TDP.PROD_LVL,
		       TDP.SVC_GRP          ,
		        ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL TCD
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                    
                  WHERE  TCD.COMMON_GRP = 'PP00143'
                  AND    TCD.COMMON_CD  = TDP.SVC_GRP) SVC_GRP_NM,
		       TDP.USE_MM_TYP          ,
		         ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL TCD 
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                     
                  WHERE  TCD.COMMON_GRP = 'PP00079'
                  AND    TCD.COMMON_CD  = TDP.USE_MM_TYP) USE_MM_TYP_NM,
		       TDP.SUBS_FL           ,
		       ( SELECT TCD1.CODE_NM AS COMMON_CD_NM
                 FROM   TSYCO_CODE_DETAIL TCD
                 LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME TCD1
                  ON #{productDevMgt.lngTyp} = TCD1.LNG_TYP
                  AND TCD.COMMON_GRP = TCD1.COMMON_GRP
                  AND TCD.COMMON_CD = TCD1.COMMON_CD                 
                 WHERE  TCD.COMMON_GRP = 'PP00071'
                 AND    TCD.COMMON_CD  = TDP.SUBS_FL) SUBS_FL_NM,
		       TDP.CRR_ID            ,
		       TDP.DISP_PRI_NO       ,
		       TDP.MOD_DESC          ,
		       TDP.PROD_DESC         ,
		       TDP.MSTR_FL           ,
		       TDP.REGR_ID      ,
		       TDP.REG_DATE    ,
		       TDP.CHGR_ID        ,
		       CHG_DATE      ,
		        TDP.KPI_PROD_GRP_CD,
		        TDP.SO_ID,
	            (SELECT SO_NM
	              FROM TSYCO_SO_MAST
	              WHERE SO_ID = TDP.SO_ID) AS SO_NM,
				(SELECT  MAX(TPDH.DVLP_STATUS)
		        FROM    TPMPD_PROD_DVLP_HIST TPDH
		        WHERE   TPDH.PROD_CD  =  TDP.PROD_CD
		        AND     TPDH.DVLP_STATUS NOT IN ('5','6')) AS DVLP_STATUS   	              
		FROM   TPMPD_PROD TDP
		WHERE  1=1
		<if test="productDevMgt.prodTyp != null and productDevMgt.prodTyp != ''">
	       AND  TDP.PROD_TYP = #{productDevMgt.prodTyp}
	    </if>
		<if test="productDevMgt.prodGrp != null and productDevMgt.prodGrp != ''">
	       AND  TDP.PROD_GRP = #{productDevMgt.prodGrp}
	    </if>	    
		<if test="productDevMgt.soId != null and productDevMgt.soId != ''">
	       AND  TDP.SO_ID = #{productDevMgt.soId}
	    </if>		    
		ORDER BY PROD_TYP, DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>


<select id="getProductServiceListCount2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
        SELECT  COUNT(*)
        FROM    TPMPD_PROD_SVC TDPS,
                (
                  SELECT A.SVC_CD,
                         A.SVC_NM,
                         A.UPR_SVC_CD,
                         A.MAIN_SVC_CD,
                         A.DISP_PRI_NO
                  FROM  (
                           SELECT SVC_CD,
                                  SVC_NM,
                                  UPR_SVC_CD,
                                  MAIN_SVC_CD,
                                  DISP_PRI_NO
                           FROM   TPMSV_SVC TS
                           WHERE  INACT_DT = #{productDevMgt.inactDt}
                           ORDER  BY DISP_PRI_NO
                         ) A ) V_TS
        WHERE   TDPS.SVC_CD = V_TS.SVC_CD
          AND   TDPS.PROD_CD = #{productDevMgt.prodCd}
           AND  TDPS.INACT_DT           >= #{productDevMgt.currentDay}
          AND TDPS.MSTR_FL = '1'
</select>

<select id="getProductServiceList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT  TDPS.PROD_CD,
                TDPS.SVC_CD,
                TDPS.ACT_DT,
                TDPS.INACT_DT,
                V_TS.SVC_NM,
                V_TS.UPR_SVC_CD,
                (SELECT SVC_NM
                 FROM TPMSV_SVC Z
                 WHERE MSTR_FL = '1'
                 AND Z.SVC_CD = V_TS.UPR_SVC_CD) UPR_SVC_NM,
                (SELECT SVC_NM
                 FROM TPMSV_SVC Z
                 WHERE MSTR_FL = '1'
                 AND Z.SVC_CD = V_TS.MAIN_SVC_CD) MAIN_SVC_NM,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00021'
                  AND    B.COMMON_CD  = TDPS.SUBSCRIP_CMPS_FL ) SUBSCRIP_CMPS_FL_NM,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00078'
                  AND    B.COMMON_CD  = TDPS.OPT_SVC_CMPS_FL ) OPT_SVC_CMPS_FL_NM,
                ( SELECT C.CODE_NM AS COMMON_CD_NM
                  FROM   TSYCO_CODE_DETAIL B
                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
                  AND B.COMMON_GRP = C.COMMON_GRP
                  AND B.COMMON_CD = C.COMMON_CD
                  WHERE  B.COMMON_GRP = 'PP00077'
                  AND    B.COMMON_CD  = TDPS.MULTI_CMPS_FL ) MULTI_CMPS_FL_NM,
               TDPS.CMPS_QTY_FROM,
               TDPS.CMPS_QTY_TO,
               TDPS.CHG_DATE
        FROM    TPMPD_PROD_SVC TDPS,
                (
                  SELECT A.SVC_CD,
                         A.SVC_NM,
                         A.UPR_SVC_CD,
                         A.MAIN_SVC_CD,
                         A.DISP_PRI_NO
                  FROM  (
                           SELECT SVC_CD,
                                  SVC_NM,
                                  UPR_SVC_CD,
                                  MAIN_SVC_CD,
                                  DISP_PRI_NO
                           FROM   TPMSV_SVC TS
                           WHERE  INACT_DT = #{productDevMgt.inactDt}
                           ORDER  BY DISP_PRI_NO
                         ) A ) V_TS
        WHERE   TDPS.SVC_CD = V_TS.SVC_CD
          AND   TDPS.PROD_CD = #{productDevMgt.prodCd}
          AND TDPS.MSTR_FL = '1'
          AND  TDPS.INACT_DT           >= #{productDevMgt.currentDay}
        ORDER   BY V_TS.DISP_PRI_NO ASC
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>


<select id="getSuprtEquipListCount2" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" resultType="int">
		SELECT  COUNT(*)
		FROM    TPMPD_SUPRT_EQUIP TDSE
		WHERE   TDSE.PROD_CD     = #{productDevMgt.prodCd}
		ORDER BY TDSE.DISP_PRI_NO
</select>

<select id="getSuprtEquipList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT  TDSE.PROD_CD ,
		        TDSE.EQT_CL_CD ,
		        (SELECT TEC.EQT_CL_NM
		         FROM   IFNPM_EQT_CL TEC
		         WHERE  TEC.EQT_CL_CD = TDSE.EQT_CL_CD ) AS EQT_CL_NM ,
		        TDSE.SBJ_PROD_CD ,
		        (SELECT TP.PROD_NM
		         FROM   TPMPD_PROD TP
		         WHERE  TP.PROD_CD = TDSE.SBJ_PROD_CD
		         AND    TP.MSTR_FL = '1'
		         AND    TP.INACT_DT >= #{productDevMgt.currentDay} ) SBJ_PROD_NM ,
		        TDSE.SVC_CD ,
		        (SELECT TS.SVC_NM
		         FROM   TPMSV_SVC TS
		         WHERE  TS.SVC_CD = TDSE.SVC_CD
		         AND    TS.MSTR_FL = '1'
		         AND    TS.INACT_DT >= #{productDevMgt.currentDay} ) SVC_NM ,
		        TDSE.CMPS_QTY_FROM ,
		        TDSE.CMPS_QTY_TO   ,
		        TDSE.DISP_PRI_NO		        
		FROM    TPMPD_SUPRT_EQUIP TDSE
		WHERE   TDSE.PROD_CD     = #{productDevMgt.prodCd}
		ORDER BY TDSE.DISP_PRI_NO
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>


<select id="getProductAttrListCount3" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT COUNT(*)
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_PROD_ATTR TDPA
		         WHERE  TDPA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDPA.MSTR_FL              = '1'
		         AND    TDPA.PROD_CD              = #{productDevMgt.prodCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
</select>

<select id="getProductAttrList3" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
		SELECT VWTS.PROD_CD,
		       VWAT.ATTR_CD,
		       VWAT.ATTR_NM,
		       VWAT.REF_CD,
		       VWAT.ATTR_STRT_VAL,
		       VWAT.ATTR_END_VAL,
		       VWTS.ATTR_VAL,
			   VWTS.ATTR_VAL AS ATTR_VAL_REF_CD,
			  (
			  CASE
			    WHEN (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD) IS NULL
			    THEN VWTS.ATTR_VAL
			    ELSE
			      (SELECT C.CODE_NM AS COMMON_CD_NM
			      FROM TSYCO_CODE_DETAIL B ,
			        TSYCO_CODE_DETAIL_NAME C
			      WHERE B.COMMON_GRP  = VWAT.REF_CD
			      AND B.COMMON_CD     = VWTS.ATTR_VAL
			      AND C.LNG_TYP    = #{productDevMgt.lngTyp}
			      AND C.COMMON_GRP = B.COMMON_GRP
			      AND C.COMMON_CD  = B.COMMON_CD
			      )
			  END) AS ATTR_VAL_NM,
		       VWTS.INACT_DT,
		       VWTS.ACT_DT,
		       '1' AS MSTR_FL,
		       VWTS.ATTR_VAL AS BASE_ATTR_VAL,
		       VWTS.REGR_ID,
		       VWTS.CHGR_ID		       
		FROM
		       ( SELECT  TA.ATTR_CD,
		                 TATM.INACT_DT,
		                 TATM.ACT_DT,
		                 TA.ATTR_NM,
		                 TA.REF_CD,
		                 TA.ATTR_STRT_VAL,
		                 TA.ATTR_END_VAL,
		                 TA.CHGR_ID,
		                 TA.CHG_DATE
		         FROM    TPMBI_ATTR_TYP_MAP TATM,
		                 TPMBI_ATTR TA
		         WHERE   TATM.ATTR_CD     = TA.ATTR_CD
		         AND     TATM.INACT_DT >= #{productDevMgt.currentDay}
		         AND     TATM.MSTR_FL     = '1'
		         AND     TATM.ATTR_TYP    = #{productDevMgt.attrTyp}
		         AND     TATM.INACT_DT BETWEEN TA.ACT_DT AND TA.INACT_DT
		       ) VWAT LEFT OUTER JOIN
		       (
		         SELECT *
		         FROM   TPMPD_PROD_ATTR TDPA
		         WHERE  TDPA.INACT_DT           >= #{productDevMgt.currentDay}
		         AND    TDPA.MSTR_FL              = '1'
		         AND    TDPA.PROD_CD              = #{productDevMgt.prodCd}
		       ) VWTS
		       ON    ( VWAT.ATTR_CD  = VWTS.ATTR_CD)
		ORDER BY VWAT.ATTR_NM
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getProductRelationshipList2" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_head"/>			
        SELECT TDPR.PROD_CD                                                     ,
               TDPR.REL_PROD_CD                                                 ,
               TDPR.PROD_REL_TYP                                                ,
               (SELECT TDP.PROD_NM
                FROM   TPMPD_PROD TDP
                WHERE  TDPR.PROD_CD    = TDP.PROD_CD) PROD_NM                   ,
               (SELECT C.CODE_NM AS COMMON_CD_NM
                FROM   TSYCO_CODE_DETAIL B
                LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
		        ON #{productDevMgt.lngTyp} = C.LNG_TYP
		        AND B.COMMON_GRP = C.COMMON_GRP
		        AND B.COMMON_CD = C.COMMON_CD
                WHERE  B.COMMON_GRP = 'PP00067'
                    AND    B.COMMON_CD  = TDPR.PROD_REL_TYP) PROD_REL_TYP_NM     ,
               (SELECT TP.PROD_NM
                FROM   TPMPD_PROD TP
                WHERE  TDPR.REL_PROD_CD  = TP.PROD_CD
                AND    TP.MSTR_FL        = '1'
                AND    TP.INACT_DT    >= #{productDevMgt.currentDay}) REL_PROD_NM,
               TDPR.CHG_DATE               
        FROM   TPMPD_PROD_REL TDPR
        WHERE  TDPR.PROD_CD     = #{productDevMgt.prodCd} OR TDPR.REL_PROD_CD =  #{productDevMgt.prodCd} 
        ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD
	<include refid="com.ntels.ccbs.system.mapper.common.service.CommonCfgMapper.paging_foot"/>	
</select>

<select id="getProductRelationshipListCount2" resultType="int" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">		
        SELECT COUNT(*)
        FROM   TPMPD_PROD_REL TDPR
        WHERE  TDPR.PROD_CD     = #{productDevMgt.prodCd}OR TDPR.REL_PROD_CD =  #{productDevMgt.prodCd} 
        ORDER BY TDPR.PROD_REL_TYP, TDPR.REL_PROD_CD 
</select>

<select id="getRateFctrInfo" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT  TF.FCTR_NM ,
				(CASE WHEN TDRIF.DATA_TYP IS NULL THEN 'X' ELSE TDRIF.DATA_TYP END) AS DATA_TYP,
		        TDRIF.REF_TABLE_ID ,
		        TDRIF.REF_COLMN_ID ,
		        TDRIF.REF_COLMN_NM ,
		        TDRIF.REF_TABLE_COND ,
		        TDRIF.REF_CD ,
		        NULL AS FCTR_VAL,
		        TDRIF.FCTR_NO FCTR_NO
		FROM    TPMPD_D_RATE_ITM_FCTR TDRIF ,
		        TPMBI_FCTR          TF
		WHERE   TDRIF.RATE_ITM_CD =  #{productDevMgt.rateItmCd}  		

		AND     TDRIF.FCTR_CD          =  TF.FCTR_CD
		AND     TF.MSTR_FL             = '1'
</select>

<insert id="addRateExtractList" parameterType="map">
	INSERT INTO TPMPD_D_RATE
	(
	SELECT  #{conTableMap.RATE_ITM_CD},
	        NVL(FCTR_VAL1,'*') AS FCTR_VAL1,
	        NVL(FCTR_VAL2,'*') AS FCTR_VAL2,
	        NVL(FCTR_VAL3,'*') AS FCTR_VAL3,
	        NVL(FCTR_VAL4,'*') AS FCTR_VAL4,
	        NVL(FCTR_VAL5,'*') AS FCTR_VAL5,
	        NVL(FCTR_VAL6,'*') AS FCTR_VAL6,
	        NVL(FCTR_VAL7,'*') AS FCTR_VAL7,
	        NVL(FCTR_VAL8,'*') AS FCTR_VAL8,
	        NVL(FCTR_VAL9,'*') AS FCTR_VAL9,
	        #{conTableMap.INACT_DT}                   ,
	        #{conTableMap.CURRENT_DAY}    ,
	        '0'                            ,
	        NULL                           ,
	        NULL                           ,
	        0                           ,
	        '0'                            ,
	        1                              ,
	        NULL                           ,
	        '0'                            ,
	        'KRW'                          ,
	        NULL                           ,
	        NULL                           ,
	        '1'                            ,
	        #{conTableMap.REGR_ID}                 ,
	        #{conTableMap.SYS_DATE}                     ,
	        #{conTableMap.CHGR_ID}                   ,
	        #{conTableMap.SYS_DATE}
	FROM   (SELECT  A.RATE_ITM_CD,
	                NVL(A1.COMMON_CD,'*') AS FCTR_VAL1,
	                NVL(A2.COMMON_CD,'*') AS FCTR_VAL2,
	                NVL(A3.COMMON_CD,'*') AS FCTR_VAL3,
	                NVL(A4.COMMON_CD,'*') AS FCTR_VAL4,
	                NVL(A5.COMMON_CD,'*') AS FCTR_VAL5,
	                NVL(A6.COMMON_CD,'*') AS FCTR_VAL6,
	                NVL(A7.COMMON_CD,'*') AS FCTR_VAL7,
	                NVL(A8.COMMON_CD,'*') AS FCTR_VAL8,
	                NVL(A9.COMMON_CD,'*') AS FCTR_VAL9
	        FROM  TPMPD_D_RATE_ITM A,
	              (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID1} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID1}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '1'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND1}
	              ) A1,
	              (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID2} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID2}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '2'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND2}
	             ) A2,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID3} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID3}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '3'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND3}
	             ) A3,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID4} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID4}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '4'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND4}
	             ) A4,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID5} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID5}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '5'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND5}
	             ) A5,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID6} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID6}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '6'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND6}
	             ) A6,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID7} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID7}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '7'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND7}
	             ) A7,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID8} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID8}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '8'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND8}
	             ) A8,
	             (
	                SELECT TDRIF.RATE_ITM_CD,
	                       ${conTableMap.COLUMN_ID9} AS COMMON_CD
	                FROM   TPMPD_D_RATE_ITM_FCTR TDRIF
	                       ${conTableMap.TABLE_ID9}
	                WHERE  TDRIF.RATE_ITM_CD      = #{conTableMap.RATE_ITM_CD}
	                AND    TDRIF.FCTR_NO          = '9'
	                AND    TDRIF.RATE_INFO_EXE_FL = '1'
	                ${conTableMap.COND9}
	             ) A9
	         WHERE A.RATE_ITM_CD = #{conTableMap.RATE_ITM_CD}
	         AND   A.RATE_ITM_CD = A1.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A2.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A3.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A4.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A5.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A6.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A7.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A8.RATE_ITM_CD(+)
	         AND   A.RATE_ITM_CD = A9.RATE_ITM_CD(+)
	         MINUS
	         SELECT X.RATE_ITM_CD,
	                X.FCTR_VAL1, X.FCTR_VAL2, X.FCTR_VAL3,
	                X.FCTR_VAL4, X.FCTR_VAL5, X.FCTR_VAL6,
	                X.FCTR_VAL7, X.FCTR_VAL8, X.FCTR_VAL9
	         FROM   TPMPD_D_RATE X
	         WHERE  X.RATE_ITM_CD = #{conTableMap.RATE_ITM_CD}
	      )
	 )
</insert>

<select id="getCommonCodeComboList" resultType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt" parameterType="com.ntels.ccbs.product.domain.product.productDev.ProductDevMgt">
		SELECT B.COMMON_CD AS COMMON_CD,  C.CODE_NM AS COMMON_CD_NM
	                               FROM   TSYCO_CODE_DETAIL B
	                  LEFT OUTER JOIN TSYCO_CODE_DETAIL_NAME C
	                  ON #{productDevMgt.lngTyp} = C.LNG_TYP
	                  AND B.COMMON_GRP = C.COMMON_GRP
	                  AND B.COMMON_CD = C.COMMON_CD
	                               WHERE  B.COMMON_GRP = #{productDevMgt.refCd}	
</select>

</mapper>